{"ast":null,"code":"import _slicedToArray from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useEffect}from\"react\";import{Link,useHistory}from\"react-router-dom\";import cx from\"classnames\";import{User,Inbox}from\"../../service/\";import\"../assets/scss/UserSA.scss\";function UserSA(){var history=useHistory();var _useContext=useContext(User.Context),setUserAuthFN=_useContext.setUserAuthFN,userAuth=_useContext.userAuth;var _useState=useState(0),_useState2=_slicedToArray(_useState,1),balanceLoad=_useState2[0];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),inboxCount=_useState4[0],setInboxCount=_useState4[1];var onClick=function onClick(e){if(!userAuth.data){e.preventDefault();setUserAuthFN(userAuth.status,userAuth.data,true);}};useEffect(function(){var q=Inbox.count();q.promise.then(function(r){setInboxCount(+r.info);},function(e){if(!e.is_aborted){console.info(e);}});return function(){return q.cancel();};},[]);var UserLink=function UserLink(_ref){var name=_ref.name,to=_ref.to,className=_ref.className,count=_ref.count,target=_ref.target;return/*#__PURE__*/React.createElement(Link,{to:to,className:\"link-\".concat(className),onClick:onClick,target:target},/*#__PURE__*/React.createElement(\"i\",null,count?/*#__PURE__*/React.createElement(\"span\",{className:\"count\"},count):null),/*#__PURE__*/React.createElement(\"span\",null,name));};var refreshBalance=function refreshBalance(){history.push(\"/profile/transfer\");// setBalanceLoad(1);\n// User.session({\n// \t...User.read()\n// }).promise.then(r => {\n// \tsetBalanceLoad(0);\n// \tsetUserAuthFN(1, r.info);\n// });\n};// console.log(userAuth)\n// return false\nreturn/*#__PURE__*/React.createElement(\"div\",{className:cx(\"user-sa\",\"with-loader\",{loading:balanceLoad})},/*#__PURE__*/React.createElement(\"div\",{className:\"load-spin\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"user-sa-content\"},userAuth.data&&/*#__PURE__*/React.createElement(\"div\",{className:\"user-sa-info\"},/*#__PURE__*/React.createElement(\"span\",{className:\"user-sa--name\"},userAuth.data.account),/*#__PURE__*/React.createElement(\"div\",{className:\"user-sa--balance\",tabIndex:\"0\",role:\"button\",onClick:function onClick(){return refreshBalance();}},/*#__PURE__*/React.createElement(\"span\",null,\"\\u4E2D\\u5FC3:\\xA0\"),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"span\",null,\"\\uFFE5\"),userAuth.data.balance))),/*#__PURE__*/React.createElement(\"div\",{className:\"user-sa-hr\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"user-sa-links\"},/*#__PURE__*/React.createElement(UserLink,{name:\"\\u5145\\u503C\",to:\"/profile/deposit?a=1\",className:\"deposit\",target:\"_blank\"}),/*#__PURE__*/React.createElement(UserLink,{name:\"\\u8F6C\\u8D26\",to:\"/profile/transfer\",className:\"transfer\"}),/*#__PURE__*/React.createElement(UserLink,{name:\"\\u63D0\\u6B3E\",to:\"/profile/withdraw\",className:\"debit\"}),/*#__PURE__*/React.createElement(UserLink,{name:\"\\u4FE1\\u606F\",to:\"/inbox\",className:\"inbox\",count:inboxCount}))));}export default UserSA;","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/pwa/component/UserSA.js"],"names":["React","useState","useContext","useEffect","Link","useHistory","cx","User","Inbox","UserSA","history","Context","setUserAuthFN","userAuth","balanceLoad","inboxCount","setInboxCount","onClick","e","data","preventDefault","status","q","count","promise","then","r","info","is_aborted","console","cancel","UserLink","name","to","className","target","refreshBalance","push","loading","account","balance"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport cx from \"classnames\";\r\n\r\nimport { User, Inbox } from \"../../service/\";\r\n\r\nimport \"../assets/scss/UserSA.scss\";\r\n\r\nfunction UserSA() {\r\n  const history = useHistory();\r\n\r\n  const { setUserAuthFN , userAuth } = useContext(User.Context);\r\n  const [balanceLoad] = useState(0);\r\n  const [inboxCount, setInboxCount] = useState(0);\r\n\r\n  const onClick = (e) =>{\r\n    if(!userAuth.data){\r\n      e.preventDefault()\r\n      setUserAuthFN(userAuth.status , userAuth.data , true)\r\n    }\r\n  }\r\n  \r\n  useEffect(() => {\r\n    const q = Inbox.count();\r\n    \r\n    q.promise.then(\r\n      (r) => {\r\n        setInboxCount(+r.info);\r\n      },\r\n      (e) => {\r\n        if (!e.is_aborted) {\r\n          console.info(e);\r\n        }\r\n      }\r\n    );\r\n\r\n    return () => q.cancel();\r\n  }, []);\r\n\r\n  const UserLink = ({ name, to, className, count , target  }) => (\r\n    <Link to={to} className={`link-${className}`} onClick={onClick} target={target} >\r\n      <i>\r\n      {count ? <span className=\"count\">{count}</span> : null}\r\n\r\n      </i>\r\n      <span>{name}</span>\r\n    </Link>\r\n  );\r\n\r\n  const refreshBalance = () => {\r\n    history.push(\"/profile/transfer\");\r\n\r\n    // setBalanceLoad(1);\r\n\r\n    // User.session({\r\n    // \t...User.read()\r\n    // }).promise.then(r => {\r\n\r\n    // \tsetBalanceLoad(0);\r\n\r\n    // \tsetUserAuthFN(1, r.info);\r\n\r\n    // });\r\n  };\r\n\r\n  // console.log(userAuth)\r\n  // return false\r\n\r\n  return (\r\n    <div className={cx(\"user-sa\", \"with-loader\", { loading: balanceLoad })}>\r\n      <div className=\"load-spin\"></div>\r\n      <div className=\"user-sa-content\">\r\n        {userAuth.data && \r\n        <div className=\"user-sa-info\">\r\n          <span className=\"user-sa--name\">{userAuth.data.account}</span>\r\n          <div\r\n            className=\"user-sa--balance\"\r\n            tabIndex=\"0\"\r\n            role=\"button\"\r\n            onClick={() => refreshBalance()}\r\n          >\r\n            <span>中心:&nbsp;</span>\r\n            <p>\r\n              <span>￥</span>\r\n              {userAuth.data.balance}\r\n            </p>\r\n          </div>\r\n        </div>\r\n        }\r\n        <div className=\"user-sa-hr\" />\r\n        <div className=\"user-sa-links\">\r\n          <UserLink name=\"充值\" to=\"/profile/deposit?a=1\" className=\"deposit\" target=\"_blank\"/>\r\n          <UserLink name=\"转账\" to=\"/profile/transfer\" className=\"transfer\" />\r\n          <UserLink name=\"提款\" to=\"/profile/withdraw\" className=\"debit\" />\r\n          <UserLink\r\n            name=\"信息\"\r\n            to=\"/inbox\"\r\n            className=\"inbox\"\r\n            count={inboxCount}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default UserSA;\r\n"]},"metadata":{},"sourceType":"module"}