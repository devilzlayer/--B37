{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Documents/New PWA/GIT/src/view/Promotions.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Link } from 'react-router-dom';\nimport { StickyProvider, Sticky } from 'react-stickup';\nimport { map } from 'lodash';\nimport { withAuth } from '../util/';\nimport { Promotions as Service } from '../service/';\nimport '../assets/scss/Promotions.scss';\n\nfunction Promotions() {\n  const container = useRef(null);\n  const nav = useRef(null);\n  const [promotions, setPromotions] = useState([]);\n  const [active, setActive] = useState(0);\n  const [position, setPosition] = useState(0);\n  useEffect(() => {\n    window.scrollTo(0, 0);\n    document.body.classList.add('promotions-page');\n    return () => document.body.classList.remove('promotions-page');\n  }, []);\n  useEffect(() => {\n    const req = Service.read_updated();\n    req.promise.then(r => {\n      console.log(r);\n      setPromotions(r.info);\n    }, e => {});\n    return () => req.cancel();\n  }, []);\n  const buttonLabels = [\"所有事件\", \"体育\", \"真人\", \"电竞\", \"棋牌\", \"电子\"];\n\n  const PromoButton = ({\n    label,\n    active,\n    onClick\n  }) => /*#__PURE__*/React.createElement(\"div\", {\n    className: `button ${active ? \"active\" : null}`,\n    onClick: onClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 3\n    }\n  }, console.warn(active), label);\n\n  const onClick = async i => {\n    await setActive(i);\n    const {\n      children\n    } = nav.current;\n    map(children, obj => {\n      // console.log(obj.offsetLeft)\n      if (obj.classList.contains('active')) {\n        setPosition(obj.offsetLeft);\n      }\n    }); // var el = document.querySelector('.button.active');\n    // console.log(el.offsetLeft, el.offsetTop);\n  };\n\n  return /*#__PURE__*/React.createElement(StickyProvider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"promotions\",\n    ref: container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"promotions-flex-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"promotions-inner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"promotions-buttons\",\n    ref: nav,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }\n  }, buttonLabels.map((label, i) => /*#__PURE__*/React.createElement(PromoButton, {\n    label: label,\n    key: i,\n    active: active === i,\n    onClick: () => onClick(i),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 40\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: `switch active-${active}`,\n    style: {\n      left: position\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 8\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"promotions-banners\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }\n  }, promotions.map((promotion, i) => /*#__PURE__*/React.createElement(Link, {\n    className: \"banner\",\n    to: `/promotion/${promotion.id}`,\n    key: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"banner-inner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"banner-img\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: `https://${promotion.bannerurl}`,\n    alt: promotion.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 12\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"banner-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 12\n    }\n  }, \"\\u79BB\\u6D3B\\u52A8\\u7ED3\\u675F: \", promotion.endTime), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"arrow\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 12\n    }\n  }, \"\\u66F4\\u591A\\u5185\\u5BB9\"))))))))));\n}\n\nexport default withAuth(Promotions, 0);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/view/Promotions.js"],"names":["React","useState","useEffect","useRef","Link","StickyProvider","Sticky","map","withAuth","Promotions","Service","container","nav","promotions","setPromotions","active","setActive","position","setPosition","window","scrollTo","document","body","classList","add","remove","req","read_updated","promise","then","r","console","log","info","e","cancel","buttonLabels","PromoButton","label","onClick","warn","i","children","current","obj","contains","offsetLeft","left","promotion","id","bannerurl","title","endTime"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { StickyProvider, Sticky } from 'react-stickup';\r\nimport { map } from 'lodash'\r\nimport { withAuth } from '../util/';\r\nimport { Promotions as Service } from '../service/';\r\n\r\nimport '../assets/scss/Promotions.scss';\r\n\r\n\r\nfunction Promotions() {\r\n\r\n\tconst container = useRef(null);\r\n\tconst nav = useRef(null);\r\n\tconst [promotions, setPromotions] = useState([]);\r\n\tconst [ active , setActive ] = useState(0)\r\n\tconst [ position , setPosition ] = useState(0)\r\n\tuseEffect(() => {\r\n\r\n\t\twindow.scrollTo(0, 0);\r\n\r\n\t\tdocument.body.classList.add('promotions-page');\r\n\r\n\t\treturn () => document.body.classList.remove('promotions-page');\r\n\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tconst req = Service.read_updated();\r\n\r\n\t\treq.promise.then(r => {\r\n\r\n\t\t\tconsole.log(r);\r\n\r\n\t\t\tsetPromotions(r.info);\r\n\r\n\t\t}, e => { });\r\n\r\n\t\treturn () => req.cancel();\r\n\r\n\t}, []);\r\n\r\n\tconst buttonLabels = [\"所有事件\", \"体育\", \"真人\", \"电竞\", \"棋牌\", \"电子\"]\r\n\r\n\tconst PromoButton = ({ label, active, onClick }) => (\r\n\t\t<div className={`button ${active ? \"active\" : null}`} onClick={onClick}>\r\n\t\t\t{console.warn(active)}\r\n\t\t\t{label}\r\n\t\t</div>\r\n\t)\r\n\r\n\tconst onClick = async(i) =>{\r\n\t\tawait setActive(i)\r\n\t\tconst { children } = nav.current\r\n\t\tmap(children , (obj ) =>{\r\n\t\t\t// console.log(obj.offsetLeft)\r\n\t\t\tif(obj.classList.contains('active')){\r\n\t\t\t\tsetPosition(obj.offsetLeft)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t})\r\n\t\t// var el = document.querySelector('.button.active');\r\n\t\t// console.log(el.offsetLeft, el.offsetTop);\r\n\r\n\t}\r\n\r\n\treturn (\r\n\t\t<StickyProvider>\r\n\t\t\t<div className=\"promotions\" ref={container}>\r\n\t\t\t\t<div className=\"promotions-flex-wrap\">\r\n\t\t\t\t\t<div className=\"promotions-inner\">\r\n\t\t\t\t\t\t<div className=\"promotions-buttons\" ref={nav}>\r\n\t\t\t\t\t\t\t{buttonLabels.map((label, i) => <PromoButton label={label} key={i} active={active === i} onClick={() => onClick(i)}/>)}\r\n\t\t\t\t\t\t\t<div className={`switch active-${active}`} style={{left : position}}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"promotions-banners\">\r\n\t\t\t\t\t\t\t{promotions.map((promotion, i) => (\r\n\t\t\t\t\t\t\t\t<Link className=\"banner\" to={`/promotion/${promotion.id}`} key={i}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"banner-inner\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"banner-img\">\r\n\t\t\t\t\t\t\t\t\t\t\t<img src={`https://${promotion.bannerurl}`} alt={promotion.title} />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"banner-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t<p>离活动结束: {promotion.endTime}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"arrow\">更多内容</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</StickyProvider>\r\n\t);\r\n\r\n}\r\n\r\nexport default withAuth(Promotions, 0);\r\n"]},"metadata":{},"sourceType":"module"}