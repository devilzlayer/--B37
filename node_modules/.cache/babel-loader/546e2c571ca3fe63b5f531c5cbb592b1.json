{"ast":null,"code":"import _slicedToArray from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useHistory}from'react-router-dom';// import { Link} from 'react-router-dom';\nimport{map,size,sortBy,reverse}from'lodash';import{Promotions}from'../../service';import moment from'moment';import{Wrap}from'../view/profile/';import{withAuth}from\"../util/\";import'../assets/scss/News.scss';var News=function News(){var _useState=useState(15),_useState2=_slicedToArray(_useState,2),load=_useState2[0],setLoad=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),list=_useState4[0],setList=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),key=_useState6[0],setKey=_useState6[1];var history=useHistory();useEffect(function(){var q=Promotions.getAnnouncements({num:load});q.promise.then(function(r){var sortDate=sortBy(r.info,function(obj){return obj.edit_time;});setList(reverse(sortDate));},function(e){if(!e.is_aborted){console.warn(e);}});return function(){return q.cancel();};},[load]);var onOpen=function onOpen(i){setKey(i);if(key===i){setKey(null);}};return/*#__PURE__*/React.createElement(Wrap,{className:\"news-wrap\",centerName:\"\\u6700\\u65B0\\u516C\\u544A\",faq:false,sublevel:[true,function(){return history.goBack();}]},/*#__PURE__*/React.createElement(\"div\",{className:\"news-wrap-inner\"},list&&map(list,function(obj,i){return/*#__PURE__*/React.createElement(\"div\",{key:i,className:\"news-wrap-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"news-wrap-content \".concat(key===i?'drop':'')},/*#__PURE__*/React.createElement(\"div\",{className:\"news-wrap-time\"},obj.edit_time),/*#__PURE__*/React.createElement(\"div\",{className:\"news-wrap-text\"},obj.content),/*#__PURE__*/React.createElement(\"div\",{className:\"news-wrap-arrow\",onClick:function onClick(){return onOpen(i);}})));}),size(list)>=load&&/*#__PURE__*/React.createElement(\"div\",{className:\"news-load more\",onClick:function onClick(){return setLoad(load+15);}},\"load more\")));};export default withAuth(News,1);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/pwa/view/News.js"],"names":["React","useEffect","useState","useHistory","map","size","sortBy","reverse","Promotions","moment","Wrap","withAuth","News","load","setLoad","list","setList","key","setKey","history","q","getAnnouncements","num","promise","then","r","sortDate","info","obj","edit_time","e","is_aborted","console","warn","cancel","onOpen","i","goBack","content"],"mappings":"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","sourcesContent":["import React ,{ useEffect, useState} from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\n// import { Link} from 'react-router-dom';\r\nimport { map ,size , sortBy , reverse } from 'lodash'\r\nimport { Promotions } from '../../service';\r\nimport moment from 'moment'\r\n\r\nimport { Wrap } from '../view/profile/';\r\nimport { withAuth } from \"../util/\";\r\n\r\nimport '../assets/scss/News.scss';\r\n\r\n\r\nconst News = () => {\r\n    const [ load ,setLoad ] = useState(15)\r\n    const [ list ,setList ] = useState(null)\r\n    const [ key ,setKey ] = useState(null)\r\n\tconst history = useHistory();\r\n\r\n    useEffect( () =>{\r\n\t\tconst q = Promotions.getAnnouncements({ num: load  });\r\n\r\n        q.promise.then(r => {\r\n            const sortDate = sortBy(r.info, (obj )=>{\r\n                return obj.edit_time\r\n            })\r\n\r\n            setList(reverse(sortDate))\r\n\r\n\t\t}, e => {\r\n\t\t\tif (!e.is_aborted) {\r\n\t\t\t\tconsole.warn(e);\r\n\t\t\t}\r\n\t\t});\r\n\r\n        return () => q.cancel();\r\n        \r\n    },[load])\r\n\r\n\r\n    const onOpen = (i) =>{\r\n        setKey(i)\r\n        if(key === i){\r\n            setKey(null)\r\n        }\r\n    }\r\n\r\n     \r\n\treturn (\r\n\t\t<Wrap\r\n\t\t\tclassName=\"news-wrap\"\r\n\t\t\tcenterName=\"最新公告\"\r\n\t\t\tfaq={false}\r\n\t\t\tsublevel={[ true, () => history.goBack() ]}>\r\n\t\t\t<div className=\"news-wrap-inner\">\r\n\t\t\t\t{list && map(list , (obj , i) =>{\r\n                    return  <div key={i} className=\"news-wrap-item\">\r\n                                <div className={`news-wrap-content ${key === i ? 'drop' : ''}`}>\r\n                                    <div className=\"news-wrap-time\">{obj.edit_time}</div>\r\n                                    <div className=\"news-wrap-text\">{obj.content}</div>\r\n                                    <div className=\"news-wrap-arrow\" onClick={() => onOpen(i)}/>\r\n                                </div>\r\n                            </div>\r\n                })}\r\n                {size(list) >= load &&  <div className=\"news-load more\" onClick={() => setLoad(load + 15)}>load more</div> }\r\n \r\n\t\t\t</div>\r\n\t\t</Wrap>\r\n\t);\r\n\r\n}\r\n\r\nexport default withAuth(News,1 );\r\n\r\n"]},"metadata":{},"sourceType":"module"}