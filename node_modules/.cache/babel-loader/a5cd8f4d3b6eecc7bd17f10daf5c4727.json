{"ast":null,"code":"import _defineProperty from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from\"react\";import{Link,Redirect,useHistory,useLocation}from\"react-router-dom\";import{UITabs,FormField}from\"../../component/\";import{User as Service}from\"../../service/\";import\"../assets/scss/LoginSA.scss\";function useQuery(){return new URLSearchParams(useLocation().search);}function FormSignin(props){var onLoading=props.onLoading;var _useLocation=useLocation(),_useLocation$state=_useLocation.state;_useLocation$state=_useLocation$state===void 0?{}:_useLocation$state;var _useLocation$state$re=_useLocation$state.referrer,referrer=_useLocation$state$re===void 0?\"/\":_useLocation$state$re;var refUsername=useRef(null);var refPassword=useRef(null);var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isValid=_useState2[0],setValidity=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLogged=_useState4[0],setLogged=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),active=_useState6[0],setActive=_useState6[1];var _useState7=useState({username:null,password:null}),_useState8=_slicedToArray(_useState7,2),user=_useState8[0],setUser=_useState8[1];useEffect(function(){if(isValid&&user.username!==null&&user.password!==null)setActive(true);},[user,isValid]);function userChange(e){if(!isValid&&(e.target.name===\"password\"||e.target.name===\"username\"&&user.password)){setValidity(true);}setUser(_objectSpread(_objectSpread({},user),{},_defineProperty({},e.target.name,e.target.value)));}function userLogin(){if(!user.password){return void refPassword.current.focus();}onLoading(true);var req=Service.login(user);req.promise.then(function(r){localStorage.setItem(\"user\",JSON.stringify(user));onLoading(false);setLogged(true);},function(e){onLoading(false);setValidity(false);setActive(false);refPassword.current.focus();});}if(isLogged){return/*#__PURE__*/React.createElement(Redirect,{to:{pathname:referrer,state:{from_login:true}}});}return/*#__PURE__*/React.createElement(\"div\",{className:\"form form--signin\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-inner\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(FormField,{field:{label:\"用户名\"},input:{id:\"username1\",name:\"username\",type:\"text\",placeholder:\"用户名\",required:true,onChange:userChange,ref:refUsername}}),/*#__PURE__*/React.createElement(FormField,{isValid:isValid,field:{label:\"密码\"},input:{id:\"password1\",name:\"password\",type:\"password\",placeholder:\"密码\",required:true,onChange:userChange,ref:refPassword}}),!isValid?/*#__PURE__*/React.createElement(\"p\",{style:{color:\"#e4451b\",marginTop:-15,marginBottom:20}},\"\\u7528\\u6237\\u540D\\u6216\\u5BC6\\u7801\\u8F93\\u5165\\u4E0D\\u6B63\\u786E\"):null),/*#__PURE__*/React.createElement(\"button\",{className:\"submit \".concat(active?\"active\":null),onClick:active?userLogin:null},\"\\u767B\\u5F55\")),/*#__PURE__*/React.createElement(\"div\",{className:\"restore-wrap\"},/*#__PURE__*/React.createElement(Link,{to:\"/restore\"},\"\\u5FD8\\u8BB0\\u5BC6\\u7801\\u4E86\\u5417 \\uFF1F\")));}function FormSignup(props){var onLoading=props.onLoading;var refUsername=useRef(null);var refPassword=useRef(null);var refPasswordOK=useRef(null);var refTelephone=useRef(null);var refRef=useRef(null);var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),isValid=_useState10[0],setValidity=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),isValidPassword=_useState12[0],setPasswordValidity=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),isValidPasswordok=_useState14[0],setPasswordokValidity=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),isValidTelephone=_useState16[0],setTelephoneValidity=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),isCreated=_useState18[0],setCreated=_useState18[1];var _useState19=useState(props.agentName),_useState20=_slicedToArray(_useState19,1),agent=_useState20[0];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),active=_useState22[0],setActive=_useState22[1];var _useState23=useState(\"null\"),_useState24=_slicedToArray(_useState23,2),oldUsername=_useState24[0],setOldUsername=_useState24[1];var _useState25=useState({username:null,password:null,passwordok:null}),_useState26=_slicedToArray(_useState25,2),user=_useState26[0],setUser=_useState26[1];useEffect(function(){if(!user.agentName&&agent){setUser(_objectSpread(_objectSpread({},user),{},{agentName:agent}));}},[user,agent]);function onFocus(){if(!user.username||user.username.length<6){void refUsername.current.focus();}}function outOfFocus(e){var userValid=!user.username||user.username.length<6;if(e.target.id===\"username\"){if(!/^[a-z0-9]{6,12}$/i.test(user.username)){setValidity(1);return null;}else if(isValid!==2){return setValidity(0);}}if(e.target.id===\"password\"){if(!userValid&&user.password){if(user.password.length<6)return setPasswordValidity(1);else return setPasswordValidity(0);}else{return setPasswordValidity(0);}}if(e.target.id===\"passwordok\"){if(!userValid&&user.password!==user.passwordok){setPasswordokValidity(1);return null;}else{return setPasswordokValidity(0);}}if(e.target.id===\"telephone\"){if(!userValid&&user.telephone){if(user.telephone.length!==11)setTelephoneValidity(1);return null;}}}function userChange(e){if(e.target.name===\"telephone\"){if(e.target.value.length===11){setActive(true);setTelephoneValidity(0);}else if(active&&!isValidTelephone){setActive(false);setTelephoneValidity(1);}}if(e.target.name===\"username\"){if(isValid===2&&e.target.value!==oldUsername){setValidity(0);}}setUser(_objectSpread(_objectSpread({},user),{},_defineProperty({},e.target.name,e.target.value)));}function userCreate(){onLoading(true);var req=Service.create(user);req.promise.then(function(r){localStorage.setItem(\"user\",JSON.stringify({username:user.username,password:user.password}));onLoading(false);setCreated(true);},function(e){console.warn(e);onLoading(false);setValidity(2);setOldUsername(user.username);refUsername.current.focus();});}if(isCreated){return/*#__PURE__*/React.createElement(Redirect,{to:\"/\"});}return/*#__PURE__*/React.createElement(\"div\",{className:\"form form--signup\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-inner\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(FormField,{isValid:!isValid,field:{label:\"用户名\"},input:{id:\"username\",name:\"username\",type:\"text\",placeholder:\"用户名\",maxLength:12,onChange:userChange,onBlur:outOfFocus,ref:refUsername}}),isValid===1?/*#__PURE__*/React.createElement(\"p\",{style:{color:\"#e4451b\",marginTop:-15,marginBottom:20}},\"6-12\\u4E2A\\u5B57\\u6BCD\\u6570\\u5B57\"):null,isValid===2?/*#__PURE__*/React.createElement(\"p\",{style:{color:\"#e4451b\",marginTop:-15,marginBottom:20}},\"\\u7528\\u6237\\u540D\\u5DF2\\u5B58\\u5728\"):null,/*#__PURE__*/React.createElement(FormField,{isValid:!isValidPassword,field:{label:\"密码\"},input:{id:\"password\",name:\"password\",type:\"password\",placeholder:\"密码\",required:true,onFocus:onFocus,onChange:userChange,onBlur:outOfFocus,ref:refPassword}}),isValidPassword===1?/*#__PURE__*/React.createElement(\"p\",{style:{color:\"#e4451b\",marginTop:-15,marginBottom:20}},\"\\u5BC6\\u7801\\u6700\\u77ED\\u4E3A6\\u4F4D\"):null,/*#__PURE__*/React.createElement(FormField,{isValid:!isValidPasswordok,field:{label:\"再次输入密码\"},input:{id:\"passwordok\",name:\"passwordok\",type:\"password\",placeholder:\"再次输入密码\",required:true,onFocus:onFocus,onChange:userChange,onBlur:outOfFocus,ref:refPasswordOK}}),isValidPasswordok===1?/*#__PURE__*/React.createElement(\"p\",{style:{color:\"#e4451b\",marginTop:-15,marginBottom:20}},\"\\u4E24\\u6B21\\u8F93\\u5165\\u5BC6\\u7801\\u4E0D\\u4E00\\u81F4\"):null,/*#__PURE__*/React.createElement(FormField,{isValid:!isValidTelephone,field:{label:\"请输入手机号码\"},input:{id:\"telephone\",name:\"telephone\",type:\"text\",placeholder:\"11位手机号\",maxLength:11,required:true,onChange:userChange,onFocus:onFocus,onBlur:outOfFocus,ref:refTelephone,onInput:function onInput(){return refTelephone.current.value=refTelephone.current.value.replace(/[^0-9]/g,\"\");}}}),isValidTelephone===1?/*#__PURE__*/React.createElement(\"p\",{style:{color:\"#e4451b\",marginTop:-15,marginBottom:20}},\"\\u8BF7\\u8F93\\u516511\\u4F4D\\u624B\\u673A\\u53F7\"):null,/*#__PURE__*/React.createElement(FormField,{field:{label:\"好友优惠推荐码(选填)\"},input:{id:\"agentName\",name:\"agentName\",type:\"text\",placeholder:\"好友优惠推荐码(选填)\",required:true,onChange:userChange,onFocus:onFocus,ref:refRef,defaultValue:agent}})),/*#__PURE__*/React.createElement(\"button\",{className:\"submit \".concat(active?\"active\":null),onClick:active?userCreate:null},\"\\u6CE8\\u518C\")));}function Login(){var agentName=JSON.parse(localStorage.getItem(\"referral\"));var query=useQuery();var history=useHistory();var initialTab=agentName?\"signup\":\"signin\";var _useState27=useState(query.get(\"tab\")||initialTab),_useState28=_slicedToArray(_useState27,2),tab=_useState28[0],setTab=_useState28[1];var _useState29=useState(false),_useState30=_slicedToArray(_useState29,2),isLoading=_useState30[0],setLoading=_useState30[1];useEffect(function(){window.scrollTo(0,0);document.body.classList.add(\"pwa-login-page\");return function(){return document.body.classList.remove(\"pwa-login-page\");};},[]);useEffect(function(){localStorage.removeItem(\"referral\");history.push({search:\"?tab=\".concat(tab)});},[history,tab]);return/*#__PURE__*/React.createElement(\"div\",{className:\"login-form-sa\"},/*#__PURE__*/React.createElement(\"div\",{className:\"login-form-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"login-form-outer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"login-form-inner with-loader\".concat(isLoading?\" loading\":\"\")},/*#__PURE__*/React.createElement(\"div\",{className:\"load-spin\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"logo\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"divider\"},\"\\u8D5E\\u52A9\\u4F19\\u4F34\"),/*#__PURE__*/React.createElement(\"div\",{className:\"sub-logo\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"sub-text\"},\"\\u5965\\u683C\\u65AF\\u5821\"),/*#__PURE__*/React.createElement(\"div\",{className:\"auth-tabs\"},/*#__PURE__*/React.createElement(UITabs,{tabs:[{index:\"signin\",name:\"登录\"},{index:\"signup\",name:\"注册\"}],tab:tab,onSet:setTab})),/*#__PURE__*/React.createElement(\"div\",{className:\"auth-forms tab--\".concat(tab)},/*#__PURE__*/React.createElement(FormSignin,{onLoading:setLoading}),/*#__PURE__*/React.createElement(FormSignup,{onLoading:setLoading,agentName:agentName}))))));}export default Login;","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/ubet-project (1)/src/pwa/view/Login.js"],"names":["React","useState","useEffect","useRef","Link","Redirect","useHistory","useLocation","UITabs","FormField","User","Service","useQuery","URLSearchParams","search","FormSignin","props","onLoading","state","referrer","refUsername","refPassword","isValid","setValidity","isLogged","setLogged","active","setActive","username","password","user","setUser","userChange","e","target","name","value","userLogin","current","focus","req","login","promise","then","r","localStorage","setItem","JSON","stringify","pathname","from_login","label","id","type","placeholder","required","onChange","ref","color","marginTop","marginBottom","FormSignup","refPasswordOK","refTelephone","refRef","isValidPassword","setPasswordValidity","isValidPasswordok","setPasswordokValidity","isValidTelephone","setTelephoneValidity","isCreated","setCreated","agentName","agent","oldUsername","setOldUsername","passwordok","onFocus","length","outOfFocus","userValid","test","telephone","userCreate","create","console","warn","maxLength","onBlur","onInput","replace","defaultValue","Login","parse","getItem","query","history","initialTab","get","tab","setTab","isLoading","setLoading","window","scrollTo","document","body","classList","add","remove","removeItem","push","index"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport { Link, Redirect, useHistory, useLocation } from \"react-router-dom\";\r\n\r\nimport { UITabs, FormField } from \"../../component/\";\r\nimport { User as Service } from \"../../service/\";\r\n\r\nimport \"../assets/scss/LoginSA.scss\";\r\n\r\nfunction useQuery() {\r\n  return new URLSearchParams(useLocation().search);\r\n}\r\n\r\nfunction FormSignin(props) {\r\n  const { onLoading } = props;\r\n\r\n  const { state: { referrer = \"/\" } = {} } = useLocation();\r\n\r\n  const refUsername = useRef(null);\r\n  const refPassword = useRef(null);\r\n\r\n  const [isValid, setValidity] = useState(true);\r\n  const [isLogged, setLogged] = useState(false);\r\n  const [active, setActive] = useState(false);\r\n\r\n  const [user, setUser] = useState({\r\n    username: null,\r\n    password: null,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (isValid && user.username !== null && user.password !== null)\r\n      setActive(true);\r\n  }, [user, isValid]);\r\n\r\n  function userChange(e) {\r\n    if (\r\n      !isValid &&\r\n      (e.target.name === \"password\" ||\r\n        (e.target.name === \"username\" && user.password))\r\n    ) {\r\n      setValidity(true);\r\n    }\r\n\r\n    setUser({\r\n      ...user,\r\n      [e.target.name]: e.target.value,\r\n    });\r\n  }\r\n\r\n  function userLogin() {\r\n    if (!user.password) {\r\n      return void refPassword.current.focus();\r\n    }\r\n\r\n    onLoading(true);\r\n\r\n    const req = Service.login(user);\r\n\r\n    req.promise.then(\r\n      (r) => {\r\n        localStorage.setItem(\"user\", JSON.stringify(user));\r\n\r\n        onLoading(false);\r\n\r\n        setLogged(true);\r\n      },\r\n      (e) => {\r\n        onLoading(false);\r\n\r\n        setValidity(false);\r\n        setActive(false);\r\n\r\n        refPassword.current.focus();\r\n      }\r\n    );\r\n  }\r\n\r\n  if (isLogged) {\r\n    return (\r\n      <Redirect\r\n        to={{\r\n          pathname: referrer,\r\n          state: { from_login: true },\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"form form--signin\">\r\n      <div className=\"form-inner\">\r\n        <div>\r\n          <FormField\r\n            field={{ label: \"用户名\" }}\r\n            input={{\r\n              id: \"username1\",\r\n              name: \"username\",\r\n              type: \"text\",\r\n              placeholder: \"用户名\",\r\n              required: true,\r\n              onChange: userChange,\r\n              ref: refUsername,\r\n            }}\r\n          />\r\n          <FormField\r\n            isValid={isValid}\r\n            field={{ label: \"密码\" }}\r\n            input={{\r\n              id: \"password1\",\r\n              name: \"password\",\r\n              type: \"password\",\r\n              placeholder: \"密码\",\r\n              required: true,\r\n              onChange: userChange,\r\n              ref: refPassword,\r\n            }}\r\n          />\r\n          {!isValid ? (\r\n            <p style={{ color: \"#e4451b\", marginTop: -15, marginBottom: 20 }}>\r\n              用户名或密码输入不正确\r\n            </p>\r\n          ) : null}\r\n        </div>\r\n        <button\r\n          className={`submit ${active ? \"active\" : null}`}\r\n          onClick={active ? userLogin : null}\r\n        >\r\n          登录\r\n        </button>\r\n      </div>\r\n      <div className=\"restore-wrap\">\r\n        <Link to=\"/restore\">忘记密码了吗 ？</Link>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction FormSignup(props) {\r\n  const { onLoading } = props;\r\n\r\n  const refUsername = useRef(null);\r\n  const refPassword = useRef(null);\r\n  const refPasswordOK = useRef(null);\r\n  const refTelephone = useRef(null);\r\n  const refRef = useRef(null);\r\n\r\n  const [isValid, setValidity] = useState(0);\r\n  const [isValidPassword, setPasswordValidity] = useState(0);\r\n  const [isValidPasswordok, setPasswordokValidity] = useState(0);\r\n  const [isValidTelephone, setTelephoneValidity] = useState(0);\r\n  const [isCreated, setCreated] = useState(false);\r\n  const [agent] = useState(props.agentName);\r\n  const [active, setActive] = useState(false);\r\n  const [oldUsername, setOldUsername] = useState(\"null\");\r\n\r\n  const [user, setUser] = useState({\r\n    username: null,\r\n    password: null,\r\n    passwordok: null,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!user.agentName && agent) {\r\n      setUser({\r\n        ...user,\r\n        agentName: agent,\r\n      });\r\n    }\r\n  }, [user, agent]);\r\n\r\n  function onFocus() {\r\n    if (!user.username || user.username.length < 6) {\r\n      void refUsername.current.focus();\r\n    }\r\n  }\r\n\r\n  function outOfFocus(e) {\r\n    const userValid = !user.username || user.username.length < 6;\r\n    if (e.target.id === \"username\") {\r\n      if (!/^[a-z0-9]{6,12}$/i.test(user.username)) {\r\n        setValidity(1);\r\n        return null;\r\n      } else if (isValid !== 2) {\r\n        return setValidity(0);\r\n      }\r\n    }\r\n    if (e.target.id === \"password\") {\r\n      if (!userValid && user.password) {\r\n        if (user.password.length < 6) return setPasswordValidity(1);\r\n        else return setPasswordValidity(0);\r\n      } else {\r\n        return setPasswordValidity(0);\r\n      }\r\n    }\r\n\r\n    if (e.target.id === \"passwordok\") {\r\n      if (!userValid && user.password !== user.passwordok) {\r\n        setPasswordokValidity(1);\r\n        return null;\r\n      } else {\r\n        return setPasswordokValidity(0);\r\n      }\r\n    }\r\n\r\n    if (e.target.id === \"telephone\") {\r\n      if (!userValid && user.telephone) {\r\n        if (user.telephone.length !== 11) setTelephoneValidity(1);\r\n        return null;\r\n      }\r\n    }\r\n  }\r\n\r\n  function userChange(e) {\r\n    if (e.target.name === \"telephone\") {\r\n      if (e.target.value.length === 11) {\r\n        setActive(true);\r\n        setTelephoneValidity(0);\r\n      } else if (active && !isValidTelephone) {\r\n        setActive(false);\r\n        setTelephoneValidity(1);\r\n      }\r\n    }\r\n\r\n    if (e.target.name === \"username\") {\r\n      if (isValid === 2 && e.target.value !== oldUsername) {\r\n        setValidity(0);\r\n      }\r\n    }\r\n\r\n    setUser({\r\n      ...user,\r\n      [e.target.name]: e.target.value,\r\n    });\r\n  }\r\n\r\n  function userCreate() {\r\n    onLoading(true);\r\n\r\n    const req = Service.create(user);\r\n\r\n    req.promise.then(\r\n      (r) => {\r\n        localStorage.setItem(\r\n          \"user\",\r\n          JSON.stringify({\r\n            username: user.username,\r\n            password: user.password,\r\n          })\r\n        );\r\n\r\n        onLoading(false);\r\n\r\n        setCreated(true);\r\n      },\r\n      (e) => {\r\n        console.warn(e);\r\n\r\n        onLoading(false);\r\n\r\n        setValidity(2);\r\n        setOldUsername(user.username);\r\n\r\n        refUsername.current.focus();\r\n      }\r\n    );\r\n  }\r\n\r\n  if (isCreated) {\r\n    return <Redirect to=\"/\" />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"form form--signup\">\r\n      <div className=\"form-inner\">\r\n        <div>\r\n          <FormField\r\n            isValid={!isValid}\r\n            field={{ label: \"用户名\" }}\r\n            input={{\r\n              id: \"username\",\r\n              name: \"username\",\r\n              type: \"text\",\r\n              placeholder: \"用户名\",\r\n              maxLength: 12,\r\n              onChange: userChange,\r\n              onBlur: outOfFocus,\r\n              ref: refUsername,\r\n            }}\r\n          />\r\n          {isValid === 1 ? (\r\n            <p style={{ color: \"#e4451b\", marginTop: -15, marginBottom: 20 }}>\r\n              6-12个字母数字\r\n            </p>\r\n          ) : null}\r\n          {isValid === 2 ? (\r\n            <p style={{ color: \"#e4451b\", marginTop: -15, marginBottom: 20 }}>\r\n              用户名已存在\r\n            </p>\r\n          ) : null}\r\n          <FormField\r\n            isValid={!isValidPassword}\r\n            field={{ label: \"密码\" }}\r\n            input={{\r\n              id: \"password\",\r\n              name: \"password\",\r\n              type: \"password\",\r\n              placeholder: \"密码\",\r\n              required: true,\r\n              onFocus: onFocus,\r\n              onChange: userChange,\r\n              onBlur: outOfFocus,\r\n              ref: refPassword,\r\n            }}\r\n          />\r\n          {isValidPassword === 1 ? (\r\n            <p style={{ color: \"#e4451b\", marginTop: -15, marginBottom: 20 }}>\r\n              密码最短为6位\r\n            </p>\r\n          ) : null}\r\n          <FormField\r\n            isValid={!isValidPasswordok}\r\n            field={{ label: \"再次输入密码\" }}\r\n            input={{\r\n              id: \"passwordok\",\r\n              name: \"passwordok\",\r\n              type: \"password\",\r\n              placeholder: \"再次输入密码\",\r\n              required: true,\r\n              onFocus: onFocus,\r\n              onChange: userChange,\r\n              onBlur: outOfFocus,\r\n              ref: refPasswordOK,\r\n            }}\r\n          />\r\n          {isValidPasswordok === 1 ? (\r\n            <p style={{ color: \"#e4451b\", marginTop: -15, marginBottom: 20 }}>\r\n              两次输入密码不一致\r\n            </p>\r\n          ) : null}\r\n          <FormField\r\n            isValid={!isValidTelephone}\r\n            field={{ label: \"请输入手机号码\" }}\r\n            input={{\r\n              id: \"telephone\",\r\n              name: \"telephone\",\r\n              type: \"text\",\r\n              placeholder: \"11位手机号\",\r\n              maxLength: 11,\r\n              required: true,\r\n              onChange: userChange,\r\n              onFocus: onFocus,\r\n              onBlur: outOfFocus,\r\n              ref: refTelephone,\r\n              onInput: () =>\r\n                (refTelephone.current.value = refTelephone.current.value.replace(\r\n                  /[^0-9]/g,\r\n                  \"\"\r\n                )),\r\n            }}\r\n          />\r\n          {isValidTelephone === 1 ? (\r\n            <p style={{ color: \"#e4451b\", marginTop: -15, marginBottom: 20 }}>\r\n              请输入11位手机号\r\n            </p>\r\n          ) : null}\r\n          <FormField\r\n            field={{ label: \"好友优惠推荐码(选填)\" }}\r\n            input={{\r\n              id: \"agentName\",\r\n              name: \"agentName\",\r\n              type: \"text\",\r\n              placeholder: \"好友优惠推荐码(选填)\",\r\n              required: true,\r\n              onChange: userChange,\r\n              onFocus: onFocus,\r\n              ref: refRef,\r\n              defaultValue: agent,\r\n            }}\r\n          />\r\n        </div>\r\n        <button\r\n          className={`submit ${active ? \"active\" : null}`}\r\n          onClick={active ? userCreate : null}\r\n        >\r\n          注册\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Login() {\r\n  const agentName = JSON.parse(localStorage.getItem(\"referral\"));\r\n\r\n  const query = useQuery();\r\n  const history = useHistory();\r\n  const initialTab = agentName ? \"signup\" : \"signin\";\r\n  const [tab, setTab] = useState(query.get(\"tab\") || initialTab);\r\n  const [isLoading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n\r\n    document.body.classList.add(\"pwa-login-page\");\r\n\r\n    return () => document.body.classList.remove(\"pwa-login-page\");\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    localStorage.removeItem(\"referral\");\r\n    history.push({ search: `?tab=${tab}` });\r\n  }, [history, tab]);\r\n\r\n  return (\r\n    <div className=\"login-form-sa\">\r\n      <div className=\"login-form-wrap\">\r\n        <div className=\"login-form-outer\">\r\n          <div\r\n            className={`login-form-inner with-loader${\r\n              isLoading ? \" loading\" : \"\"\r\n            }`}\r\n          >\r\n            <div className=\"load-spin\"></div>\r\n            <div className=\"logo\"></div>\r\n            {/* ============ JEAN ============  */}\r\n            <div className=\"divider\">赞助伙伴</div>\r\n            <div className=\"sub-logo\"></div>\r\n            <div className=\"sub-text\">奥格斯堡</div>\r\n            {/* ============ JEAN ============  */}\r\n            <div className=\"auth-tabs\">\r\n              <UITabs\r\n                tabs={[\r\n                  { index: \"signin\", name: \"登录\" },\r\n                  { index: \"signup\", name: \"注册\" },\r\n                ]}\r\n                tab={tab}\r\n                onSet={setTab}\r\n              />\r\n            </div>\r\n            <div className={`auth-forms tab--${tab}`}>\r\n              <FormSignin onLoading={setLoading} />\r\n              <FormSignup onLoading={setLoading} agentName={agentName} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}