{"ast":null,"code":"import _defineProperty from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useCallback,useRef}from\"react\";import moment from\"moment\";//import { deviceDetect } from 'mobile-device-detect';\n//import DeviceInfo from 'react-native-device-info';\nimport{Link}from\"react-router-dom\";import{mobileModel}from\"react-device-detect\";import{Wrap,Service}from\"./\";import{UIAlertSA,LiveChatSA}from\"../../component/\";import{FormField}from\"../../../component/\";import{withAuth}from\"../../util\";//import {getCurrentDate} from \"../../../util\";\n//import { getDates } from \"../../../util\";\nvar Switch=function Switch(){return/*#__PURE__*/React.createElement(\"label\",{className:\"switch\"},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"slider round\"}));};var Personal=function Personal(){var _useContext=useContext(Service.User.Context),user=_useContext.userAuth.data;// const [status, setStatus] = useState(1);\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),editKey=_useState2[0],setEditKey=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),eye=_useState4[0],setEye=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),livechat=_useState6[0],setLiveChat=_useState6[1];var refPassword=useRef(null);var _dateParse=useCallback(function(date){var _parsed=(date||\"\").match(/([\\d]{4})年([\\d]{1,2})月([\\d]{1,2})日/);if(!_parsed){return{year:null,month:null,day:null};}var _date={year:+_parsed[1],month:+_parsed[2],day:+_parsed[3]};return _date;},[]);var _useState7=useState({email:user.email||\"\",name:user.realName||\"\",birthday:_dateParse(user.birthday)||\"\",number:user.telephone||\"\",qq:user.qq||\"\",wechat:user.wechat||\"\",device:mobileModel,//\"Huawei Mate 20 Pro\",\nupdates:[{text:\"1.08.27\"},{text:moment().format(\"MMM DD hh:mm:ss YYYY\")}]}),_useState8=_slicedToArray(_useState7,2),form=_useState8[0],setForm=_useState8[1];var _useState9=useState({email:!!user.email,name:!!user.realName,birthday:!!_dateParse(user.birthday).year,number:!!user.telephone,qq:!!user.qq}),_useState10=_slicedToArray(_useState9,2),subform=_useState10[0],setSubform=_useState10[1];var _dateFormat=useCallback(function(date){return date.year?\"\".concat(date.year,\"\\u5E74\").concat(date.month,\"\\u6708\").concat(date.day,\"\\u65E5\"):\"请选择一个日期\";},[]);var fields=[{field:{label:\"真实姓名\",class:\"name\",type:\"link\",link:\"fullname\"},input:{id:\"name\",type:\"text\",name:\"name\"}},{field:{label:\"出生日期\",class:\"birthday\",// type: \"input\",\ntype:\"link\",link:\"birthdate\"},input:{id:\"birthday\",type:\"text\",name:\"birthday\",readOnly:true}},{field:{label:\"手机号码\",class:\"contact group top\",type:\"link\",link:\"cellphone\"},input:{id:\"number\",type:\"text\",name:\"number\"}},{field:{label:\"邮箱地址\",class:\"email group\",type:\"link\",link:\"email\"},input:{id:\"email\",type:\"email\",name:\"email\"}},{field:{label:\"修改密码\",class:\"password group bottom\",type:\"link\",link:\"password\"},input:{id:\"password\",type:\"password\",name:\"password\"}},{field:{label:\"夜间模式\",class:\"nightmode\",type:\"button\"},input:{name:\"nigtmode\"}},{field:{label:\"设备信息\",class:\"device group top\",type:\"text\"},input:{id:\"device\",type:\"text\",readOnly:true,name:\"device\"}},{field:{label:\"清理缓存\",class:\"cache group\",type:\"text\",link:\"\"}},/*{\r\n       field: {\r\n         label: \"清理缓存\",\r\n         class: \"cache group\",\r\n         link: \"cache\",\r\n       },\r\n       input: {\r\n         readOnly: true,\r\n         name: \"cache\",\r\n       },\r\n     },*/{field:{label:\"检查更新\",class:\"updates group bottom\",type:\"text\"},input:{id:\"updates\",type:\"text\",readOnly:true,name:\"updates\"}}];var onChange=function onChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setForm(function(f){return _objectSpread(_objectSpread({},f),{},_defineProperty({},name,value));});};var onVision=function onVision(){if(refPassword.current.type===\"password\"){refPassword.current.type=\"text\";setEye(true);return false;}refPassword.current.type=\"password\";setEye(false);};return/*#__PURE__*/React.createElement(Wrap,{className:\"profile-personal\",name:\"\\u4E2A\\u4EBA\\u8D44\\u6599\"// isLoading={!status}\n},/*#__PURE__*/React.createElement(\"div\",{className:\"fields\"},fields.map(function(f,i){var inputVal=\"\";if(f.input){inputVal=form[f.input.name]?form[f.input.name]:\"\";if(f.input.name===\"birthday\"){inputVal=_dateFormat(form[f.input.name]);}}if(f.field.type===\"link\"&&(inputVal===\"请选择一个日期\"||f.field.class===\"contact group top\"&&user.phone_verify===\"0\"||!inputVal)){return/*#__PURE__*/React.createElement(Link,{className:\"field-item \".concat(f.field.class),key:i,to:f.field.link},/*#__PURE__*/React.createElement(\"i\",null),/*#__PURE__*/React.createElement(\"p\",null,f.field.label),!inputVal&&/*#__PURE__*/React.createElement(\"span\",null),inputVal&&/*#__PURE__*/React.createElement(\"label\",null,inputVal?inputVal:null));}return/*#__PURE__*/React.createElement(\"div\",{className:\"field-item 123 \".concat(f.field.class),key:i},/*#__PURE__*/React.createElement(\"i\",null),/*#__PURE__*/React.createElement(\"p\",null,f.field.label),f.field.type===\"button\"&&/*#__PURE__*/React.createElement(Switch,null),f.input&&f.field.type===\"input\"&&/*#__PURE__*/React.createElement(FormField,{field:_objectSpread({},f.field),input:_objectSpread(_objectSpread({},f.input),{},{onChange:onChange,onBlur:function onBlur(){return setEditKey(null);},value:form[f.input.name]?form[f.input.name]:\"\",disabled:subform[f.input.name]})}),inputVal&&Array.isArray(inputVal)?/*#__PURE__*/React.createElement(\"span\",{className:\"value\"},inputVal.map(function(obj,key){return/*#__PURE__*/React.createElement(\"div\",{key:key},obj.text);})):f.input&&f.input.type!==\"password\"&&/*#__PURE__*/React.createElement(\"span\",{className:\"value\",onClick:function onClick(){return f.input.name===\"birthday\"||f.input.name===\"email\"||f.input.name===\"number\"&&user.phone_verify===\"1\"?setEditKey(true):null;}},inputVal),inputVal&&f.input&&f.input.type===\"password\"&&[/*#__PURE__*/React.createElement(\"input\",{key:\"password\",className:\"readOnly\",ref:refPassword,type:f.input.type,value:inputVal,readOnly:true,onClick:function onClick(){return setEditKey(i);}}),/*#__PURE__*/React.createElement(\"i\",{key:\"eye\",className:\"eye\".concat(eye?\" vision\":\"\"),onClick:function onClick(){return onVision();}})]);})),/*#__PURE__*/React.createElement(UIAlertSA,{onClose:function onClose(){return setTimeout(function(){setEditKey(false);},200);},shown:editKey},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-error-update-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-error-update-head\"},/*#__PURE__*/React.createElement(\"h3\",null,\"\\u8BF7\\u6CE8\\u610F \",/*#__PURE__*/React.createElement(\"i\",null))),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-error-update-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"m-e-u-b-text\"},/*#__PURE__*/React.createElement(\"i\",{onClick:function onClick(){setEditKey(false);setLiveChat(true);}}),/*#__PURE__*/React.createElement(\"p\",null,\"\\u5982\\u9700\\u66F4\\u6539\\u6B64\\u4FE1\\u606F\\u8BF7\\u8054\\u7CFB\\u5BA2\\u670D\\u534F\\u52A9\"),/*#__PURE__*/React.createElement(\"p\",null,\"\\u8C22\\u8C22\"))))),/*#__PURE__*/React.createElement(LiveChatSA,{shown:livechat,onClose:function onClose(){return setLiveChat(false);}}));};export default withAuth(Personal,1);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/pwa/view/profile/Personal.jsx"],"names":["React","useState","useContext","useCallback","useRef","moment","Link","mobileModel","Wrap","Service","UIAlertSA","LiveChatSA","FormField","withAuth","Switch","Personal","User","Context","user","userAuth","data","editKey","setEditKey","eye","setEye","livechat","setLiveChat","refPassword","_dateParse","date","_parsed","match","year","month","day","_date","email","name","realName","birthday","number","telephone","qq","wechat","device","updates","text","format","form","setForm","subform","setSubform","_dateFormat","fields","field","label","class","type","link","input","id","readOnly","onChange","e","target","value","f","onVision","current","map","i","inputVal","phone_verify","onBlur","disabled","Array","isArray","obj","key","setTimeout"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useCallback, useRef } from \"react\";\r\nimport moment from \"moment\";\r\n//import { deviceDetect } from 'mobile-device-detect';\r\n//import DeviceInfo from 'react-native-device-info';\r\nimport { Link } from \"react-router-dom\";\r\nimport { mobileModel } from \"react-device-detect\";\r\nimport { Wrap, Service } from \"./\";\r\nimport { UIAlertSA, LiveChatSA } from \"../../component/\";\r\nimport { FormField } from \"../../../component/\";\r\nimport { withAuth } from \"../../util\";\r\n//import {getCurrentDate} from \"../../../util\";\r\n\r\n//import { getDates } from \"../../../util\";\r\n\r\n\r\n\r\n\r\nconst Switch = () => {\r\n  return (\r\n    <label className=\"switch\">\r\n      <input type=\"checkbox\" />\r\n      <span className=\"slider round\"></span>\r\n    </label>\r\n  );\r\n};\r\n\r\nconst Personal = () => {\r\n  const {\r\n    userAuth: { data: user },\r\n    // setUserAuthFN,\r\n  } = useContext(Service.User.Context);\r\n\r\n  // const [status, setStatus] = useState(1);\r\n  const [editKey, setEditKey] = useState(false);\r\n  const [eye, setEye] = useState(false);\r\n  const [livechat, setLiveChat] = useState(false);\r\n\r\n  const refPassword = useRef(null);\r\n\r\n  const _dateParse = useCallback((date) => {\r\n    const _parsed = (date || \"\").match(/([\\d]{4})年([\\d]{1,2})月([\\d]{1,2})日/);\r\n\r\n    if (!_parsed) {\r\n      return {\r\n        year: null,\r\n        month: null,\r\n        day: null,\r\n      };\r\n    }\r\n\r\n    const _date = {\r\n      year: +_parsed[1],\r\n      month: +_parsed[2],\r\n      day: +_parsed[3],\r\n    };\r\n\r\n    return _date;\r\n  }, []);\r\n\r\n  const [form, setForm] = useState({\r\n    email: user.email || \"\",\r\n    name: user.realName || \"\",\r\n    birthday: _dateParse(user.birthday) || \"\",\r\n    number: user.telephone || \"\",\r\n    qq: user.qq || \"\",\r\n    wechat: user.wechat || \"\",\r\n    device: mobileModel, //\"Huawei Mate 20 Pro\",\r\n    updates: [{ text: \"1.08.27\" }, { text: moment().format(\"MMM DD hh:mm:ss YYYY\")}],\r\n  });\r\n\r\n  const [subform, setSubform] = useState({\r\n    email: !!user.email,\r\n    name: !!user.realName,\r\n    birthday: !!_dateParse(user.birthday).year,\r\n    number: !!user.telephone,\r\n    qq: !!user.qq,\r\n  });\r\n\r\n  const _dateFormat = useCallback(\r\n    (date) =>\r\n      date.year\r\n        ? `${date.year}年${date.month}月${date.day}日`\r\n        : \"请选择一个日期\",\r\n    []\r\n  );\r\n\r\n  const fields = [\r\n    {\r\n      field: {\r\n        label: \"真实姓名\",\r\n        class: \"name\",\r\n        type: \"link\",\r\n        link: \"fullname\",\r\n      },\r\n      input: {\r\n        id: \"name\",\r\n        type: \"text\",\r\n        name: \"name\",\r\n      },\r\n    },\r\n    {\r\n      field: {\r\n        label: \"出生日期\",\r\n        class: \"birthday\",\r\n        // type: \"input\",\r\n        type: \"link\",\r\n        link: \"birthdate\",\r\n      },\r\n      input: {\r\n        id: \"birthday\",\r\n        type: \"text\",\r\n        name: \"birthday\",\r\n        readOnly: true,\r\n      },\r\n    },\r\n    {\r\n      field: {\r\n        label: \"手机号码\",\r\n        class: \"contact group top\",\r\n        type: \"link\",\r\n        link: \"cellphone\",\r\n      },\r\n      input: {\r\n        id: \"number\",\r\n        type: \"text\",\r\n        name: \"number\",\r\n      },\r\n    },\r\n    {\r\n      field: {\r\n        label: \"邮箱地址\",\r\n        class: \"email group\",\r\n        type: \"link\",\r\n        link: \"email\",\r\n      },\r\n      input: {\r\n        id: \"email\",\r\n        type: \"email\",\r\n        name: \"email\",\r\n      },\r\n    },\r\n    {\r\n      field: {\r\n        label: \"修改密码\",\r\n        class: \"password group bottom\",\r\n        type: \"link\",\r\n        link: \"password\",\r\n      },\r\n      input: {\r\n        id: \"password\",\r\n        type: \"password\",\r\n        name: \"password\",\r\n      },\r\n    },\r\n    {\r\n      field: {\r\n        label: \"夜间模式\",\r\n        class: \"nightmode\",\r\n        type: \"button\",\r\n      },\r\n      input: {\r\n        name: \"nigtmode\",\r\n      },\r\n    },\r\n    {\r\n      field: {\r\n        label: \"设备信息\",\r\n        class: \"device group top\",\r\n        type: \"text\",\r\n      },\r\n      input: {\r\n        id: \"device\",\r\n        type: \"text\",\r\n        readOnly: true,\r\n        name: \"device\",\r\n      },\r\n    },\r\n     {\r\n       field: {\r\n         label: \"清理缓存\",\r\n         class: \"cache group\",\r\n         type: \"text\",\r\n         link: \"\",\r\n       },\r\n     },\r\n     /*{\r\n       field: {\r\n         label: \"清理缓存\",\r\n         class: \"cache group\",\r\n         link: \"cache\",\r\n       },\r\n       input: {\r\n         readOnly: true,\r\n         name: \"cache\",\r\n       },\r\n     },*/\r\n     {\r\n       field: {\r\n         label: \"检查更新\",\r\n         class: \"updates group bottom\",\r\n         type: \"text\",\r\n       },\r\n       input: {\r\n         id: \"updates\",\r\n         type: \"text\",\r\n         readOnly: true,\r\n         name: \"updates\",\r\n       },\r\n     },\r\n  ];\r\n\r\n  const onChange = (e) => {\r\n    const { name, value } = e.target;\r\n\r\n    setForm((f) => ({\r\n      ...f,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const onVision = () => {\r\n    if (refPassword.current.type === \"password\") {\r\n      refPassword.current.type = \"text\";\r\n      setEye(true);\r\n      return false;\r\n    }\r\n    refPassword.current.type = \"password\";\r\n    setEye(false);\r\n  };\r\n\r\n  return (\r\n    <Wrap\r\n      className=\"profile-personal\"\r\n      name=\"个人资料\"\r\n      // isLoading={!status}\r\n    >\r\n      <div className=\"fields\">\r\n        {fields.map((f, i) => {\r\n          let inputVal = \"\";\r\n          if (f.input) {\r\n            inputVal = form[f.input.name] ? form[f.input.name] : \"\";\r\n            if (f.input.name === \"birthday\") {\r\n              inputVal = _dateFormat(form[f.input.name]);\r\n            }\r\n          }\r\n\r\n          if (\r\n            f.field.type === \"link\" &&\r\n            (inputVal === \"请选择一个日期\" ||\r\n              (f.field.class === \"contact group top\" &&\r\n                user.phone_verify === \"0\") ||\r\n              !inputVal)\r\n          ) {\r\n            return (\r\n              <Link\r\n                className={`field-item ${f.field.class}`}\r\n                key={i}\r\n                to={f.field.link}\r\n              >\r\n                <i />\r\n                <p>{f.field.label}</p>\r\n                {!inputVal && <span />}\r\n                {inputVal && <label>{inputVal ? inputVal : null}</label>}\r\n              </Link>\r\n            );\r\n          }\r\n\r\n          return (\r\n            <div className={`field-item 123 ${f.field.class}`} key={i}>\r\n              <i />\r\n              <p>{f.field.label}</p>\r\n              {f.field.type === \"button\" && <Switch />}\r\n              {f.input && f.field.type === \"input\" && (\r\n                <FormField\r\n                  field={{\r\n                    ...f.field,\r\n                  }}\r\n                  input={{\r\n                    ...f.input,\r\n                    onChange,\r\n                    onBlur: () => setEditKey(null),\r\n                    value: form[f.input.name] ? form[f.input.name] : \"\",\r\n                    disabled: subform[f.input.name],\r\n                  }}\r\n                />\r\n              )}\r\n\r\n              {inputVal && Array.isArray(inputVal) ? (\r\n                <span className=\"value\">\r\n                  {inputVal.map((obj, key) => {\r\n                    return <div key={key}>{obj.text}</div>;\r\n                  })}\r\n                </span>\r\n              ) : (\r\n                f.input &&\r\n                f.input.type !== \"password\" && (\r\n                  <span\r\n                    className=\"value\"\r\n                    onClick={() =>\r\n                      f.input.name === \"birthday\" ||\r\n                      f.input.name === \"email\" ||\r\n                      (f.input.name === \"number\" && user.phone_verify === \"1\")\r\n                        ? setEditKey(true)\r\n                        : null\r\n                    }\r\n                  >\r\n                    {inputVal}\r\n                  </span>\r\n                )\r\n              )}\r\n\r\n              {inputVal &&\r\n                f.input &&\r\n                f.input.type === \"password\" && [\r\n                  <input\r\n                    key=\"password\"\r\n                    className=\"readOnly\"\r\n                    ref={refPassword}\r\n                    type={f.input.type}\r\n                    value={inputVal}\r\n                    readOnly\r\n                    onClick={() => setEditKey(i)}\r\n                  />,\r\n                  <i\r\n                    key=\"eye\"\r\n                    className={`eye${eye ? \" vision\" : \"\"}`}\r\n                    onClick={() => onVision()}\r\n                  />,\r\n                ]}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n      <UIAlertSA\r\n        onClose={() =>\r\n          setTimeout(() => {\r\n            setEditKey(false);\r\n          }, 200)\r\n        }\r\n        shown={editKey}\r\n      >\r\n        <div className=\"modal-error-update-wrap\">\r\n          <div className=\"modal-error-update-head\">\r\n            <h3>\r\n              请注意 <i />\r\n            </h3>\r\n          </div>\r\n          <div className=\"modal-error-update-body\">\r\n            <div className=\"m-e-u-b-text\">\r\n              <i\r\n                onClick={() => {\r\n                  setEditKey(false);\r\n                  setLiveChat(true);\r\n                }}\r\n              />\r\n              <p>如需更改此信息请联系客服协助</p>\r\n              <p>谢谢</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </UIAlertSA>\r\n      <LiveChatSA shown={livechat} onClose={() => setLiveChat(false)} />\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default withAuth(Personal, 1);\r\n"]},"metadata":{},"sourceType":"module"}