{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Documents/New PWA/ubet-project (1)/src/pwa/view/profile/Withdraw.jsx\";\nimport React, { useState, useEffect, useMemo, useContext } from \"react\"; // import { Link } from \"react-router-dom\";\n// import Picker from \"react-mobile-picker\";\n\nimport DatePicker from \"react-mobile-datepicker\";\nimport cx from \"classnames\";\nimport * as moment from \"moment\";\nimport BigNumber from \"bignumber.js\";\nimport { reverse, isEmpty, size } from \"lodash\";\nimport { Wrap } from \"./\";\nimport { toDate } from \"../../../util/\";\nimport { FormField //  UITabs\n} from \"../../../component/\";\nimport { UIAlertSA } from \"../../component/\";\nimport { Service } from \"./\";\nimport NewCard from \"./withdrawal/newCard\";\nimport { withAuth } from \"../../util\";\n\nconst CardItem = props => {\n  const {\n    label,\n    time,\n    value,\n    status,\n    index,\n    className,\n    obj,\n    onSetKey,\n    setKey\n  } = props; //成功 SUCCESS\n  //失败 FAILURE\n  //未审核 UNREVIEWED\n  //出款中 WITHDRAWING\n\n  let statusText = \"\";\n  let classStatus = \"\";\n  let cancel = false;\n  let fail = false;\n\n  if (status === \"成功\") {\n    statusText = \"成功\";\n    classStatus = \"success\";\n  }\n\n  if (status === \"失败\") {\n    statusText = \"失败\";\n    classStatus = \"failure\";\n    fail = true;\n  }\n\n  if (status === \"未审核\") {\n    statusText = \"未审核\";\n    classStatus = \"unreviewed\";\n    cancel = true;\n  }\n\n  if (status === \"出款中\") {\n    statusText = \"出款中\";\n    classStatus = \"withdrawing\";\n  }\n\n  if (status === \"汇款中\") {\n    statusText = \"汇款中\";\n    classStatus = \"remittance\";\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: `withdrawal-history-card-item ${className ? className : \"\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cl-item withdrawal-history-card-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"cl-card-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }\n  }, label), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"cl-card-time\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }, time)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cl-item withdrawal-history-card-value\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }\n  }, cancel && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"cancel\",\n    onClick: () => props.onCancel(obj),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 11\n    }\n  }, \"\\u53D6\\u6D88\\u63D0\\u6B3E\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"cl-card-amount\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }\n  }, \"\\u91D1\\u989D: \", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 15\n    }\n  }, value)), /*#__PURE__*/React.createElement(\"p\", {\n    className: `cl-card-status ${classStatus}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 11\n    }\n  }, statusText, fail && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"fail\",\n    onClick: () => onSetKey(index),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 15\n    }\n  }, setKey === index && /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 38\n    }\n  }, obj.verifyComment), /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 17\n    }\n  }))))));\n};\n\nconst Withdraws = ({\n  update,\n  alert\n}) => {\n  const [key, setKey] = useState(null);\n  const [reload, setReload] = useState(null);\n  const [withdraws, setWithdraws] = useState({\n    status: 0,\n    list: []\n  });\n  useEffect(() => {\n    const fetch = async () => {\n      try {\n        const r = await Service.Transaction.read({\n          record_type: \"debit\",\n          ...Service.User.read()\n        }).promise; // console.log(\"R\", r);\n\n        setWithdraws({\n          status: 1,\n          list: r.info.map(t => ({ ...t,\n            ts: toDate(t.requestTime, true)\n          }))\n        });\n        setReload(false);\n      } catch (e) {\n        if (!e.is_aborted) {\n          console.warn(e);\n        }\n\n        setReload(false);\n      }\n    };\n\n    fetch();\n  }, [update, reload]);\n  const [range, setRange] = useState(\"today\");\n  const [customI, setCustomI] = useState(0);\n  const [customRange, setCustomRange] = useState({\n    from: moment().subtract(30, \"days\").toDate(),\n    to: moment().toDate()\n  });\n  const [customRangeOpened, openCustomRange] = useState({\n    from: false,\n    to: false\n  });\n  const [overlayShown, setOverlay] = useState(false);\n\n  const __withdraws = useMemo(() => {\n    const _rangeMap = {\n      today: () => {\n        const today = moment();\n        return [today.startOf(\"day\").unix(), today.endOf(\"day\").unix()];\n      },\n      yesterday: () => {\n        const yesterday = moment().subtract(1, \"days\");\n        return [yesterday.startOf(\"day\").unix(), yesterday.endOf(\"day\").unix()];\n      },\n      week: () => {\n        return [moment().subtract(1, \"weeks\").startOf(\"day\").unix(), moment().endOf(\"day\").unix()];\n      },\n      month: () => {\n        return [moment().subtract(30, \"days\").startOf(\"day\").unix(), moment().endOf(\"day\").unix()];\n      },\n      custom: () => {\n        let {\n          from,\n          to\n        } = customRange;\n        return [moment(from).startOf(\"day\").unix(), moment(to).endOf(\"day\").unix()];\n      }\n    };\n\n    const [from, to] = _rangeMap[range]();\n\n    return withdraws.list.filter(t => t.ts >= from && t.ts < to);\n  }, [withdraws.list, customRange, range]);\n\n  const UI = {\n    async cancel(w) {\n      try {\n        const r = await Service.User.withdrawCancel({\n          id: w.id\n        }).promise;\n        console.info(r);\n        setWithdraws(ws => ({ ...ws,\n          list: ws.list.map(ws => ws.id === w.id ? { ...w,\n            status: \"失败\"\n          } : ws)\n        }));\n        alert.showAlert(\"系统提示\", r.info);\n      } catch (e) {\n        console.warn(e);\n        alert.showAlert(\"系统提示\", e);\n      }\n    },\n\n    toggle(w) {\n      setWithdraws(ws => ({ ...ws,\n        list: ws.list.map(ws => ws.id === w.id ? { ...w,\n          shown: !w.shown\n        } : ws)\n      }));\n    },\n\n    applyCustomRange() {\n      setOverlay(false);\n      setCustomI(customI + 1);\n      setRange(\"custom\");\n    }\n\n  };\n  const monthMap = {\n    \"1\": \"一月\",\n    \"2\": \"二月\",\n    \"3\": \"三月\",\n    \"4\": \"四月\",\n    \"5\": \"五月\",\n    \"6\": \"六月\",\n    \"7\": \"七月\",\n    \"8\": \"八月\",\n    \"9\": \"九月\",\n    \"10\": \"十月\",\n    \"11\": \"十一月\",\n    \"12\": \"十二月\"\n  };\n\n  const DatePickerWrap = ({\n    type,\n    header,\n    min\n  }) => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n    onClick: e => openCustomRange({ ...customRangeOpened,\n      [type]: true\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }\n  }, moment(customRange[type]).format(\"YYYY-MM-DD\")), /*#__PURE__*/React.createElement(DatePicker, {\n    theme: \"ios\",\n    confirmText: \"\\u597D\\u5427\",\n    headerFormat: header,\n    value: customRange[type],\n    isOpen: customRangeOpened[type],\n    min: min,\n    dateConfig: {\n      year: {\n        format: \"YYYY\"\n      },\n      month: {\n        format: v => monthMap[v.getMonth() + 1]\n      },\n      date: {\n        format: \"D\"\n      }\n    },\n    onSelect: date => {\n      openCustomRange({ ...customRangeOpened,\n        [type]: false\n      });\n      setCustomRange({ ...customRange,\n        [type]: date\n      });\n    },\n    onCancel: e => openCustomRange({ ...customRangeOpened,\n      [type]: false\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 7\n    }\n  }));\n\n  const _withdraws = withdraws.list.map((withdraw, i) => {\n    // console.log(withdraw)\n    const onSetKey = value => {\n      setKey(null);\n      if (key !== value) setKey(value);\n    };\n\n    return /*#__PURE__*/React.createElement(CardItem, {\n      key: i,\n      obj: withdraw,\n      index: i,\n      label: withdraw.cardNumber,\n      time: withdraw.requestTime,\n      value: withdraw.amount,\n      status: withdraw.status,\n      onCancel: val => UI.cancel(val),\n      onSetKey: val => onSetKey(val),\n      setKey: key,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 7\n      }\n    });\n  }); // console.log(_withdraws)\n\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdraws transactions-sa\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdrawal-history-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdrawal-history-wrap-inner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdrawal-history-wrap-inner-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdrawal-history-card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdrawal-history-card-head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdrawal-history-card-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 19\n    }\n  }, \"\\u6700\\u8FD130\\u5929\"), /*#__PURE__*/React.createElement(\"i\", {\n    className: reload ? \"reload\" : \"\",\n    onClick: () => setReload(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 19\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdrawal-history-card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 15\n    }\n  }, !isEmpty(_withdraws) ? _withdraws : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"no-transactions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"image-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 21\n    }\n  }, \"\\u6682\\u65E0\\u8BB0\\u5F55\"))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(\"transactions-overlay\", {\n      shown: overlayShown\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"transactions-overlay--inner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"transactions-overlay--wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"custom-range-form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 15\n    }\n  }, \"\\u9009\\u62E9\\u5F00\\u59CB\\u65F6\\u95F4\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"field\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 19\n    }\n  }, \"\\u5F00\\u59CB\\u65E5\\u671F\"), /*#__PURE__*/React.createElement(DatePickerWrap, {\n    type: \"from\",\n    header: \"\\u9009\\u62E9\\u5F00\\u59CB\\u65F6\\u95F4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"field\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 19\n    }\n  }, \"\\u7ED3\\u675F\\u65E5\\u671F\"), /*#__PURE__*/React.createElement(DatePickerWrap, {\n    type: \"to\",\n    min: customRange.from,\n    header: \"\\u9009\\u62E9\\u7ED3\\u675F\\u65F6\\u95F4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 19\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-buttons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 387,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"cancel\",\n    onClick: e => setOverlay(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 17\n    }\n  }, \"\\u53D6\\u6D88\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"update\",\n    onClick: e => UI.applyCustomRange(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 17\n    }\n  }, \"\\u786E\\u8BA4\")))))));\n};\n\nconst Withdraw = () => {\n  const [balanceTransferred, setBalanceTransferred] = useState(false);\n  const [showVenue, setShowVenue] = useState(false);\n  const [showNewCard, setShowNewCard] = useState(false);\n  const [showDelCard, setShowDelCard] = useState(false);\n  const [status, setStatus] = useState(1);\n  const [balancesRaw, setBalancesRaw] = useState([]);\n  const {\n    userAuth\n  } = useContext(Service.User.Context);\n  const [update, setUpdate] = useState(0);\n  const [cards, setCards] = useState([]);\n  const [cardsMap, setCardsMap] = useState({});\n  const [form, setForm] = useState({\n    debit_bank: \"\",\n    amount: \"\"\n  });\n  const [cardPicker, toggleCardPicker] = useState(false);\n  const [alert, setAlert] = useState({\n    shown: false,\n    title: \"\",\n    message: \"\",\n    onClose: () => hideAlert()\n  });\n\n  const showAlert = (title, message) => {\n    setAlert(a => ({ ...a,\n      shown: true,\n      title,\n      message\n    }));\n  };\n\n  const hideAlert = () => {\n    setAlert(a => ({ ...a,\n      shown: false\n    }));\n  };\n\n  useEffect(() => {\n    // const r = Service.User.withdraw({\n    // \trecord_type: 'debit',\n    // \t...Service.User.read(),\n    // });\n    // r.promise.then( result =>{\n    // \tconsole.log('result',result)\n    // } , e =>{\n    // \tconsole.log(e)\n    // })\n    Service.Game.balances({ ...Service.User.read()\n    }).then(balances => {\n      // console.log(balances)\n      setBalancesRaw(balances.filter(b => !b.error));\n    });\n    const req = Service.Card.read({ ...Service.User.read()\n    });\n    setStatus(0);\n    req.promise.then(r => {\n      // console.log(\"Got cards:\", r);\n      const _cardsMap = {};\n\n      const _cards = r.info.map(c => {\n        if (!_cardsMap[c.debit_bank]) {\n          _cardsMap[c.debit_bank] = c.id;\n        }\n\n        return c.debit_bank;\n      });\n\n      setCardsMap(_cardsMap);\n\n      if (!_cards.length) {\n        _cards.push(\"\");\n      }\n\n      setForm(f => ({ ...f,\n        debit_bank: _cards[0] || \"\"\n      }));\n      setCards(_cards);\n      setStatus(1);\n    }, e => {\n      console.warn(\"Unable to get cards:\", e);\n      setStatus(1);\n    });\n    return () => req.cancel();\n  }, []);\n  const fields = [{\n    id: \"debit_bank\",\n    label: \"选择银行卡\",\n    placeholder: \"银行卡号\"\n  }];\n  const fieldss = [{\n    id: \"amount\",\n    label: \"￥\",\n    placeholder: \"金额\"\n  }];\n\n  const withdraw = () => {\n    const {\n      debit_bank,\n      amount\n    } = form;\n\n    if (!debit_bank) {\n      // return void showAlert(\"系统提示\", \"必须选择一张卡\");\n      return void showAlert(\"系统提示\", \"必须选择一张银行卡\");\n    }\n\n    const _amount = +amount;\n\n    if (!_amount || isNaN(_amount)) {\n      return void showAlert(\"系统提示\", \"取款金额不能为空\");\n    } // if (_amount < 100 || _amount > 60000) {\n    //   return void showAlert(\"系统提示\", \"系统提示\");\n    // }\n\n\n    if (_amount < 100) {\n      return void showAlert(\"系统提示\", \"取款金额最低100元\");\n    }\n\n    console.info(`You're about to withdraw ${amount}¥`);\n    setStatus(0);\n    const _form = { ...form\n    };\n    _form.debit_bank = cardsMap[debit_bank] || \"\";\n    Service.User.withdraw({ ...Service.User.read(),\n      ..._form\n    }).promise.then(r => {\n      console.log(`You've successfully withdrawn:`, r);\n      showAlert(\"系统提示\", r.info);\n      setStatus(1);\n      setUpdate(u => u + 1);\n    }, e => {\n      console.warn(\"Unable to withdraw:\", e);\n      showAlert(\"系统提示\", e);\n      setStatus(1);\n    });\n  };\n\n  const wallet = async e => {\n    setStatus(0);\n    Service.Game.transferToWallet().promise.then(r => {\n      // console.log(r)\n      setStatus(1);\n      setBalanceTransferred(true);\n    }, e => {\n      console.warn(e);\n      setStatus(1);\n    });\n  };\n\n  const onMax = () => {\n    setForm({ ...form,\n      amount: Math.floor(userAuth.data.balance)\n    });\n  };\n\n  const onNewAddCard = () => {\n    const req = Service.Card.read({ ...Service.User.read()\n    });\n    setStatus(0);\n    req.promise.then(r => {\n      const _cardsMap = {};\n\n      const _cards = reverse(r.info).map(c => {\n        if (!_cardsMap[c.debit_bank]) {\n          _cardsMap[c.debit_bank] = c.id;\n        }\n\n        return c.debit_bank;\n      });\n\n      setCardsMap(_cardsMap);\n\n      if (!_cards.length) {\n        _cards.push(\"\");\n      }\n\n      setForm(f => ({ ...f,\n        debit_bank: _cards[0] || \"\"\n      }));\n      setCards(_cards);\n      setStatus(1);\n    }, e => {\n      console.warn(\"Unable to get cards:\", e);\n      setStatus(1);\n    });\n    return () => req.cancel();\n  }; // console.log(form)\n\n\n  const onShowVenue = () => {\n    setShowVenue(!showVenue);\n  };\n\n  const onlyNumbers = e => {\n    const {\n      name,\n      value\n    } = e.currentTarget;\n    let regexp = /^[0-9\\b]+$/;\n\n    if (!value || regexp.test(value)) {\n      setForm(f => ({ ...f,\n        [name]: value\n      }));\n    }\n  }; // console.log(update)\n\n\n  return /*#__PURE__*/React.createElement(Wrap, {\n    className: \"profile-withdraw\",\n    name: \"\\u9A6C\\u4E0A\\u63D0\\u6B3E\",\n    isLoading: !status,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 646,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field user-balance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 647,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"user-balance-wrap wallet\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 648,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"user-balance-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 649,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 650,\n      columnNumber: 13\n    }\n  }), \" \\u4E2D\\u5FC3\\u94B1\\u5305\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"user-balance-amount\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 652,\n      columnNumber: 11\n    }\n  }, userAuth.data.balance)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"user-balance-wrap hr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 654,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"user-balance-wrap refresh\",\n    onClick: wallet,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 655,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 656,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"user-balance-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 657,\n      columnNumber: 11\n    }\n  }, \"\\u4E00\\u952E\\u56DE\\u6536\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field-section\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 661,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field balances-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 662,\n      columnNumber: 9\n    }\n  }, balancesRaw.map((balance, i) => /*#__PURE__*/React.createElement(\"div\", {\n    key: i,\n    className: \"balances-list--item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 664,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"game-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 665,\n      columnNumber: 15\n    }\n  }, balance.game.name), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"game-balance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 666,\n      columnNumber: 15\n    }\n  }, BigNumber(balance.balance).toFormat(2))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"balances-list-load-more\",\n    onClick: () => onShowVenue(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 672,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: showVenue ? \"show\" : \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 673,\n      columnNumber: 11\n    }\n  }, \"\\u663E\\u793A\\u6240\\u6709\\u573A\\u9986\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdraw-form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 677,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"fields\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 678,\n      columnNumber: 9\n    }\n  }, fields.map((f, i) => /*#__PURE__*/React.createElement(FormField, {\n    key: i,\n    field: {\n      label: f.label,\n      placeholder: f.placeholder,\n      select: f.id === \"debit_bank\",\n      onClick: () => toggleCardPicker(!cardPicker)\n    },\n    input: { ...f,\n      name: f.id,\n      value: form[f.id],\n      onChange: e => {\n        const {\n          name,\n          value\n        } = e.target;\n        setForm(f => ({ ...f,\n          [name]: value\n        }));\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 680,\n      columnNumber: 13\n    }\n  })), cardPicker && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cardtogglepicker\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 703,\n      columnNumber: 13\n    }\n  }, cards && cards.map((obj, i) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: i,\n      className: `cardtogglepicker-wrap ${form.debit_bank === obj ? \"active\" : \"\"}`,\n      onClick: () => [setForm({ ...form,\n        debit_bank: obj\n      }), toggleCardPicker(false)],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 707,\n        columnNumber: 21\n      }\n    }, obj);\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdraw-two-buttons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 725,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setShowNewCard(true),\n    className: \"w-t-btn new-button-card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 726,\n      columnNumber: 11\n    }\n  }, \"\\u65B0\\u589E\\u94F6\\u884C\\u5361\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setShowDelCard(true),\n    className: \"w-t-btn untie-button-card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 732,\n      columnNumber: 11\n    }\n  }, \"\\u89E3\\u7ED1\\u94F6\\u884C\\u5361\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"fields-fields\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 740,\n      columnNumber: 9\n    }\n  }, fieldss.map((f, i) => /*#__PURE__*/React.createElement(FormField, {\n    key: i,\n    field: {\n      label: f.label,\n      placeholder: f.placeholder,\n      select: f.id === \"debit_bank\",\n      onClick: () => toggleCardPicker(true)\n    },\n    input: { ...f,\n      name: f.id,\n      value: form[f.id],\n      onChange: e => onlyNumbers(e) // onKeyDown: (e) => onlyNumbers(e)  \n\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 742,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => onMax(),\n    className: \"btn-field-max\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 760,\n      columnNumber: 11\n    }\n  }, \"\\u6700\\u5927\\u91D1\\u989D\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 765,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"button-stylized\",\n    onClick: withdraw,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 766,\n      columnNumber: 11\n    }\n  }, \"\\u63D0\\u4EA4\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(\"withdraw-list\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 772,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Withdraws, {\n    update: update,\n    alert: {\n      showAlert,\n      hideAlert\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 773,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(UIAlertSA, Object.assign({}, alert, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 795,\n      columnNumber: 7\n    }\n  })), /*#__PURE__*/React.createElement(NewCard, {\n    show: showNewCard,\n    delCard: showDelCard,\n    onHide: () => [setShowNewCard(false), setShowDelCard(false)],\n    onNewAddCard: () => onNewAddCard(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 796,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(UIAlertSA, {\n    onClose: () => null,\n    shown: balanceTransferred,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 802,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `game-sa-overlay`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 803,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"overlay-layer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 804,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form response\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 805,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 806,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 807,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 808,\n      columnNumber: 17\n    }\n  }, \"\\u8F6C\\u8D26\\u6210\\u529F\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 810,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => setBalanceTransferred(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 811,\n      columnNumber: 17\n    }\n  }, \"\\u786E\\u8BA4\")))))));\n};\n\nexport default withAuth(Withdraw, 1);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/ubet-project (1)/src/pwa/view/profile/Withdraw.jsx"],"names":["React","useState","useEffect","useMemo","useContext","DatePicker","cx","moment","BigNumber","reverse","isEmpty","size","Wrap","toDate","FormField","UIAlertSA","Service","NewCard","withAuth","CardItem","props","label","time","value","status","index","className","obj","onSetKey","setKey","statusText","classStatus","cancel","fail","onCancel","verifyComment","Withdraws","update","alert","key","reload","setReload","withdraws","setWithdraws","list","fetch","r","Transaction","read","record_type","User","promise","info","map","t","ts","requestTime","e","is_aborted","console","warn","range","setRange","customI","setCustomI","customRange","setCustomRange","from","subtract","to","customRangeOpened","openCustomRange","overlayShown","setOverlay","__withdraws","_rangeMap","today","startOf","unix","endOf","yesterday","week","month","custom","filter","UI","w","withdrawCancel","id","ws","showAlert","toggle","shown","applyCustomRange","monthMap","DatePickerWrap","type","header","min","format","year","v","getMonth","date","_withdraws","withdraw","i","cardNumber","amount","val","Withdraw","balanceTransferred","setBalanceTransferred","showVenue","setShowVenue","showNewCard","setShowNewCard","showDelCard","setShowDelCard","setStatus","balancesRaw","setBalancesRaw","userAuth","Context","setUpdate","cards","setCards","cardsMap","setCardsMap","form","setForm","debit_bank","cardPicker","toggleCardPicker","setAlert","title","message","onClose","hideAlert","a","Game","balances","then","b","error","req","Card","_cardsMap","_cards","c","length","push","f","fields","placeholder","fieldss","_amount","isNaN","_form","log","u","wallet","transferToWallet","onMax","Math","floor","data","balance","onNewAddCard","onShowVenue","onlyNumbers","name","currentTarget","regexp","test","game","toFormat","select","onClick","onChange","target"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useMemo, useContext } from \"react\";\r\n// import { Link } from \"react-router-dom\";\r\n// import Picker from \"react-mobile-picker\";\r\nimport DatePicker from \"react-mobile-datepicker\";\r\nimport cx from \"classnames\";\r\nimport * as moment from \"moment\";\r\nimport BigNumber from \"bignumber.js\";\r\nimport { reverse, isEmpty, size } from \"lodash\";\r\n\r\nimport { Wrap } from \"./\";\r\nimport { toDate } from \"../../../util/\";\r\nimport {\r\n  FormField,\r\n  //  UITabs\r\n} from \"../../../component/\";\r\nimport { UIAlertSA } from \"../../component/\";\r\nimport { Service } from \"./\";\r\n\r\nimport NewCard from \"./withdrawal/newCard\";\r\nimport { withAuth } from \"../../util\";\r\n\r\n\r\nconst CardItem = (props) => {\r\n  const {\r\n    label,\r\n    time,\r\n    value,\r\n    status,\r\n    index,\r\n    className,\r\n    obj,\r\n    onSetKey,\r\n    setKey,\r\n  } = props;\r\n  //成功 SUCCESS\r\n  //失败 FAILURE\r\n  //未审核 UNREVIEWED\r\n  //出款中 WITHDRAWING\r\n  let statusText = \"\";\r\n  let classStatus = \"\";\r\n  let cancel = false;\r\n  let fail = false;\r\n  if (status === \"成功\") {\r\n    statusText = \"成功\";\r\n    classStatus = \"success\";\r\n  }\r\n\r\n  if (status === \"失败\") {\r\n    statusText = \"失败\";\r\n    classStatus = \"failure\";\r\n    fail = true;\r\n  }\r\n\r\n  if (status === \"未审核\") {\r\n    statusText = \"未审核\";\r\n    classStatus = \"unreviewed\";\r\n    cancel = true;\r\n  }\r\n\r\n  if (status === \"出款中\") {\r\n    statusText = \"出款中\";\r\n    classStatus = \"withdrawing\";\r\n  }\r\n\r\n  if (status === \"汇款中\") {\r\n    statusText = \"汇款中\";\r\n    classStatus = \"remittance\";\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={`withdrawal-history-card-item ${className ? className : \"\"}`}\r\n    >\r\n      <div className=\"cl-item withdrawal-history-card-text\">\r\n        <p className=\"cl-card-text\">{label}</p>\r\n        <p className=\"cl-card-time\">{time}</p>\r\n      </div>\r\n      <div className=\"cl-item withdrawal-history-card-value\">\r\n        {cancel && (\r\n          <span className=\"cancel\" onClick={() => props.onCancel(obj)}>\r\n            取消提款\r\n          </span>\r\n        )}\r\n        <p className=\"cl-card-amount\">\r\n          金额: <span>{value}</span>\r\n        </p>\r\n        <p className={`cl-card-status ${classStatus}`}>\r\n          <span>\r\n            {statusText}\r\n            {fail && (\r\n              <span className=\"fail\" onClick={() => onSetKey(index)}>\r\n                {setKey === index && <span>{obj.verifyComment}</span>}\r\n                <i />\r\n              </span>\r\n            )}\r\n          </span>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Withdraws = ({ update, alert }) => {\r\n  const [key, setKey] = useState(null);\r\n  const [reload, setReload] = useState(null);\r\n\r\n  const [withdraws, setWithdraws] = useState({\r\n    status: 0,\r\n    list: [],\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetch = async () => {\r\n      try {\r\n        const r = await Service.Transaction.read({\r\n          record_type: \"debit\",\r\n          ...Service.User.read(),\r\n        }).promise;\r\n\r\n        // console.log(\"R\", r);\r\n\r\n        setWithdraws({\r\n          status: 1,\r\n          list: r.info.map((t) => ({ ...t, ts: toDate(t.requestTime, true) })),\r\n        });\r\n        setReload(false);\r\n      } catch (e) {\r\n        if (!e.is_aborted) {\r\n          console.warn(e);\r\n        }\r\n        setReload(false);\r\n      }\r\n    };\r\n\r\n    fetch();\r\n  }, [update, reload]);\r\n\r\n  const [range, setRange] = useState(\"today\");\r\n\r\n  const [customI, setCustomI] = useState(0);\r\n\r\n  const [customRange, setCustomRange] = useState({\r\n    from: moment().subtract(30, \"days\").toDate(),\r\n    to: moment().toDate(),\r\n  });\r\n\r\n  const [customRangeOpened, openCustomRange] = useState({\r\n    from: false,\r\n    to: false,\r\n  });\r\n\r\n  const [overlayShown, setOverlay] = useState(false);\r\n\r\n  const __withdraws = useMemo(() => {\r\n    const _rangeMap = {\r\n      today: () => {\r\n        const today = moment();\r\n        return [today.startOf(\"day\").unix(), today.endOf(\"day\").unix()];\r\n      },\r\n      yesterday: () => {\r\n        const yesterday = moment().subtract(1, \"days\");\r\n        return [yesterday.startOf(\"day\").unix(), yesterday.endOf(\"day\").unix()];\r\n      },\r\n      week: () => {\r\n        return [\r\n          moment().subtract(1, \"weeks\").startOf(\"day\").unix(),\r\n          moment().endOf(\"day\").unix(),\r\n        ];\r\n      },\r\n      month: () => {\r\n        return [\r\n          moment().subtract(30, \"days\").startOf(\"day\").unix(),\r\n          moment().endOf(\"day\").unix(),\r\n        ];\r\n      },\r\n      custom: () => {\r\n        let { from, to } = customRange;\r\n        return [\r\n          moment(from).startOf(\"day\").unix(),\r\n          moment(to).endOf(\"day\").unix(),\r\n        ];\r\n      },\r\n    };\r\n\r\n    const [from, to] = _rangeMap[range]();\r\n\r\n    return withdraws.list.filter((t) => t.ts >= from && t.ts < to);\r\n  }, [withdraws.list, customRange, range]);\r\n\r\n  const UI = {\r\n    async cancel(w) {\r\n      try {\r\n        const r = await Service.User.withdrawCancel({ id: w.id }).promise;\r\n\r\n        console.info(r);\r\n\r\n        setWithdraws((ws) => ({\r\n          ...ws,\r\n          list: ws.list.map((ws) =>\r\n            ws.id === w.id ? { ...w, status: \"失败\" } : ws\r\n          ),\r\n        }));\r\n\r\n        alert.showAlert(\"系统提示\", r.info);\r\n      } catch (e) {\r\n        console.warn(e);\r\n\r\n        alert.showAlert(\"系统提示\", e);\r\n      }\r\n    },\r\n    toggle(w) {\r\n      setWithdraws((ws) => ({\r\n        ...ws,\r\n        list: ws.list.map((ws) =>\r\n          ws.id === w.id ? { ...w, shown: !w.shown } : ws\r\n        ),\r\n      }));\r\n    },\r\n    applyCustomRange() {\r\n      setOverlay(false);\r\n\r\n      setCustomI(customI + 1);\r\n\r\n      setRange(\"custom\");\r\n    },\r\n  };\r\n\r\n  const monthMap = {\r\n    \"1\": \"一月\",\r\n    \"2\": \"二月\",\r\n    \"3\": \"三月\",\r\n    \"4\": \"四月\",\r\n    \"5\": \"五月\",\r\n    \"6\": \"六月\",\r\n    \"7\": \"七月\",\r\n    \"8\": \"八月\",\r\n    \"9\": \"九月\",\r\n    \"10\": \"十月\",\r\n    \"11\": \"十一月\",\r\n    \"12\": \"十二月\",\r\n  };\r\n\r\n  const DatePickerWrap = ({ type, header, min }) => (\r\n    <>\r\n      <p\r\n        onClick={(e) =>\r\n          openCustomRange({\r\n            ...customRangeOpened,\r\n            [type]: true,\r\n          })\r\n        }\r\n      >\r\n        {moment(customRange[type]).format(\"YYYY-MM-DD\")}\r\n      </p>\r\n      <DatePicker\r\n        theme=\"ios\"\r\n        confirmText=\"好吧\"\r\n        headerFormat={header}\r\n        value={customRange[type]}\r\n        isOpen={customRangeOpened[type]}\r\n        min={min}\r\n        dateConfig={{\r\n          year: {\r\n            format: \"YYYY\",\r\n          },\r\n          month: {\r\n            format: (v) => monthMap[v.getMonth() + 1],\r\n          },\r\n          date: {\r\n            format: \"D\",\r\n          },\r\n        }}\r\n        onSelect={(date) => {\r\n          openCustomRange({\r\n            ...customRangeOpened,\r\n            [type]: false,\r\n          });\r\n          setCustomRange({\r\n            ...customRange,\r\n            [type]: date,\r\n          });\r\n        }}\r\n        onCancel={(e) =>\r\n          openCustomRange({\r\n            ...customRangeOpened,\r\n            [type]: false,\r\n          })\r\n        }\r\n      />\r\n    </>\r\n  );\r\n\r\n  const _withdraws = withdraws.list.map((withdraw, i) => {\r\n    // console.log(withdraw)\r\n\r\n    const onSetKey = (value) => {\r\n      setKey(null);\r\n      if (key !== value) setKey(value);\r\n    };\r\n\r\n    return (\r\n      <CardItem\r\n        key={i}\r\n        obj={withdraw}\r\n        index={i}\r\n        label={withdraw.cardNumber}\r\n        time={withdraw.requestTime}\r\n        value={withdraw.amount}\r\n        status={withdraw.status}\r\n        onCancel={(val) => UI.cancel(val)}\r\n        onSetKey={(val) => onSetKey(val)}\r\n        setKey={key}\r\n      />\r\n    );\r\n  });\r\n\r\n  // console.log(_withdraws)\r\n\r\n  return (\r\n    <div className=\"withdraws transactions-sa\">\r\n      {/* <h1>提款记录</h1>\r\n\t\t\t<div className=\"transactions-range\">\r\n\t\t\t\t<UITabs\r\n\t\t\t\t\ttab={range}\r\n\t\t\t\t\tonSet={r => r !== 'custom' ? setRange(r) : setOverlay(true)}\r\n\t\t\t\t\ttabs={[\r\n\t\t\t\t\t\t{ index: 'today', name: '今天' },\r\n\t\t\t\t\t\t{ index: 'yesterday', name: '昨天' },\r\n\t\t\t\t\t\t{ index: 'week', name: '本周' },\r\n\t\t\t\t\t\t{ index: 'month', name: '本月' },\r\n\t\t\t\t\t\t{ index: 'custom', name: '自选' },\r\n\t\t\t\t\t]} />\r\n\t\t\t</div> */}\r\n      {/* <div className=\"transactions-list\">\r\n\t\t\t\t{_withdraws}\r\n\t\t\t</div> */}\r\n      {/* ============================================================= */}\r\n      <div className=\"withdrawal-history-wrap\">\r\n        <div className=\"withdrawal-history-wrap-inner\">\r\n          <div className=\"withdrawal-history-wrap-inner-content\">\r\n            <div className=\"withdrawal-history-card\">\r\n              <div className=\"withdrawal-history-card-head\">\r\n                <div className=\"withdrawal-history-card-title\">\r\n                  <span>最近30天</span>\r\n                  <i\r\n                    className={reload ? \"reload\" : \"\"}\r\n                    onClick={() => setReload(true)}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"withdrawal-history-card-body\">\r\n                {!isEmpty(_withdraws) ? (\r\n                  _withdraws\r\n                ) : (\r\n                  <div className=\"no-transactions\">\r\n                    <div className=\"image-box\" />\r\n                    <span>暂无记录</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {/* ============================================================= */}\r\n\r\n      <div className={cx(\"transactions-overlay\", { shown: overlayShown })}>\r\n        <div className=\"transactions-overlay--inner\">\r\n          <div className=\"transactions-overlay--wrap\">\r\n            <div className=\"custom-range-form\">\r\n              <h2>选择开始时间</h2>\r\n              <div className=\"form-wrap\">\r\n                <div className=\"field\">\r\n                  <label>开始日期</label>\r\n                  <DatePickerWrap type=\"from\" header=\"选择开始时间\" />\r\n                </div>\r\n                <div className=\"field\">\r\n                  <label>结束日期</label>\r\n                  <DatePickerWrap\r\n                    type=\"to\"\r\n                    min={customRange.from}\r\n                    header=\"选择结束时间\"\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"form-buttons\">\r\n                <button className=\"cancel\" onClick={(e) => setOverlay(false)}>\r\n                  取消\r\n                </button>\r\n                <button\r\n                  className=\"update\"\r\n                  onClick={(e) => UI.applyCustomRange()}\r\n                >\r\n                  确认\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Withdraw = () => {\r\n  const [balanceTransferred, setBalanceTransferred] = useState(false);\r\n  const [showVenue, setShowVenue] = useState(false);\r\n  const [showNewCard, setShowNewCard] = useState(false);\r\n  const [showDelCard, setShowDelCard] = useState(false);\r\n\r\n  const [status, setStatus] = useState(1);\r\n\r\n  const [balancesRaw, setBalancesRaw] = useState([]);\r\n\r\n  const { userAuth } = useContext(Service.User.Context);\r\n\r\n  const [update, setUpdate] = useState(0);\r\n\r\n  const [cards, setCards] = useState([]);\r\n  const [cardsMap, setCardsMap] = useState({});\r\n\r\n  const [form, setForm] = useState({\r\n    debit_bank: \"\",\r\n    amount: \"\",\r\n  });\r\n\r\n  const [cardPicker, toggleCardPicker] = useState(false);\r\n\r\n  const [alert, setAlert] = useState({\r\n    shown: false,\r\n    title: \"\",\r\n    message: \"\",\r\n    onClose: () => hideAlert(),\r\n  });\r\n\r\n  const showAlert = (title, message) => {\r\n    setAlert((a) => ({ ...a, shown: true, title, message }));\r\n  };\r\n\r\n  const hideAlert = () => {\r\n    setAlert((a) => ({ ...a, shown: false }));\r\n  };\r\n\r\n  useEffect(() => {\r\n    // const r = Service.User.withdraw({\r\n    // \trecord_type: 'debit',\r\n    // \t...Service.User.read(),\r\n    // });\r\n\r\n    // r.promise.then( result =>{\r\n    // \tconsole.log('result',result)\r\n    // } , e =>{\r\n    // \tconsole.log(e)\r\n    // })\r\n\r\n    Service.Game.balances({\r\n      ...Service.User.read(),\r\n    }).then((balances) => {\r\n      // console.log(balances)\r\n      setBalancesRaw(balances.filter((b) => !b.error));\r\n    });\r\n\r\n    const req = Service.Card.read({\r\n      ...Service.User.read(),\r\n    });\r\n\r\n    setStatus(0);\r\n\r\n    req.promise.then(\r\n      (r) => {\r\n        // console.log(\"Got cards:\", r);\r\n\r\n        const _cardsMap = {};\r\n\r\n        const _cards = r.info.map((c) => {\r\n          if (!_cardsMap[c.debit_bank]) {\r\n            _cardsMap[c.debit_bank] = c.id;\r\n          }\r\n\r\n          return c.debit_bank;\r\n        });\r\n\r\n        setCardsMap(_cardsMap);\r\n\r\n        if (!_cards.length) {\r\n          _cards.push(\"\");\r\n        }\r\n\r\n        setForm((f) => ({\r\n          ...f,\r\n          debit_bank: _cards[0] || \"\",\r\n        }));\r\n\r\n        setCards(_cards);\r\n\r\n        setStatus(1);\r\n      },\r\n      (e) => {\r\n        console.warn(\"Unable to get cards:\", e);\r\n\r\n        setStatus(1);\r\n      }\r\n    );\r\n\r\n    return () => req.cancel();\r\n  }, []);\r\n\r\n  const fields = [\r\n    { id: \"debit_bank\", label: \"选择银行卡\", placeholder: \"银行卡号\" },\r\n  ];\r\n  const fieldss = [{ id: \"amount\", label: \"￥\", placeholder: \"金额\" }];\r\n\r\n  const withdraw = () => {\r\n    const { debit_bank, amount } = form;\r\n\r\n    if (!debit_bank) {\r\n      // return void showAlert(\"系统提示\", \"必须选择一张卡\");\r\n      return void showAlert(\"系统提示\", \"必须选择一张银行卡\");\r\n    }\r\n\r\n    const _amount = +amount;\r\n\r\n    if (!_amount || isNaN(_amount)) {\r\n      return void showAlert(\"系统提示\", \"取款金额不能为空\");\r\n    }\r\n\r\n    // if (_amount < 100 || _amount > 60000) {\r\n    //   return void showAlert(\"系统提示\", \"系统提示\");\r\n    // }\r\n\r\n    if (_amount < 100) {\r\n      return void showAlert(\"系统提示\", \"取款金额最低100元\");\r\n    }\r\n\r\n    console.info(`You're about to withdraw ${amount}¥`);\r\n\r\n    setStatus(0);\r\n\r\n    const _form = { ...form };\r\n    _form.debit_bank = cardsMap[debit_bank] || \"\";\r\n\r\n    Service.User.withdraw({\r\n      ...Service.User.read(),\r\n      ..._form,\r\n    }).promise.then(\r\n      (r) => {\r\n        console.log(`You've successfully withdrawn:`, r);\r\n\r\n        showAlert(\"系统提示\", r.info);\r\n\r\n        setStatus(1);\r\n\r\n        setUpdate((u) => u + 1);\r\n      },\r\n      (e) => {\r\n        console.warn(\"Unable to withdraw:\", e);\r\n\r\n        showAlert(\"系统提示\", e);\r\n\r\n        setStatus(1);\r\n      }\r\n    );\r\n  };\r\n\r\n  const wallet = async (e) => {\r\n    setStatus(0);\r\n\r\n    Service.Game.transferToWallet().promise.then(\r\n      (r) => {\r\n        // console.log(r)\r\n        setStatus(1);\r\n        setBalanceTransferred(true);\r\n      },\r\n      (e) => {\r\n        console.warn(e);\r\n        setStatus(1);\r\n      }\r\n    );\r\n  };\r\n\r\n  const onMax = () => {\r\n    setForm({\r\n      ...form,\r\n      amount: Math.floor( userAuth.data.balance ),\r\n    });\r\n  };\r\n\r\n  const onNewAddCard = () => {\r\n    const req = Service.Card.read({\r\n      ...Service.User.read(),\r\n    });\r\n    setStatus(0);\r\n    req.promise.then(\r\n      (r) => {\r\n        const _cardsMap = {};\r\n        const _cards = reverse(r.info).map((c) => {\r\n          if (!_cardsMap[c.debit_bank]) {\r\n            _cardsMap[c.debit_bank] = c.id;\r\n          }\r\n          return c.debit_bank;\r\n        });\r\n        setCardsMap(_cardsMap);\r\n        if (!_cards.length) {\r\n          _cards.push(\"\");\r\n        }\r\n        setForm((f) => ({\r\n          ...f,\r\n          debit_bank: _cards[0] || \"\",\r\n        }));\r\n\r\n        setCards(_cards);\r\n\r\n        setStatus(1);\r\n      },\r\n      (e) => {\r\n        console.warn(\"Unable to get cards:\", e);\r\n        setStatus(1);\r\n      }\r\n    );\r\n    return () => req.cancel();\r\n  };\r\n\r\n  // console.log(form)\r\n\r\n  const onShowVenue = () => {\r\n    setShowVenue(!showVenue);\r\n  };\r\n\r\n  const onlyNumbers = (e) => {\r\n    const { name , value } = e.currentTarget\r\n    let regexp  = /^[0-9\\b]+$/\r\n    if (!value || regexp.test(value)) {\r\n      setForm((f) => ({\r\n        ...f,\r\n        [name]: value,\r\n      }));\r\n    }\r\n\r\n  };\r\n\r\n\r\n  // console.log(update)\r\n\r\n  return (\r\n    <Wrap className=\"profile-withdraw\" name=\"马上提款\" isLoading={!status}>\r\n      <div className=\"form-field user-balance\">\r\n        <div className=\"user-balance-wrap wallet\">\r\n          <span className=\"user-balance-label\">\r\n            <i /> 中心钱包\r\n          </span>\r\n          <span className=\"user-balance-amount\">{userAuth.data.balance}</span>\r\n        </div>\r\n        <div className=\"user-balance-wrap hr\" />\r\n        <div className=\"user-balance-wrap refresh\" onClick={wallet}>\r\n          <i />\r\n          <span className=\"user-balance-label\">一键回收</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"form-field-section\">\r\n        <div className=\"form-field balances-list\">\r\n          {balancesRaw.map((balance, i) => (\r\n            <div key={i} className=\"balances-list--item\">\r\n              <div className=\"game-name\">{balance.game.name}</div>\r\n              <div className=\"game-balance\">\r\n                {BigNumber(balance.balance).toFormat(2)}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <div className=\"balances-list-load-more\" onClick={() => onShowVenue()}>\r\n          <span className={showVenue ? \"show\" : \"\"}>显示所有场馆</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"withdraw-form\">\r\n        <div className=\"fields\">\r\n          {fields.map((f, i) => (\r\n            <FormField\r\n              key={i}\r\n              field={{\r\n                label: f.label,\r\n                placeholder: f.placeholder,\r\n                select: f.id === \"debit_bank\",\r\n                onClick: () => toggleCardPicker(!cardPicker),\r\n              }}\r\n              input={{\r\n                ...f,\r\n                name: f.id,\r\n                value: form[f.id],\r\n                onChange: (e) => {\r\n                  const { name, value } = e.target;\r\n                  setForm((f) => ({\r\n                    ...f,\r\n                    [name]: value,\r\n                  }));\r\n                },\r\n              }}\r\n            />\r\n          ))}\r\n          {cardPicker && (\r\n            <div className=\"cardtogglepicker\">\r\n              {cards &&\r\n                cards.map((obj, i) => {\r\n                  return (\r\n                    <div\r\n                      key={i}\r\n                      className={`cardtogglepicker-wrap ${\r\n                        form.debit_bank === obj ? \"active\" : \"\"\r\n                      }`}\r\n                      onClick={() => [\r\n                        setForm({ ...form, debit_bank: obj }),\r\n                        toggleCardPicker(false),\r\n                      ]}\r\n                    >\r\n                      {obj}\r\n                    </div>\r\n                  );\r\n                })}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"withdraw-two-buttons\">\r\n          <button\r\n            onClick={() => setShowNewCard(true)}\r\n            className=\"w-t-btn new-button-card\"\r\n          >\r\n            新增银行卡\r\n          </button>\r\n          <button\r\n            onClick={() => setShowDelCard(true)}\r\n            className=\"w-t-btn untie-button-card\"\r\n          >\r\n            解绑银行卡\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"fields-fields\">\r\n          {fieldss.map((f, i) => (\r\n            <FormField\r\n              key={i}\r\n              field={{\r\n                label: f.label,\r\n                placeholder: f.placeholder,\r\n                select: f.id === \"debit_bank\",\r\n                onClick: () => toggleCardPicker(true),\r\n              }}\r\n              input={{\r\n                ...f,\r\n                name: f.id,\r\n                value: form[f.id],\r\n                onChange: (e) => onlyNumbers(e)\r\n                // onKeyDown: (e) => onlyNumbers(e)  \r\n\r\n              }}\r\n            />\r\n          ))}\r\n          <button onClick={() => onMax()} className=\"btn-field-max\">\r\n            最大金额\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"submit\">\r\n          <button className=\"button-stylized\" onClick={withdraw}>\r\n            提交\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className={cx(\"withdraw-list\")}>\r\n        <Withdraws update={update} alert={{ showAlert, hideAlert }} />\r\n      </div>\r\n\r\n      {/* <div className={cx('card-select-overlay', { shown: cardPicker })}>\r\n\t\t\t\t<div className=\"picker-wrap\">\r\n\t\t\t\t\t<div className=\"picker-head\">\r\n\t\t\t\t\t\t<button onClick={() => toggleCardPicker(false)}>取消</button>\r\n\t\t\t\t\t\t<p>选择卡</p>\r\n\t\t\t\t\t\t<button onClick={() => toggleCardPicker(false)}>确定</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"picker-body\">\r\n\t\t\t\t\t\t{cardPicker ? (\r\n\t\t\t\t\t\t<Picker\r\n\t\t\t\t\t\t\theight={120}\r\n\t\t\t\t\t\t\tvalueGroups={{ debit_bank: form.debit_bank }}\r\n\t\t\t\t\t\t\toptionGroups={{ debit_bank: cards }}\r\n\t\t\t\t\t\t\tonChange={(k, v) => setForm({ ...form, [k]: v, })}/>\r\n\t\t\t\t\t\t) : null}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div> */}\r\n\r\n      <UIAlertSA {...alert} />\r\n      <NewCard\r\n        show={showNewCard}\r\n        delCard={showDelCard}\r\n        onHide={() => [setShowNewCard(false), setShowDelCard(false)]}\r\n        onNewAddCard={() => onNewAddCard()}\r\n      />\r\n      <UIAlertSA onClose={() => null} shown={balanceTransferred}>\r\n        <div className={`game-sa-overlay`}>\r\n          <div className=\"overlay-layer\">\r\n            <div className=\"form response\">\r\n              <div className=\"form-head\">\r\n                <i />\r\n                <h2>转账成功</h2>\r\n              </div>\r\n              <div className=\"form-body\">\r\n                <button onClick={() => setBalanceTransferred(false)}>\r\n                  确认\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </UIAlertSA>\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default withAuth(Withdraw, 1);\r\n"]},"metadata":{},"sourceType":"module"}