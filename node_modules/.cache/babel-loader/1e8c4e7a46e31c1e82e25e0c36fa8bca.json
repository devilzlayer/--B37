{"ast":null,"code":"import _defineProperty from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useMemo,useContext,useCallback}from\"react\";import Picker from\"react-mobile-picker\";import{mobileModel}from\"react-device-detect\";import{useHistory}from\"react-router-dom\";import{Wrap,Service}from\"../\";import{getDates}from\"../../../../util\";var Birthdate=function Birthdate(){var history=useHistory();var _useContext=useContext(Service.User.Context),data=_useContext.userAuth.data,setUserAuthFN=_useContext.setUserAuthFN;var _useState=useState({year:1989,month:8,day:12}),_useState2=_slicedToArray(_useState,2),birthday=_useState2[0],setBirthday=_useState2[1];var form={realname:data.realName,phone:data.telephone,email:data.email,qq:data.qq,wechat:data.wechat||\"\",device:mobileModel,//\"Huawei Mate 20 Pro\",\nupdates:[{text:\"4.14.116\"},{text:\"Thu Apr 30 18:27:58 CSTt 2020\"}]};var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),active=_useState4[0],setActive=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),disabled=_useState6[0],setDisabled=_useState6[1];useEffect(function(){if(birthday!==\"\")setActive(true);else setActive(false);},[birthday]);var _dates=useMemo(function(){return getDates({date:birthday,year:[18,150]});},[birthday]);var _dateFormat=useCallback(function(date){return date.year?\"\".concat(date.year,\"\\u5E74\").concat(date.month,\"\\u6708\").concat(date.day,\"\\u65E5\"):\"请选择一个日期\";},[]);var update=function update(){console.info(\"You're updating account's birthdate:\",birthday);Service.User.update(_objectSpread(_objectSpread(_objectSpread({},form),Service.User.read()),{},{birthday:_dateFormat(birthday)})).promise.then(function(r){console.info(\"✅ You have successfully updated account's birthdate:\",r.info);setActive(false);setDisabled(true);Service.User.session(_objectSpread({},Service.User.read())).promise.then(function(r){return setUserAuthFN(1,r.info);});},function(e){console.warn(\"Unable to update account's birthdate:\",e);});};return/*#__PURE__*/React.createElement(Wrap,{className:\"profile-birthdate\",name:\"\\u7528\\u4E8E\\u53D1\\u653E\\u751F\\u65E5\\u793C\\u91D1\",sublevel:[true,function(){return history.goBack();}]},disabled&&/*#__PURE__*/React.createElement(\"span\",{className:\"profile-valid\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"date-select-overlay\"},/*#__PURE__*/React.createElement(\"div\",{className:\"picker-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"picker-selected\"},/*#__PURE__*/React.createElement(\"span\",{className:\"date-year\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"date-month\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"date-day\"})),/*#__PURE__*/React.createElement(Picker,{height:260,valueGroups:birthday,optionGroups:_objectSpread({},_dates),onChange:function onChange(k,v){return setBirthday(_objectSpread(_objectSpread({},birthday),{},_defineProperty({},k,v)));}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"submit\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-button \".concat(active&&!disabled&&\"form-button-active\"),onClick:active&&!disabled?update:null},/*#__PURE__*/React.createElement(\"span\",null,\"\\u63D0\\u4EA4\"))));};export default Birthdate;","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/ubet-project (1)/src/pwa/view/profile/personal/Birthdate.js"],"names":["React","useState","useEffect","useMemo","useContext","useCallback","Picker","mobileModel","useHistory","Wrap","Service","getDates","Birthdate","history","User","Context","data","userAuth","setUserAuthFN","year","month","day","birthday","setBirthday","form","realname","realName","phone","telephone","email","qq","wechat","device","updates","text","active","setActive","disabled","setDisabled","_dates","date","_dateFormat","update","console","info","read","promise","then","r","session","e","warn","goBack","k","v"],"mappings":"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","sourcesContent":["import React, {\r\n  useState,\r\n  useEffect,\r\n  useMemo,\r\n  useContext,\r\n  useCallback,\r\n} from \"react\";\r\nimport Picker from \"react-mobile-picker\";\r\nimport { mobileModel } from \"react-device-detect\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nimport { Wrap, Service } from \"../\";\r\nimport { getDates } from \"../../../../util\";\r\n\r\nconst Birthdate = () => {\r\n  const history = useHistory();\r\n\r\n  const {\r\n    userAuth: { data },\r\n    setUserAuthFN,\r\n  } = useContext(Service.User.Context);\r\n\r\n  const [birthday, setBirthday] = useState({\r\n    year: 1989,\r\n    month: 8,\r\n    day: 12,\r\n  });\r\n  const form = {\r\n    realname: data.realName,\r\n    phone: data.telephone,\r\n    email: data.email,\r\n    qq: data.qq,\r\n    wechat: data.wechat || \"\",\r\n    device: mobileModel, //\"Huawei Mate 20 Pro\",\r\n    updates: [{ text: \"4.14.116\" }, { text: \"Thu Apr 30 18:27:58 CSTt 2020\" }],\r\n  };\r\n\r\n  const [active, setActive] = useState(false);\r\n  const [disabled, setDisabled] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (birthday !== \"\") setActive(true);\r\n    else setActive(false);\r\n  }, [birthday]);\r\n\r\n  const _dates = useMemo(() => getDates({ date: birthday, year: [18, 150] }), [\r\n    birthday,\r\n  ]);\r\n\r\n  const _dateFormat = useCallback(\r\n    (date) =>\r\n      date.year\r\n        ? `${date.year}年${date.month}月${date.day}日`\r\n        : \"请选择一个日期\",\r\n    []\r\n  );\r\n\r\n  const update = () => {\r\n    console.info(\"You're updating account's birthdate:\", birthday);\r\n\r\n    Service.User.update({\r\n      ...form,\r\n      ...Service.User.read(),\r\n      birthday: _dateFormat(birthday),\r\n    }).promise.then(\r\n      (r) => {\r\n        console.info(\r\n          \"✅ You have successfully updated account's birthdate:\",\r\n          r.info\r\n        );\r\n        setActive(false);\r\n        setDisabled(true);\r\n\r\n        Service.User.session({\r\n          ...Service.User.read(),\r\n        }).promise.then((r) => setUserAuthFN(1, r.info));\r\n      },\r\n      (e) => {\r\n        console.warn(\"Unable to update account's birthdate:\", e);\r\n      }\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Wrap\r\n      className=\"profile-birthdate\"\r\n      name=\"用于发放生日礼金\"\r\n      sublevel={[true, () => history.goBack()]}\r\n    >\r\n      {disabled && <span className=\"profile-valid\" />}\r\n      <div className={`date-select-overlay`}>\r\n        <div className=\"picker-body\">\r\n          <div className=\"picker-selected\">\r\n            <span className={`date-year`} />\r\n            <span className={`date-month`} />\r\n            <span className={`date-day`} />\r\n          </div>\r\n          <Picker\r\n            height={260}\r\n            valueGroups={birthday}\r\n            optionGroups={{ ..._dates }}\r\n            onChange={(k, v) => setBirthday({ ...birthday, [k]: v })}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div className=\"submit\">\r\n        <div\r\n          className={`form-button ${\r\n            active && !disabled && \"form-button-active\"\r\n          }`}\r\n          onClick={active && !disabled ? update : null}\r\n        >\r\n          <span>提交</span>\r\n        </div>\r\n      </div>\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default Birthdate;\r\n"]},"metadata":{},"sourceType":"module"}