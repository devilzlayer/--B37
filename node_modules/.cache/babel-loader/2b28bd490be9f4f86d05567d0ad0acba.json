{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Documents/New PWA/GIT/src/pwa/view/Restore.js\";\nimport React, { useState, useRef, useEffect, useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { User } from \"../../service\";\nimport { FormField } from \"../../component\";\nimport { LiveChatSA } from \"../component\";\nimport \"../assets/scss/RestoreSA.scss\";\n\nconst Restore = () => {\n  const history = useHistory();\n  const {\n    userAuth: {\n      data\n    },\n    setUserAuthFN\n  } = useContext(User.Context);\n  const [status, setStatus] = useState(1);\n  const [form, setForm] = useState({\n    username: \"\",\n    phone: \"\",\n    code: \"\"\n  });\n  const refUsername = useRef(null);\n  const refcellphone = useRef(null);\n  const refcode = useRef(null);\n  const [message, setMessage] = useState({\n    className: null,\n    source: null,\n    message: null\n  });\n\n  const notify = (state, source, message) => {\n    setMessage({\n      className: state ? \"valid\" : \"invalid\",\n      source,\n      message\n    });\n  };\n\n  const [active, setActive] = useState(false);\n  const [disabled, setDisabled] = useState(false);\n  const [buttonActive, setButtonActive] = useState(false);\n  const [livechat, setLiveChat] = useState(false);\n  useEffect(() => {\n    function numbersOnly(value) {\n      const re = /^[0-9]*$/;\n      return re.test(value);\n    }\n\n    if (form.username !== \"\" && form.phone !== \"\" && form.phone.length === 11) {\n      setButtonActive(true);\n    }\n\n    if (form.username !== \"\" && form.phone !== \"\" && form.phone.length === 11 && numbersOnly(form.phone) && form.code !== \"\") setActive(true);else setActive(false);\n  }, [form]);\n\n  const onChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n\n    if (message.message && message.source === name) {\n      setMessage({\n        className: null,\n        source: null,\n        message: null\n      });\n    }\n\n    setForm(f => ({ ...f,\n      [name]: value\n    }));\n  };\n\n  const update = () => {\n    setStatus(0);\n    User.retrievePassword({ ...User.read(),\n      phone: form.phone,\n      account: form.username,\n      verification_code: form.code\n    }).promise.then(r => {\n      console.info(r);\n      setLiveChat(true); // User.session({\n      //   ...User.read(),\n      // }).promise.then((r) => setUserAuthFN(1, r.info));\n    }, e => {\n      console.warn(e);\n    });\n  };\n\n  function verification() {\n    setButtonActive(false);\n    setTimeout(() => {\n      setButtonActive(true);\n    }, 60000);\n\n    if (form.phone !== \"\") {\n      const req = User.mobileVerification({\n        type: \"verification_code\",\n        phone: form.phone,\n        ...User.read()\n      });\n      req.promise.then(r => {\n        console.log(\"Verification sent!\", r);\n      }, e => {\n        console.warn(\"Verification nto generated\", e);\n      });\n    } else {// console.log('Empty')\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: `wrap-sa `,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"wrap-sa-head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => history.goBack(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"next-arrow\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"center-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  }, \"\\u5BC6\\u7801\\u627E\\u56DE\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"wrap-sa-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-inner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 11\n    }\n  }, \"\\u624B\\u673A\\u65B9\\u5F0F\\u627E\\u56DE\"), /*#__PURE__*/React.createElement(FormField, {\n    field: {\n      label: \"用户名\"\n    },\n    input: {\n      id: \"username\",\n      name: \"username\",\n      type: \"text\",\n      placeholder: \"请输入用户名\",\n      ref: refUsername,\n      maxLength: 12,\n      onChange\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(FormField, {\n    field: {\n      label: \"手机号码\"\n    },\n    input: {\n      id: \"phone\",\n      name: \"phone\",\n      type: \"text\",\n      placeholder: \"请输入手机号码\",\n      ref: refcellphone,\n      maxLength: 11,\n      onChange,\n      onInput: () => refcellphone.current.value = refcellphone.current.value.replace(/[^0-9]/g, \"\")\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field verification\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    id: \"code\",\n    name: \"code\",\n    type: \"text\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u624B\\u673A\\u9A8C\\u8BC1\\u7801\",\n    ref: refcode,\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: `code ${buttonActive && \"active\"}`,\n    onClick: buttonActive ? () => verification() : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 13\n    }\n  }, \"\\u53D1\\u9001\\u9A8C\\u8BC1\\u7801\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `form-button ${active && !disabled && \"form-button-active\"}`,\n    onClick: active && !disabled ? update : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 15\n    }\n  }, \"\\u4E0B\\u4E00\\u6B65\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"support\",\n    onClick: () => setLiveChat(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 11\n    }\n  }, \"\\u8054\\u7CFB\\u5BA2\\u670D\"))), /*#__PURE__*/React.createElement(LiveChatSA, {\n    shown: livechat,\n    onClose: () => setLiveChat(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default Restore;","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/pwa/view/Restore.js"],"names":["React","useState","useRef","useEffect","useContext","useHistory","User","FormField","LiveChatSA","Restore","history","userAuth","data","setUserAuthFN","Context","status","setStatus","form","setForm","username","phone","code","refUsername","refcellphone","refcode","message","setMessage","className","source","notify","state","active","setActive","disabled","setDisabled","buttonActive","setButtonActive","livechat","setLiveChat","numbersOnly","value","re","test","length","onChange","e","name","target","f","update","retrievePassword","read","account","verification_code","promise","then","r","console","info","warn","verification","setTimeout","req","mobileVerification","type","log","goBack","label","id","placeholder","ref","maxLength","onInput","current","replace"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect, useContext } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nimport { User } from \"../../service\";\r\nimport { FormField } from \"../../component\";\r\nimport { LiveChatSA } from \"../component\";\r\n\r\nimport \"../assets/scss/RestoreSA.scss\";\r\n\r\nconst Restore = () => {\r\n  const history = useHistory();\r\n\r\n  const {\r\n    userAuth: { data },\r\n    setUserAuthFN,\r\n  } = useContext(User.Context);\r\n\r\n  const [status, setStatus] = useState(1);\r\n\r\n  const [form, setForm] = useState({\r\n    username: \"\",\r\n    phone: \"\",\r\n    code: \"\",\r\n  });\r\n\r\n  const refUsername = useRef(null);\r\n  const refcellphone = useRef(null);\r\n  const refcode = useRef(null);\r\n\r\n  const [message, setMessage] = useState({\r\n    className: null,\r\n    source: null,\r\n    message: null,\r\n  });\r\n\r\n  const notify = (state, source, message) => {\r\n    setMessage({\r\n      className: state ? \"valid\" : \"invalid\",\r\n      source,\r\n      message,\r\n    });\r\n  };\r\n\r\n  const [active, setActive] = useState(false);\r\n  const [disabled, setDisabled] = useState(false);\r\n  const [buttonActive, setButtonActive] = useState(false);\r\n  const [livechat, setLiveChat] = useState(false);\r\n\r\n  useEffect(() => {\r\n    function numbersOnly(value) {\r\n      const re = /^[0-9]*$/;\r\n      return re.test(value);\r\n    }\r\n\r\n    if (form.username !== \"\" && form.phone !== \"\" && form.phone.length === 11) {\r\n      setButtonActive(true);\r\n    }\r\n\r\n    if (\r\n      form.username !== \"\" &&\r\n      form.phone !== \"\" &&\r\n      form.phone.length === 11 &&\r\n      numbersOnly(form.phone) &&\r\n      form.code !== \"\"\r\n    )\r\n      setActive(true);\r\n    else setActive(false);\r\n  }, [form]);\r\n\r\n  const onChange = (e) => {\r\n    const { name, value } = e.target;\r\n\r\n    if (message.message && message.source === name) {\r\n      setMessage({\r\n        className: null,\r\n        source: null,\r\n        message: null,\r\n      });\r\n    }\r\n\r\n    setForm((f) => ({\r\n      ...f,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n    const update = () => {\r\n      setStatus(0);\r\n\r\n      User.retrievePassword({\r\n        ...User.read(),\r\n        phone: form.phone,\r\n        account: form.username,\r\n        verification_code: form.code,\r\n      }).promise.then(\r\n        (r) => {\r\n          console.info(r);\r\n          setLiveChat(true)\r\n\r\n          // User.session({\r\n          //   ...User.read(),\r\n          // }).promise.then((r) => setUserAuthFN(1, r.info));\r\n\r\n        },\r\n        (e) => {\r\n          console.warn(e);\r\n        }\r\n      );\r\n    };\r\n\r\n    function verification() {\r\n      setButtonActive(false);\r\n\r\n      setTimeout(() => {\r\n        setButtonActive(true);\r\n      }, 60000);\r\n\r\n      if (form.phone !== \"\") {\r\n        const req = User.mobileVerification({\r\n          type: \"verification_code\",\r\n          phone: form.phone,\r\n          ...User.read(),\r\n        });\r\n\r\n        req.promise.then( (r) => {\r\n            console.log(\"Verification sent!\" ,r);\r\n          },\r\n          (e) => {\r\n            console.warn(\"Verification nto generated\", e);\r\n          }\r\n        );\r\n      }else{\r\n        // console.log('Empty')\r\n      }\r\n    }\r\n\r\n  return (\r\n    <div className={`wrap-sa `}>\r\n      <div className=\"wrap-sa-head\">\r\n        <button onClick={() => history.goBack()}>\r\n          <div className=\"next-arrow\" />\r\n        </button>\r\n        <div className=\"center-name\">密码找回</div>\r\n      </div>\r\n      <div className=\"wrap-sa-content\">\r\n        <div className=\"content-inner\">\r\n          <div className=\"title\">手机方式找回</div>\r\n          <FormField\r\n            field={{ label: \"用户名\" }}\r\n            input={{\r\n              id: \"username\",\r\n              name: \"username\",\r\n              type: \"text\",\r\n              placeholder: \"请输入用户名\",\r\n              ref: refUsername,\r\n              maxLength: 12,\r\n              onChange,\r\n            }}\r\n          />\r\n          <FormField\r\n            field={{ label: \"手机号码\" }}\r\n            input={{\r\n              id: \"phone\",\r\n              name: \"phone\",\r\n              type: \"text\",\r\n              placeholder: \"请输入手机号码\",\r\n              ref: refcellphone,\r\n              maxLength: 11,\r\n              onChange,\r\n              onInput: () =>\r\n                (refcellphone.current.value = refcellphone.current.value.replace(\r\n                  /[^0-9]/g,\r\n                  \"\"\r\n                )),\r\n            }}\r\n          />\r\n          <div className={\"form-field verification\"}>\r\n            <input\r\n              id=\"code\"\r\n              name=\"code\"\r\n              type=\"text\"\r\n              placeholder=\"请输入手机验证码\"\r\n              ref={refcode}\r\n              onChange={onChange}\r\n            />\r\n            <button\r\n              className={`code ${buttonActive && \"active\"}`}\r\n                onClick={buttonActive ? () => verification() : null}\r\n            >\r\n              发送验证码\r\n            </button>\r\n          </div>\r\n          <div className=\"submit\">\r\n            <div\r\n              className={`form-button ${\r\n                active && !disabled && \"form-button-active\"\r\n              }`}\r\n                onClick={active && !disabled ? update : null}\r\n            >\r\n              <span>下一步</span>\r\n            </div>\r\n          </div>\r\n          <div className=\"support\" onClick={() => setLiveChat(true)}>\r\n            联系客服\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <LiveChatSA shown={livechat} onClose={() => setLiveChat(false)} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Restore;\r\n"]},"metadata":{},"sourceType":"module"}