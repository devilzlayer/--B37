{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from\"react\";import{Link,Switch,Route,Redirect}from\"react-router-dom\";import moment from\"moment\";import{find}from\"lodash\";import*as Section from\"./profile/\";import{User,Inbox,Transaction}from\"../../service/\";import{withAuth}from\"../util/\";import{UIAlertSA}from\"../component/\";import{vipProgress}from\"./vip/values\";import{getAuthKey}from\"../../util\";import\"../assets/scss/ProfileSA.scss\";import\"react-image-crop/lib/ReactCrop.scss\";import CropDemo from\"./profile/UploadAvatar\";import{avatarClass,MenuItem}from\"./profile/options\";function Menu(props){var _useContext=useContext(User.Context),setUserAuthFN=_useContext.setUserAuthFN,userAuth=_useContext.userAuth;var userData=User.read();var _useState=useState(0),_useState2=_slicedToArray(_useState,2),inboxCount=_useState2[0],setInboxCount=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),vipDays=_useState4[0],setVipDays=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),vipCount=_useState6[0],setVipCount=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),vipLevel=_useState8[0],setVipLevel=_useState8[1];var _useState9=useState(0.0),_useState10=_slicedToArray(_useState9,2),vipAmount=_useState10[0],setVipAmount=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),viProgVal=_useState12[0],setViProgVal=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),avatar=_useState14[0],setAvatar=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),selectedAvatar=_useState16[0],setSelectedAvatar=_useState16[1];var _useState17=useState(),_useState18=_slicedToArray(_useState17,2),customURL=_useState18[0],setCustomURL=_useState18[1];var _useState19=useState(),_useState20=_slicedToArray(_useState19,2),imageSource=_useState20[0],setImageSource=_useState20[1];function checkImage(imageSrc,good,bad){var img=new Image();img.onload=good;img.onerror=bad;img.src=imageSrc;}useEffect(function(){if(userData&&userData.username){var response=Transaction.read(_objectSpread(_objectSpread({},User.read()),{},{type:\"get_imgurl\"}));response.promise.then(function(r){// console.log(r)\nif(r.info){var URL=\"https://u2daszapp.u2d8899.com/newpwa/\".concat(r.info);setCustomURL(URL);}},function(e){console.log('No Image found');});}},[customURL]);useEffect(function(){var q=Inbox.count();q.promise.then(function(r){setInboxCount(+r.info);},function(e){if(!e.is_aborted){console.info(e);}});return function(){return q.cancel();};},[]);useEffect(function(){var response=Transaction.read(_objectSpread(_objectSpread({},User.read()),{},{type:\"get_vip_level\"}));response.promise.then(function(r){// console.log(r);\nif(r.status===1){var vlvp=Number(r.info.viplevel);var vamn=Number(r.info.accountnum);setVipCount(vlvp);setVipLevel(vlvp);var vpP=find(vipProgress,function(obj){return obj.level===vlvp;});setVipAmount(vpP.amount-vamn);var valPer=vamn*100/vpP.amount;setViProgVal(valPer);if(vlvp<10){setVipLevel(Number(vlvp)+1);}}},function(e){});// console.log( )\nif(userAuth&&userAuth.data){var a=moment(userAuth.data.regTime).format(\"MM/DD/YYYY\");var b=moment();var diffDays=b.diff(a,\"days\");setVipDays(diffDays);}},[]);var logout=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return User.logout();case 2:props.history.push('login');// console.log(props)\n// window.location.reload();\ncase 3:case\"end\":return _context.stop();}}},_callee);}));return function logout(){return _ref.apply(this,arguments);};}();function toDataURL(url,callback){var xhr=new XMLHttpRequest();xhr.onload=function(){callback(xhr.response);};xhr.open(\"GET\",url);xhr.responseType=\"blob\";xhr.send();}var Avatar=function Avatar(_ref2){var className=_ref2.className,url=_ref2.url;return/*#__PURE__*/React.createElement(\"i\",{className:className,onClick:function onClick(){setSelectedAvatar(className);toDataURL(url,function(dataUrl){updateCustomPhoto(dataUrl,\"url\");});}},/*#__PURE__*/React.createElement(\"span\",{className:selectedAvatar===className?\"active-avatar\":\"\"}));};function onChangeAvatar(e){if(e.target.files[0]>200000){console.warn(\"File is too big!\");}else{var fileReader=new FileReader();fileReader.onloadend=function(){setImageSource(fileReader.result);};fileReader.readAsDataURL(e.target.files[0]);}}function updateCustomPhoto(file,text){var imageFile=file;var blob=window.URL.createObjectURL(file);if(file.constructor===Blob){var data=new FormData();data.append(\"file\",imageFile,\"sam.jpg\");data.append(\"username\",userData.username);data.append(\"account\",userData.account);data.append(\"password\",userData.password);data.append(\"auth\",getAuthKey());data.append(\"type\",\"upload_pictures\");var res=Transaction.read({body:data,type:\"upload_pictures\"});res.promise.then(function(r){console.log(\"Upload sucessful\",r);// requestAvatar()\nsetCustomURL(blob);localStorage.setItem(\"avatar\",JSON.stringify(blob));if(text===\"custom\"){setImageSource(\"\");setAvatar(false);}// window.location.reload();\n},function(e){console.log(\"Upload failed\",e);});}}// console.log(userAuth)\nvar onSetAvatar=function onSetAvatar(){if(!userAuth.data){logout();return false;}setAvatar(true);};var onClick=function onClick(e){if(!userAuth.data){e.preventDefault();setUserAuthFN(userAuth.status,userAuth.data,true);}};return/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-header-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-header-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-info-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-avatar\",onClick:onSetAvatar},/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(customURL?\"avatar\":\"default\"),style:{backgroundImage:customURL?\"url(\".concat(customURL,\")\"):null}})),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-text\"},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",null,userAuth.data&&userAuth.data.account),/*#__PURE__*/React.createElement(\"span\",{className:\"vip-badge-\".concat(vipCount)})),/*#__PURE__*/React.createElement(\"span\",null,\"\\u52A0\\u5165U\\u4F53\\u80B2\",/*#__PURE__*/React.createElement(\"span\",null,vipDays),\"\\u5929\"),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-bar-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-bar\"},/*#__PURE__*/React.createElement(\"span\",{style:{width:\"\".concat(viProgVal,\"%\")}})),/*#__PURE__*/React.createElement(\"span\",null,\"VIP\",vipLevel),/*#__PURE__*/React.createElement(Link,{className:\"profile-vip\",to:\"/vip\",onClick:onClick},/*#__PURE__*/React.createElement(\"i\",null),\"VIP\\u8BE6\\u60C5\")),/*#__PURE__*/React.createElement(\"span\",null,\"\\u5347\\u7EA7\\u8FD8\\u5DEE\\xA5 \",/*#__PURE__*/React.createElement(\"span\",null,vipAmount),\"\\u5143\\u6D41\\u6C34\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-widget\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-widget-wrap\"},userAuth.data&&/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-widget-value\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u4E2D\\u5FC3:\"),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"span\",null,\"\\uFFE5\"),userAuth.data.balance)),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-hr\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-widget-list\"},/*#__PURE__*/React.createElement(Link,{className:\"profiel-sa-widget-item\",to:\"/profile/deposit?a=1\",onClick:onClick,target:\"_blank\"},/*#__PURE__*/React.createElement(\"i\",{className:\"topup\"}),/*#__PURE__*/React.createElement(\"span\",null,\"\\u5145\\u503C\")),/*#__PURE__*/React.createElement(Link,{className:\"profiel-sa-widget-item\",to:\"/profile/transfer\",onClick:onClick},/*#__PURE__*/React.createElement(\"i\",{className:\"transfer\"}),/*#__PURE__*/React.createElement(\"span\",null,\"\\u8F6C\\u8D26\")),/*#__PURE__*/React.createElement(Link,{className:\"profiel-sa-widget-item\",to:\"/profile/withdraw\",onClick:onClick},/*#__PURE__*/React.createElement(\"i\",{className:\"withdraw\"}),/*#__PURE__*/React.createElement(\"span\",null,\"\\u63D0\\u6B3E\")),/*#__PURE__*/React.createElement(Link,{className:\"profiel-sa-widget-item\",to:\"/inbox\",onClick:onClick},/*#__PURE__*/React.createElement(\"i\",{className:\"information\"},inboxCount?/*#__PURE__*/React.createElement(\"span\",{className:\"count\"},inboxCount):null),/*#__PURE__*/React.createElement(\"span\",null,\"\\u4FE1\\u606F\")))))))),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-content \".concat(!userAuth.data?'not':'')},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-sa-menu\"},/*#__PURE__*/React.createElement(MenuItem,{className:\"n5 betting-history\",to:\"/transaction-record\",name:\"\\u4EA4\\u6613\\u8BB0\\u5F55\",onClick:onClick}),/*#__PURE__*/React.createElement(MenuItem,{className:\"n tag collection\",to:\"/collection\",name:\"\\u4F18\\u60E0\\u9886\\u53D6\",onClick:onClick}),/*#__PURE__*/React.createElement(MenuItem,{className:\"n reward\",to:\"/referral\",name:\"\\u9080\\u8BF7\\u5956\\u52B1\",onClick:onClick}),/*#__PURE__*/React.createElement(MenuItem,{className:\"n personal group top\",to:\"/profile/personal\",name:\"\\u4E2A\\u4EBA\\u8D44\\u6599\",onClick:onClick}),/*#__PURE__*/React.createElement(MenuItem,{className:\"n joinus group\",to:\"/join-us\",name:\"\\u52A0\\u5165\\u6211\\u4EEC\"}),/*#__PURE__*/React.createElement(MenuItem,{className:\"n about group\",to:\"/about\",name:\"\\u5173\\u4E8E\\u6211\\u4EEC\"}),/*#__PURE__*/React.createElement(MenuItem,{className:\"n speedapp group bottom\",to:\"/speed-app\",name:\"\\u6781\\u901FAPP\"}),/*#__PURE__*/React.createElement(MenuItem,{className:\"n feedback\",to:\"/feedback\",name:\"\\u610F\\u89C1\\u53CD\\u9988\"}),userAuth.data&&userAuth.data.is_agent===\"1\"?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(MenuItem,{className:\"n11 qr\",to:\"/profile/agency/qr\",name:\"\\u4EE3\\u7406\\u63A8\\u5E7F\"}),/*#__PURE__*/React.createElement(MenuItem,{className:\"n12 agent-report\",to:\"/profile/agency/agent-report\",name:\"\\u4EE3\\u7406\\u5546\\u62A5\\u544A\"}),/*#__PURE__*/React.createElement(MenuItem,{className:\"n13 comission\",to:\"/profile/agency/comission-report\",name:\"\\u4F63\\u91D1\\u62A5\\u544A\"}),/*#__PURE__*/React.createElement(MenuItem,{className:\"n14 members \",to:\"/profile/agency/members\",name:\"\\u4F1A\\u5458\\u540D\\u5355\"})):null,/*#__PURE__*/React.createElement(MenuItem,{className:\"n10\",onClick:logout,name:\"\\u9000\\u51FA\\u767B\\u5F55\"}))),/*#__PURE__*/React.createElement(UIAlertSA,{onClose:function onClose(){return setTimeout(function(){setAvatar(false);},200);},shown:avatar},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-avatar-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-avatar-content\"},avatarClass.map(function(data,i){return/*#__PURE__*/React.createElement(Avatar,{className:data.name,url:data.url,key:i});}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"imgAvatar\",className:\"select-image\",onClick:function onClick(){return setSelectedAvatar(\"custom\");}}),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",id:\"imgAvatar\",name:\"imgAvatar\",accept:\" image/jpeg, image/png\",onChange:function onChange(e){onChangeAvatar(e);setAvatar(false);},style:{opacity:0,zIndex:-1,display:\"none\"}})))),imageSource?/*#__PURE__*/React.createElement(CropDemo,{onClose:function onClose(){setImageSource(\"\");setAvatar(true);},src:imageSource,updateCustomPhoto:updateCustomPhoto}):null);}function Profile(){var _useContext2=useContext(User.Context),userAuth=_useContext2.userAuth;// console.log(userAuth)\nreturn/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/profile\",component:Menu}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/deposit\",component:Section.Deposit}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/transfer\",component:Section.Transfer}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/withdraw\",component:Section.Withdraw}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/personal\",component:Section.Personal}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/password\",component:Section.Password}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/fullname\",component:Section.Fullname}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/birthdate\",component:Section.Birthdate}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/cellphone\",component:Section.Cellphone}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/email\",component:Section.Email}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/payment\",component:Section.Card}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/betting-history\",component:Section.Betting}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/transactions/:type\",component:Section.Transactions}),userAuth.data&&userAuth.data.is_agent===\"1\"?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Route,{path:\"/profile/agency/qr\",component:Section.QR}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/agency/agent-report\",component:Section.AgentReport}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/agency/comission-report\",component:Section.ComissionReport}),/*#__PURE__*/React.createElement(Route,{path:\"/profile/agency/members\",component:Section.Members})):null,/*#__PURE__*/React.createElement(Redirect,{to:\"/profile\"}));}export default withAuth(Profile,0);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/pwa/view/Profile.js"],"names":["React","useEffect","useState","useContext","Link","Switch","Route","Redirect","moment","find","Section","User","Inbox","Transaction","withAuth","UIAlertSA","vipProgress","getAuthKey","CropDemo","avatarClass","MenuItem","Menu","props","Context","setUserAuthFN","userAuth","userData","read","inboxCount","setInboxCount","vipDays","setVipDays","vipCount","setVipCount","vipLevel","setVipLevel","vipAmount","setVipAmount","viProgVal","setViProgVal","avatar","setAvatar","selectedAvatar","setSelectedAvatar","customURL","setCustomURL","imageSource","setImageSource","checkImage","imageSrc","good","bad","img","Image","onload","onerror","src","username","response","type","promise","then","r","info","URL","e","console","log","q","count","is_aborted","cancel","status","vlvp","Number","viplevel","vamn","accountnum","vpP","obj","level","amount","valPer","data","a","regTime","format","b","diffDays","diff","logout","history","push","toDataURL","url","callback","xhr","XMLHttpRequest","open","responseType","send","Avatar","className","dataUrl","updateCustomPhoto","onChangeAvatar","target","files","warn","fileReader","FileReader","onloadend","result","readAsDataURL","file","text","imageFile","blob","window","createObjectURL","constructor","Blob","FormData","append","account","password","res","body","localStorage","setItem","JSON","stringify","onSetAvatar","onClick","preventDefault","backgroundImage","width","balance","is_agent","setTimeout","map","i","name","opacity","zIndex","display","Profile","Deposit","Transfer","Withdraw","Personal","Password","Fullname","Birthdate","Cellphone","Email","Card","Betting","Transactions","QR","AgentReport","ComissionReport","Members"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\r\nimport { Link, Switch, Route, Redirect } from \"react-router-dom\";\r\nimport moment from \"moment\";\r\nimport { find } from \"lodash\";\r\nimport * as Section from \"./profile/\";\r\nimport { User, Inbox, Transaction } from \"../../service/\";\r\nimport { withAuth } from \"../util/\";\r\nimport { UIAlertSA } from \"../component/\";\r\nimport { vipProgress } from \"./vip/values\";\r\nimport { getAuthKey } from \"../../util\";\r\n\r\nimport \"../assets/scss/ProfileSA.scss\";\r\nimport \"react-image-crop/lib/ReactCrop.scss\";\r\n\r\nimport CropDemo from \"./profile/UploadAvatar\";\r\nimport { avatarClass, MenuItem } from \"./profile/options\";\r\n\r\nfunction Menu(props) {\r\n  const { setUserAuthFN ,userAuth } = useContext(User.Context);\r\n  const userData = User.read();\r\n\r\n  const [inboxCount, setInboxCount] = useState(0);\r\n\r\n  const [vipDays, setVipDays] = useState(0);\r\n  const [vipCount, setVipCount] = useState(0);\r\n  const [vipLevel, setVipLevel] = useState(1);\r\n  const [vipAmount, setVipAmount] = useState(0.0);\r\n  const [viProgVal, setViProgVal] = useState(0);\r\n\r\n  const [avatar, setAvatar] = useState(false);\r\n  const [selectedAvatar, setSelectedAvatar] = useState();\r\n  const [customURL, setCustomURL] = useState();\r\n  const [imageSource, setImageSource] = useState();\r\n\r\n  function checkImage(imageSrc, good, bad) {\r\n    var img = new Image();\r\n    img.onload = good;\r\n    img.onerror = bad;\r\n    img.src = imageSrc;\r\n  }\r\n\r\n  useEffect(() => {\r\n    if(userData && userData.username){\r\n      const response = Transaction.read({\r\n        ...User.read(),\r\n        type: \"get_imgurl\",\r\n      });\r\n      response.promise.then(r => {\r\n        // console.log(r)\r\n        if(r.info){\r\n          const URL = `https://u2daszapp.u2d8899.com/newpwa/${r.info}`;\r\n          setCustomURL(URL);\r\n        }\r\n        \r\n      }, e =>{\r\n        console.log('No Image found')\r\n      })\r\n\r\n    }\r\n    \r\n  }, [customURL]);\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    const q = Inbox.count();\r\n    q.promise.then(\r\n      (r) => {\r\n        setInboxCount(+r.info);\r\n      },\r\n      (e) => {\r\n        if (!e.is_aborted) {\r\n          console.info(e);\r\n        }\r\n      }\r\n    );\r\n    return () => q.cancel();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const response = Transaction.read({\r\n      ...User.read(),\r\n      type: \"get_vip_level\",\r\n    });\r\n\r\n    response.promise.then(\r\n      (r) => {\r\n        // console.log(r);\r\n\r\n        if (r.status === 1) {\r\n          const vlvp = Number(r.info.viplevel);\r\n          const vamn = Number(r.info.accountnum);\r\n          setVipCount(vlvp);\r\n          setVipLevel(vlvp);\r\n          const vpP = find(vipProgress, (obj) => obj.level === vlvp);\r\n          setVipAmount(vpP.amount - vamn);\r\n          const valPer = (vamn * 100) / vpP.amount;\r\n          setViProgVal(valPer);\r\n\r\n          if (vlvp < 10) {\r\n            setVipLevel(Number(vlvp) + 1);\r\n          }\r\n        }\r\n      },\r\n      (e) => {}\r\n    );\r\n\r\n    // console.log( )\r\n    if(userAuth && userAuth.data){\r\n      var a = moment(userAuth.data.regTime).format(\"MM/DD/YYYY\");\r\n      var b = moment();\r\n      var diffDays = b.diff(a, \"days\");\r\n      setVipDays(diffDays);\r\n    }\r\n    \r\n  }, []);\r\n\r\n  const logout = async () => {\r\n    await User.logout();\r\n\r\n    props.history.push('login')\r\n    // console.log(props)\r\n    // window.location.reload();\r\n  };\r\n\r\n  function toDataURL(url, callback) {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.onload = function () {\r\n      callback(xhr.response);\r\n    };\r\n    xhr.open(\"GET\", url);\r\n    xhr.responseType = \"blob\";\r\n    xhr.send();\r\n  }\r\n\r\n  const Avatar = ({ className, url }) => (\r\n    <i\r\n      className={className}\r\n      onClick={() => {\r\n        setSelectedAvatar(className);\r\n        toDataURL(url, function (dataUrl) {\r\n          updateCustomPhoto(dataUrl, \"url\");\r\n        });\r\n      }}\r\n    >\r\n      <span className={selectedAvatar === className ? \"active-avatar\" : \"\"} />\r\n    </i>\r\n  );\r\n\r\n  function onChangeAvatar(e) {\r\n    if (e.target.files[0] > 200000) {\r\n      console.warn(\"File is too big!\");\r\n    } else {\r\n      const fileReader = new FileReader();\r\n      fileReader.onloadend = () => {\r\n        setImageSource(fileReader.result);\r\n      };\r\n      fileReader.readAsDataURL(e.target.files[0]);\r\n    }\r\n  }\r\n\r\n  function updateCustomPhoto(file, text) {\r\n    const imageFile = file;\r\n    const blob = window.URL.createObjectURL(file);\r\n    if (file.constructor === Blob) {\r\n      const data = new FormData();\r\n      data.append(\"file\", imageFile, \"sam.jpg\");\r\n      data.append(\"username\", userData.username);\r\n      data.append(\"account\", userData.account);\r\n      data.append(\"password\", userData.password);\r\n      data.append(\"auth\", getAuthKey());\r\n      data.append(\"type\", \"upload_pictures\");\r\n\r\n      const res = Transaction.read({\r\n        body: data,\r\n        type: \"upload_pictures\",\r\n      });\r\n      res.promise.then(\r\n        (r) => {\r\n          console.log(\"Upload sucessful\", r);\r\n          // requestAvatar()\r\n          setCustomURL(blob);\r\n          localStorage.setItem(\"avatar\", JSON.stringify(blob));\r\n\r\n          if (text === \"custom\") {\r\n            setImageSource(\"\");\r\n            setAvatar(false);\r\n          }\r\n          // window.location.reload();\r\n        },\r\n        (e) => {\r\n          console.log(\"Upload failed\", e);\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  // console.log(userAuth)\r\n\r\n  const onSetAvatar = () =>{\r\n    if(!userAuth.data){\r\n      logout()\r\n      return false\r\n    }\r\n    setAvatar(true)\r\n  }\r\n\r\n  const onClick = (e) =>{\r\n    if(!userAuth.data){\r\n      e.preventDefault()\r\n      setUserAuthFN(userAuth.status , userAuth.data , true)\r\n    }\r\n  }\r\n\r\n\r\n  \r\n  return (\r\n    <div className=\"profile-sa\">\r\n      {/* ============ EDIT ============ */}\r\n      <div className=\"profile-sa-header\">\r\n        <div className=\"profile-sa-header-wrap\">\r\n          <div className=\"profile-sa-header-content\">\r\n            <div className=\"profile-sa-info-content\">\r\n              <div\r\n                className=\"profile-sa-avatar\"\r\n                onClick={onSetAvatar}\r\n              >\r\n                <div\r\n                  className={`${customURL ? \"avatar\" : \"default\"}`}\r\n                  style={{\r\n                    backgroundImage: customURL ? `url(${customURL})` : null,\r\n                  }}\r\n                />\r\n              </div>\r\n              <div className=\"profile-sa-text\">\r\n                <p>\r\n                  <label>{userAuth.data && userAuth.data.account}</label>\r\n                  <span className={`vip-badge-${vipCount}`} />\r\n                </p>\r\n                <span>\r\n                  加入U体育<span>{vipDays}</span>天\r\n                </span>\r\n                <div className=\"profile-sa-bar-wrap\">\r\n                  <div className=\"profile-bar\">\r\n                    <span style={{ width: `${viProgVal}%` }} />\r\n                  </div>\r\n                  <span>VIP{vipLevel}</span>\r\n\r\n                  <Link className=\"profile-vip\" to={\"/vip\"} onClick={onClick}>\r\n                    <i />\r\n                    VIP详情\r\n                  </Link>\r\n                </div>\r\n                <span>\r\n                  升级还差¥ <span>{vipAmount}</span>元流水\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <div className=\"profile-sa-widget\">\r\n              <div className=\"profile-sa-widget-wrap\">\r\n                {userAuth.data && \r\n                <div className=\"profile-sa-widget-value\">\r\n                  <span>中心:</span>\r\n                  <p>\r\n                    <span>￥</span>\r\n                    {userAuth.data.balance}\r\n                  </p>\r\n                </div>\r\n                }\r\n                \r\n                <div className=\"profile-sa-hr\" />\r\n\r\n                <div className=\"profile-sa-widget-list\">\r\n                  <Link className=\"profiel-sa-widget-item\" to={\"/profile/deposit?a=1\"} onClick={onClick} target=\"_blank\">\r\n                    <i className=\"topup\" />\r\n                    <span>充值</span>\r\n                  </Link>\r\n                  <Link className=\"profiel-sa-widget-item\" to={\"/profile/transfer\"} onClick={onClick}>\r\n                    <i className=\"transfer\" />\r\n                    <span>转账</span>\r\n                  </Link>\r\n                  <Link className=\"profiel-sa-widget-item\" to={\"/profile/withdraw\"} onClick={onClick}>\r\n                    <i className=\"withdraw\" />\r\n                    <span>提款</span>\r\n                  </Link>\r\n                  <Link className=\"profiel-sa-widget-item\" to={\"/inbox\"} onClick={onClick}>\r\n                    <i className=\"information\">\r\n                      {inboxCount ? (\r\n                        <span className=\"count\">{inboxCount}</span>\r\n                      ) : null}\r\n                    </i>\r\n                    <span>信息</span>\r\n                  </Link>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {/* ============ EDIT ============ */}\r\n\r\n      <div className={`profile-sa-content ${!userAuth.data ? 'not' : '' }`}>\r\n        <div className=\"profile-sa-menu\">\r\n          <MenuItem className=\"n5 betting-history\" to=\"/transaction-record\" name=\"交易记录\" onClick={onClick} />\r\n          <MenuItem className=\"n tag collection\" to=\"/collection\" name=\"优惠领取\" onClick={onClick}/>\r\n          <MenuItem className=\"n reward\" to=\"/referral\" name=\"邀请奖励\" onClick={onClick}/>\r\n          <MenuItem className=\"n personal group top\" to=\"/profile/personal\" name=\"个人资料\" onClick={onClick}/>\r\n          <MenuItem className=\"n joinus group\" to=\"/join-us\" name=\"加入我们\" />\r\n          <MenuItem className=\"n about group\" to=\"/about\" name=\"关于我们\" />\r\n          <MenuItem className=\"n speedapp group bottom\" to=\"/speed-app\" name=\"极速APP\" />\r\n          <MenuItem className=\"n feedback\" to=\"/feedback\" name=\"意见反馈\" />\r\n          {userAuth.data && userAuth.data.is_agent === \"1\" ? (\r\n            <>\r\n              <MenuItem className=\"n11 qr\" to=\"/profile/agency/qr\" name=\"代理推广\"\r\n              />\r\n              <MenuItem className=\"n12 agent-report\" to=\"/profile/agency/agent-report\" name=\"代理商报告\"\r\n              />\r\n              <MenuItem className=\"n13 comission\" to=\"/profile/agency/comission-report\" name=\"佣金报告\" />\r\n              <MenuItem className=\"n14 members \" to=\"/profile/agency/members\" name=\"会员名单\"\r\n              />\r\n            </>\r\n          ) : null}\r\n          <MenuItem className=\"n10\" onClick={logout} name=\"退出登录\" />\r\n        </div>\r\n      </div>\r\n\r\n      <UIAlertSA\r\n        onClose={() =>\r\n          setTimeout(() => {\r\n            setAvatar(false);\r\n          }, 200)\r\n        }\r\n        shown={avatar}\r\n      >\r\n        <div className=\"modal-avatar-wrap\">\r\n          <div className=\"modal-avatar-content\">\r\n            {avatarClass.map((data, i) => (\r\n              <Avatar className={data.name} url={data.url} key={i} />\r\n            ))}\r\n            <label\r\n              htmlFor=\"imgAvatar\"\r\n              className=\"select-image\"\r\n              onClick={() => setSelectedAvatar(\"custom\")}\r\n            />\r\n            <input\r\n              type=\"file\"\r\n              id=\"imgAvatar\"\r\n              name=\"imgAvatar\"\r\n              accept=\" image/jpeg, image/png\"\r\n              onChange={(e) => {\r\n                onChangeAvatar(e);\r\n                setAvatar(false);\r\n              }}\r\n              style={{ opacity: 0, zIndex: -1, display: \"none\" }}\r\n            />\r\n          </div>\r\n        </div>\r\n      </UIAlertSA>\r\n      {imageSource ? (\r\n        <CropDemo\r\n          onClose={() => {\r\n            setImageSource(\"\");\r\n            setAvatar(true);\r\n          }}\r\n          src={imageSource}\r\n          updateCustomPhoto={updateCustomPhoto}\r\n        />\r\n      ) : null}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Profile() {\r\n  const { userAuth } = useContext(User.Context);\r\n\r\n  // console.log(userAuth)\r\n  return (\r\n    <Switch>\r\n      <Route exact path=\"/profile\" component={Menu} />\r\n      <Route path=\"/profile/deposit\" component={Section.Deposit} />\r\n      <Route path=\"/profile/transfer\" component={Section.Transfer} />\r\n      <Route path=\"/profile/withdraw\" component={Section.Withdraw} />\r\n      <Route path=\"/profile/personal\" component={Section.Personal} />\r\n      <Route path=\"/profile/password\" component={Section.Password} />\r\n      <Route path=\"/profile/fullname\" component={Section.Fullname} />\r\n      <Route path=\"/profile/birthdate\" component={Section.Birthdate} />\r\n      <Route path=\"/profile/cellphone\" component={Section.Cellphone} />\r\n      <Route path=\"/profile/email\" component={Section.Email} />\r\n      <Route path=\"/profile/payment\" component={Section.Card} />\r\n      <Route path=\"/profile/betting-history\" component={Section.Betting} />\r\n      <Route\r\n        path=\"/profile/transactions/:type\"\r\n        component={Section.Transactions}\r\n      />\r\n      {userAuth.data && userAuth.data.is_agent === \"1\" ? (\r\n        <>\r\n          <Route path=\"/profile/agency/qr\" component={Section.QR} />\r\n          <Route path=\"/profile/agency/agent-report\" component={Section.AgentReport} />\r\n          <Route path=\"/profile/agency/comission-report\" component={Section.ComissionReport}/>\r\n          <Route path=\"/profile/agency/members\" component={Section.Members} />\r\n        </>\r\n      ) : null}\r\n      <Redirect to=\"/profile\" />\r\n    </Switch>\r\n  );\r\n}\r\n\r\nexport default withAuth(Profile, 0);\r\n"]},"metadata":{},"sourceType":"module"}