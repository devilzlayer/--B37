{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Downloads/usportproject 2/src/pwa/view/Game.js\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { useParams, useHistory, useLocation } from \"react-router-dom\";\nimport Picker from \"react-mobile-picker\";\nimport ReactSlider from \"react-slider\";\nimport cx from \"classnames\";\nimport BigNumber from \"bignumber.js\";\nimport useClickOutside from \"click-outside-hook\";\nimport { withAuth } from \"../util/\";\nimport { Icon } from \"../../component/\";\nimport { User, Game as Service } from \"../../service/\";\nimport \"../assets/scss/GameSA.scss\";\nconst externals = [1204, 1209, 1211];\n\nfunction Game() {\n  const history = useHistory();\n  const {\n    search\n  } = useLocation(); // eslint-disable-next-line\n\n  const [fromHome, setFromHome] = useState(search.includes(\"from_home=1\"));\n  useEffect(() => {\n    if (fromHome) {\n      history.replace({\n        search: \"\"\n      });\n    }\n  }, [history, fromHome]);\n  const [loading, setLoading] = useState(false);\n  const {\n    userAuth,\n    setUserAuthFN\n  } = useContext(User.Context);\n  const {\n    id,\n    name\n  } = useParams();\n  const isExternal = externals.includes(+id);\n  const [iframe, setIframe] = useState(null);\n  const [iframeI, setIframeI] = useState(0);\n  const [fullScreen, setFullScreen] = useState(false);\n  const [overlayState, setOverlayState] = useState(false);\n  const refClickOut = useClickOutside(() => setOverlayState(false));\n  const [balances, setBalances] = useState([]);\n  const [balanceTransferred, setBalanceTransferred] = useState(false);\n  const [balanceUpdateI, setBalanceUpdateI] = useState(0);\n  const [balanceLoad, setBalanceLoad] = useState(false);\n  const [balancesMap, setBalancesMap] = useState({});\n  const [balanceOver, setBalanceOver] = useState(null);\n  const [balanceForm, setBalanceForm] = useState({\n    from: \"中央钱包\",\n    to: name,\n    amount: \"\"\n  });\n  const [sliderPercent, setSliderPercent] = useState(0);\n  const [balanceCurrent, setBalanceCurrent] = useState({\n    name: \"\",\n    balance: 0\n  });\n\n  const goBack = () => history.push(\"/\");\n\n  const refresh = () => setIframeI(iframeI + 1);\n\n  const [focHeight, setFocHeight] = useState([]);\n  useEffect(() => {\n    const {\n      innerHeight: height\n    } = window;\n    setFocHeight(height);\n    window.scrollTo(0, 0);\n  }, []);\n  useEffect(() => {\n    if (isExternal) {\n      return () => {};\n    }\n\n    setBalances([]);\n    setBalancesMap({});\n    setBalanceCurrent(bc => ({\n      name,\n      balance: 0\n    }));\n    Service.balances({ ...User.read()\n    }).then(_balances => {\n      const __balances = _balances.filter(b => !b.error).map(b => `${b.game.name}: ${b.balance} ¥`);\n\n      __balances.push(`中央钱包: ${userAuth.data.balance} ¥`);\n\n      setBalanceForm(balanceForm => ({ ...balanceForm // from: __balances[0],\n        // to: __balances[1],\n\n      }));\n      setBalances(__balances);\n      const __balancesMap = {};\n\n      _balances.filter(b => !b.error).forEach(b => {\n        __balancesMap[b.game.name] = b;\n      });\n\n      __balancesMap[\"中央钱包\"] = {\n        game: {\n          id: 0,\n          name: \"wallet\"\n        },\n        wallet: true,\n        balance: userAuth.data.balance\n      };\n      setBalanceCurrent(bc => ({ ...bc,\n        balance: __balancesMap[name].balance\n      }));\n      setBalancesMap(__balancesMap);\n    });\n  }, [balanceUpdateI, userAuth.data.balance, isExternal, name]);\n  useEffect(() => {\n    setLoading(true);\n    const user = User.read();\n    const req = Service.activate({\n      num: 1,\n      type: \"active\",\n      gameid: id,\n      ...user\n    });\n\n    function LogIn() {\n      Service.login({\n        num: 1,\n        gameid: id,\n        ...user\n      }).promise.then(r => {\n        if (!isExternal) {\n          setLoading(false);\n          setIframe(r.info);\n        } else {\n          if (fromHome) {\n            window.location.href = r.info;\n          } else {\n            history.push(\"/\");\n          }\n        }\n      }, e => {\n        console.error(\"Unable to login to the game\", e);\n      });\n    }\n\n    req.promise.then(r => {\n      console.log(r);\n      LogIn();\n    }, e => {\n      if (!e.is_aborted) {\n        console.error(\"Unable to activate the game:\", e);\n        LogIn();\n      }\n    });\n    return () => req.cancel();\n  }, [id, history, fromHome, isExternal]);\n  useEffect(() => {\n    document.body.style.overflow = balanceOver ? \"hidden\" : \"auto\";\n    return () => {\n      document.body.style.overflow = \"auto\";\n    };\n  }, [balanceOver]);\n\n  const PickerWrap = ({\n    dist\n  }) => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 5\n    }\n  }, balances.length ? /*#__PURE__*/React.createElement(Picker, {\n    height: 120,\n    valueGroups: {\n      [dist]: balanceForm[dist]\n    },\n    optionGroups: {\n      [dist]: balances\n    },\n    onChange: (key, value) => setBalanceForm({ ...balanceForm,\n      [key]: value\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 9\n    }\n  }) : null);\n\n  const setAmount = e => {\n    // console.log(e.target.validity.valid);\n    const amount = e.target.value;\n    const percent = +BigNumber(amount / userAuth.data.balance * 100).toFixed(0);\n    setBalanceForm(form => ({ ...form,\n      amount\n    }));\n    setSliderPercent(percent);\n  };\n\n  const transfer = e => {\n    if (!balanceForm.amount || isNaN(+balanceForm.amount)) {\n      return void console.warn(\"[transfer] No amount\");\n    }\n\n    const _getMap = n => balancesMap[n.split(\": \")[0]] || null;\n\n    const _from = _getMap(balanceForm.from);\n\n    const _to = _getMap(balanceForm.to);\n\n    if (_from.game.id === _to.game.id) {\n      return void console.warn(\"[transfer] Same game\");\n    }\n\n    if (_from.balance === 0) {\n      return void console.warn(\"[transfer] Zero balance\");\n    }\n\n    if (_from.balance < +balanceForm.amount) {\n      return void console.warn(\"[transfer] Not enough game balance\");\n    }\n\n    console.info(`You're transfering ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}`);\n    balanceForm.amount = BigNumber(balanceForm.amount).toFixed(0);\n    setBalanceLoad(true);\n    Service.transfer({ ...User.read(),\n      amount: +balanceForm.amount,\n      from: _from.game.id,\n      to: _to.game.id\n    }).then(r => {\n      console.info(`You have successfully transferred ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}: ${r.info}`);\n      setBalanceLoad(false);\n      setBalanceTransferred(true);\n    }, e => {\n      console.error(e);\n      setBalanceLoad(false);\n    });\n  };\n\n  const finishTransfer = () => {\n    setOverlayState(false);\n    setBalanceTransferred(false);\n    setBalanceForm(bf => ({ ...bf,\n      amount: \"\"\n    }));\n    setSliderPercent(0);\n    setBalanceUpdateI(i => i + 1);\n    User.session({ ...User.read()\n    }).promise.then(r => setUserAuthFN(1, r.info));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(\"game-sa\", \"with-loader\", {\n      loading: loading,\n      \"full-screen\": fullScreen\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"full-screen-exit\",\n    onClick: () => setFullScreen(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"load-spin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(\"game-sa-head\", {\n      hidden: fullScreen\n    }),\n    style: isExternal ? {\n      display: \"none\"\n    } : {},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sa-head-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: goBack,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sa-head-middle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 11\n    }\n  }, name)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sa-head-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"balance\",\n    onClick: e => setOverlayState(true),\n    disabled: !balances.length,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"refresh\",\n    onClick: refresh,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"full-screen\",\n    onClick: () => setFullScreen(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 13\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"game-sa-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 7\n    }\n  }, iframe ? /*#__PURE__*/React.createElement(\"iframe\", {\n    key: iframeI,\n    title: `IFRAME-N${id}`,\n    src: iframe,\n    style: {\n      height: fullScreen ? focHeight : focHeight - 60\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 11\n    }\n  }) : null), /*#__PURE__*/React.createElement(\"div\", {\n    className: `game-sa-overlay${overlayState ? \" shown\" : \"\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"overlay-sublayer\",\n    ref: refClickOut,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `overlay-layer with-loader${balanceLoad ? \" loading\" : \"\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"load-spin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 13\n    }\n  }), balanceTransferred ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form response\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-head not-message\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 19\n    }\n  }, \"\\u8F6C\\u8D26\\u6210\\u529F\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"close\",\n    onClick: finishTransfer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"close-circle-sharp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-body not-message\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: finishTransfer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 21\n    }\n  }, \"\\u786E\\u8BA4\")))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 19\n    }\n  }, \"\\u8F6C\\u8D26\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"close\",\n    onClick: e => setOverlayState(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"close-circle-sharp\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-body-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field transfer-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"transfer--item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 25\n    }\n  }, \"\\u8F6C\\u51FA\\u94B1\\u5305\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"game\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 25\n    }\n  }, \"\\u4E2D\\u592E\\u94B1\\u5305\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"balance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 25\n    }\n  }, BigNumber(userAuth.data.balance).toFormat(2))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"transfer--item icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"arrow-left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"transfer--item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 25\n    }\n  }, \"\\u8F6C\\u5165\\u94B1\\u5305\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"game\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 25\n    }\n  }, balanceCurrent.name), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"balance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 25\n    }\n  }, BigNumber(balanceCurrent.balance).toFormat(2)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"slider-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 25\n    }\n  }, \"0\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"slider-subwrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(ReactSlider, {\n    className: \"slider-picker\",\n    thumbClassName: \"thumb\",\n    trackClassName: \"track\",\n    value: sliderPercent,\n    onChange: percent => {\n      const amount = BigNumber(percent * userAuth.data.balance / 100).toFixed(0);\n      setSliderPercent(percent);\n      setBalanceForm(bf => ({ ...bf,\n        amount\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 27\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    onClick: () => {\n      const amount = BigNumber(userAuth.data.balance).toFixed(0);\n      setSliderPercent(100);\n      setBalanceForm(bf => ({ ...bf,\n        amount\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 440,\n      columnNumber: 25\n    }\n  }, \"MAX\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"amount\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 458,\n      columnNumber: 23\n    }\n  }, \"\\u91D1\\u989D/\\u8F6C\\u5165\\u91D1\\u989D\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input--wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    id: \"amount\",\n    type: \"number\",\n    placeholder: \"0.00\",\n    pattern: \"[0-9]*\",\n    value: balanceForm.amount,\n    onChange: e => setAmount(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 25\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 471,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: transfer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 21\n    }\n  }, \"\\u7ACB\\u5373\\u8F6C\\u8D26\"))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: `game-sa-overlay picker-over${balanceOver ? \" shown\" : \"\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 480,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 483,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 484,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: e => setBalanceOver(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 485,\n      columnNumber: 13\n    }\n  }, \"\\u53D6\\u6D88\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 486,\n      columnNumber: 13\n    }\n  }, balanceOver === \"from\" ? \"推出\" : \"进入\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: e => setBalanceOver(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 487,\n      columnNumber: 13\n    }\n  }, \"\\u786E\\u5B9A\")), balanceOver ? /*#__PURE__*/React.createElement(PickerWrap, {\n    dist: balanceOver,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 489,\n      columnNumber: 26\n    }\n  }) : null)));\n}\n\nexport default withAuth(Game, 1);","map":{"version":3,"sources":["/Users/cramj/Downloads/usportproject 2/src/pwa/view/Game.js"],"names":["React","useState","useEffect","useContext","useParams","useHistory","useLocation","Picker","ReactSlider","cx","BigNumber","useClickOutside","withAuth","Icon","User","Game","Service","externals","history","search","fromHome","setFromHome","includes","replace","loading","setLoading","userAuth","setUserAuthFN","Context","id","name","isExternal","iframe","setIframe","iframeI","setIframeI","fullScreen","setFullScreen","overlayState","setOverlayState","refClickOut","balances","setBalances","balanceTransferred","setBalanceTransferred","balanceUpdateI","setBalanceUpdateI","balanceLoad","setBalanceLoad","balancesMap","setBalancesMap","balanceOver","setBalanceOver","balanceForm","setBalanceForm","from","to","amount","sliderPercent","setSliderPercent","balanceCurrent","setBalanceCurrent","balance","goBack","push","refresh","focHeight","setFocHeight","innerHeight","height","window","scrollTo","bc","read","then","_balances","__balances","filter","b","error","map","game","data","__balancesMap","forEach","wallet","user","req","activate","num","type","gameid","LogIn","login","promise","r","info","location","href","e","console","log","is_aborted","cancel","document","body","style","overflow","PickerWrap","dist","length","key","value","setAmount","target","percent","toFixed","form","transfer","isNaN","warn","_getMap","n","split","_from","_to","finishTransfer","bf","i","session","hidden","display","toFormat"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\nimport { useParams, useHistory, useLocation } from \"react-router-dom\";\r\nimport Picker from \"react-mobile-picker\";\r\nimport ReactSlider from \"react-slider\";\r\nimport cx from \"classnames\";\r\nimport BigNumber from \"bignumber.js\";\r\nimport useClickOutside from \"click-outside-hook\";\r\n\r\nimport { withAuth } from \"../util/\";\r\nimport { Icon } from \"../../component/\";\r\nimport { User, Game as Service } from \"../../service/\";\r\n\r\nimport \"../assets/scss/GameSA.scss\";\r\n\r\nconst externals = [1204, 1209, 1211];\r\n\r\nfunction Game() {\r\n  const history = useHistory();\r\n\r\n  const { search } = useLocation();\r\n  // eslint-disable-next-line\r\n  const [fromHome, setFromHome] = useState(search.includes(\"from_home=1\"));\r\n\r\n  useEffect(() => {\r\n    if (fromHome) {\r\n      history.replace({ search: \"\" });\r\n    }\r\n  }, [history, fromHome]);\r\n\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const { userAuth, setUserAuthFN } = useContext(User.Context);\r\n\r\n  const { id, name } = useParams();\r\n  const isExternal = externals.includes(+id);\r\n\r\n  const [iframe, setIframe] = useState(null);\r\n  const [iframeI, setIframeI] = useState(0);\r\n\r\n  const [fullScreen, setFullScreen] = useState(false);\r\n\r\n  const [overlayState, setOverlayState] = useState(false);\r\n\r\n  const refClickOut = useClickOutside(() => setOverlayState(false));\r\n\r\n  const [balances, setBalances] = useState([]);\r\n  const [balanceTransferred, setBalanceTransferred] = useState(false);\r\n  const [balanceUpdateI, setBalanceUpdateI] = useState(0);\r\n  const [balanceLoad, setBalanceLoad] = useState(false);\r\n  const [balancesMap, setBalancesMap] = useState({});\r\n  const [balanceOver, setBalanceOver] = useState(null);\r\n  const [balanceForm, setBalanceForm] = useState({\r\n    from: \"中央钱包\",\r\n    to: name,\r\n    amount: \"\",\r\n  });\r\n\r\n  const [sliderPercent, setSliderPercent] = useState(0);\r\n\r\n  const [balanceCurrent, setBalanceCurrent] = useState({\r\n    name: \"\",\r\n    balance: 0,\r\n  });\r\n\r\n  const goBack = () => history.push(\"/\");\r\n\r\n  const refresh = () => setIframeI(iframeI + 1);\r\n\r\n  const [focHeight, setFocHeight] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const { innerHeight: height } = window;\r\n    setFocHeight(height);\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isExternal) {\r\n      return () => {};\r\n    }\r\n\r\n    setBalances([]);\r\n    setBalancesMap({});\r\n\r\n    setBalanceCurrent((bc) => ({\r\n      name,\r\n      balance: 0,\r\n    }));\r\n\r\n    Service.balances({\r\n      ...User.read(),\r\n    }).then((_balances) => {\r\n      const __balances = _balances\r\n        .filter((b) => !b.error)\r\n        .map((b) => `${b.game.name}: ${b.balance} ¥`);\r\n      __balances.push(`中央钱包: ${userAuth.data.balance} ¥`);\r\n\r\n      setBalanceForm((balanceForm) => ({\r\n        ...balanceForm,\r\n        // from: __balances[0],\r\n        // to: __balances[1],\r\n      }));\r\n\r\n      setBalances(__balances);\r\n\r\n      const __balancesMap = {};\r\n\r\n      _balances\r\n        .filter((b) => !b.error)\r\n        .forEach((b) => {\r\n          __balancesMap[b.game.name] = b;\r\n        });\r\n\r\n      __balancesMap[\"中央钱包\"] = {\r\n        game: {\r\n          id: 0,\r\n          name: \"wallet\",\r\n        },\r\n        wallet: true,\r\n        balance: userAuth.data.balance,\r\n      };\r\n\r\n      setBalanceCurrent((bc) => ({\r\n        ...bc,\r\n        balance: __balancesMap[name].balance,\r\n      }));\r\n\r\n      setBalancesMap(__balancesMap);\r\n    });\r\n  }, [balanceUpdateI, userAuth.data.balance, isExternal, name]);\r\n\r\n  useEffect(() => {\r\n    setLoading(true);\r\n\r\n    const user = User.read();\r\n\r\n    const req = Service.activate({\r\n      num: 1,\r\n      type: \"active\",\r\n      gameid: id,\r\n      ...user,\r\n    });\r\n\r\n    function LogIn() {\r\n      Service.login({\r\n        num: 1,\r\n        gameid: id,\r\n        ...user,\r\n      }).promise.then(\r\n        (r) => {\r\n          if (!isExternal) {\r\n            setLoading(false);\r\n\r\n            setIframe(r.info);\r\n          } else {\r\n            if (fromHome) {\r\n              window.location.href = r.info;\r\n            } else {\r\n              history.push(\"/\");\r\n            }\r\n          }\r\n        },\r\n        (e) => {\r\n          console.error(\"Unable to login to the game\", e);\r\n        }\r\n      );\r\n    }\r\n\r\n    req.promise.then(\r\n      (r) => {\r\n        console.log(r);\r\n\r\n        LogIn();\r\n      },\r\n      (e) => {\r\n        if (!e.is_aborted) {\r\n          console.error(\"Unable to activate the game:\", e);\r\n\r\n          LogIn();\r\n        }\r\n      }\r\n    );\r\n\r\n    return () => req.cancel();\r\n  }, [id, history, fromHome, isExternal]);\r\n\r\n  useEffect(() => {\r\n    document.body.style.overflow = balanceOver ? \"hidden\" : \"auto\";\r\n\r\n    return () => {\r\n      document.body.style.overflow = \"auto\";\r\n    };\r\n  }, [balanceOver]);\r\n\r\n  const PickerWrap = ({ dist }) => (\r\n    <div className=\"picker-wrap\">\r\n      {balances.length ? (\r\n        <Picker\r\n          height={120}\r\n          valueGroups={{ [dist]: balanceForm[dist] }}\r\n          optionGroups={{ [dist]: balances }}\r\n          onChange={(key, value) =>\r\n            setBalanceForm({ ...balanceForm, [key]: value })\r\n          }\r\n        />\r\n      ) : null}\r\n    </div>\r\n  );\r\n\r\n  const setAmount = (e) => {\r\n    // console.log(e.target.validity.valid);\r\n\r\n    const amount = e.target.value;\r\n    const percent = +BigNumber((amount / userAuth.data.balance) * 100).toFixed(\r\n      0\r\n    );\r\n\r\n    setBalanceForm((form) => ({ ...form, amount }));\r\n    setSliderPercent(percent);\r\n  };\r\n\r\n  const transfer = (e) => {\r\n    if (!balanceForm.amount || isNaN(+balanceForm.amount)) {\r\n      return void console.warn(\"[transfer] No amount\");\r\n    }\r\n\r\n    const _getMap = (n) => balancesMap[n.split(\": \")[0]] || null;\r\n\r\n    const _from = _getMap(balanceForm.from);\r\n    const _to = _getMap(balanceForm.to);\r\n\r\n    if (_from.game.id === _to.game.id) {\r\n      return void console.warn(\"[transfer] Same game\");\r\n    }\r\n\r\n    if (_from.balance === 0) {\r\n      return void console.warn(\"[transfer] Zero balance\");\r\n    }\r\n\r\n    if (_from.balance < +balanceForm.amount) {\r\n      return void console.warn(\"[transfer] Not enough game balance\");\r\n    }\r\n\r\n    console.info(\r\n      `You're transfering ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}`\r\n    );\r\n\r\n    balanceForm.amount = BigNumber(balanceForm.amount).toFixed(0);\r\n\r\n    setBalanceLoad(true);\r\n\r\n    Service.transfer({\r\n      ...User.read(),\r\n      amount: +balanceForm.amount,\r\n      from: _from.game.id,\r\n      to: _to.game.id,\r\n    }).then(\r\n      (r) => {\r\n        console.info(\r\n          `You have successfully transferred ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}: ${r.info}`\r\n        );\r\n\r\n        setBalanceLoad(false);\r\n\r\n        setBalanceTransferred(true);\r\n      },\r\n      (e) => {\r\n        console.error(e);\r\n\r\n        setBalanceLoad(false);\r\n      }\r\n    );\r\n  };\r\n\r\n  const finishTransfer = () => {\r\n    setOverlayState(false);\r\n\r\n    setBalanceTransferred(false);\r\n\r\n    setBalanceForm((bf) => ({\r\n      ...bf,\r\n      amount: \"\",\r\n    }));\r\n\r\n    setSliderPercent(0);\r\n\r\n    setBalanceUpdateI((i) => i + 1);\r\n\r\n    User.session({\r\n      ...User.read(),\r\n    }).promise.then((r) => setUserAuthFN(1, r.info));\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={cx(\"game-sa\", \"with-loader\", {\r\n        loading: loading,\r\n        \"full-screen\": fullScreen,\r\n      })}\r\n    >\r\n      <button className=\"full-screen-exit\" onClick={() => setFullScreen(false)}>\r\n        {/* <Icon name=\"close-circle-sharp\" /> */}\r\n        <i />\r\n      </button>\r\n      <div className=\"load-spin\"></div>\r\n      <div\r\n        className={cx(\"game-sa-head\", { hidden: fullScreen })}\r\n        style={isExternal ? { display: \"none\" } : {}}\r\n      >\r\n        <div className=\"sa-head-left\">\r\n          <button onClick={goBack}>{/* <Icon name=\"arrow-left\" /> */}</button>\r\n        </div>\r\n        <div className=\"sa-head-middle\">\r\n          <h1>{name}</h1>\r\n        </div>\r\n        <div className=\"sa-head-right\">\r\n          <button\r\n            className=\"balance\"\r\n            onClick={(e) => setOverlayState(true)}\r\n            disabled={!balances.length}\r\n          >\r\n            {/* <Icon name=\"balance\" /> */}\r\n            <i />\r\n          </button>\r\n          <button className=\"refresh\" onClick={refresh}>\r\n            {/* <Icon name=\"refresh\" /> */}\r\n            <i />\r\n          </button>\r\n          <button className=\"full-screen\" onClick={() => setFullScreen(true)}>\r\n            {/* <Icon name=\"full-screen\" /> */}\r\n            <i />\r\n          </button>\r\n        </div>\r\n      </div>\r\n      <div className=\"game-sa-content\">\r\n        {iframe ? (\r\n          <iframe\r\n            key={iframeI}\r\n            title={`IFRAME-N${id}`}\r\n            src={iframe}\r\n            style={{ height: fullScreen ? focHeight : focHeight - 60 }}\r\n          ></iframe>\r\n        ) : null}\r\n      </div>\r\n      <div className={`game-sa-overlay${overlayState ? \" shown\" : \"\"}`}>\r\n        <div className=\"overlay-sublayer\" ref={refClickOut}>\r\n          <div\r\n            className={`overlay-layer with-loader${\r\n              balanceLoad ? \" loading\" : \"\"\r\n            }`}\r\n          >\r\n            <div className=\"load-spin\"></div>\r\n            {balanceTransferred ? (\r\n              <div className=\"form response\">\r\n                <div className=\"form-head not-message\">\r\n                  <h2>转账成功</h2>\r\n                  <button className=\"close\" onClick={finishTransfer}>\r\n                    <Icon name=\"close-circle-sharp\" />\r\n                  </button>\r\n                </div>\r\n                <div className=\"form-body not-message\">\r\n                  {/* <p>转移成功!</p> */}\r\n                  <div className=\"form-submit\">\r\n                    <button onClick={finishTransfer}>确认</button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className=\"form\">\r\n                <div className=\"form-head\">\r\n                  <h2>转账</h2>\r\n                  <button\r\n                    className=\"close\"\r\n                    onClick={(e) => setOverlayState(false)}\r\n                  >\r\n                    <Icon name=\"close-circle-sharp\" />\r\n                  </button>\r\n                </div>\r\n                <div className=\"form-body\">\r\n                  {/*<div className=\"form-field\">\r\n\t\t\t\t\t\t\t\t\t<label>推出</label>\r\n\t\t\t\t\t\t\t\t\t<div className=\"input--wrap with-dot\">\r\n\t\t\t\t\t\t\t\t\t\t<div className={`input-like${balanceForm.from ? ' has-value' : ''}`} onClick={e => setBalanceOver('from')}>{balanceForm.from || '推出'}</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"form-field\">\r\n\t\t\t\t\t\t\t\t\t<label>进入</label>\r\n\t\t\t\t\t\t\t\t\t<div className=\"input--wrap with-dot\">\r\n\t\t\t\t\t\t\t\t\t\t<div className={`input-like${balanceForm.to ? ' has-value' : ''}`} onClick={e => setBalanceOver('to')}>{balanceForm.to || '进入'}</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"form-field\">\r\n\t\t\t\t\t\t\t\t\t<label htmlFor=\"amount\">金额</label>\r\n\t\t\t\t\t\t\t\t\t<div className=\"input--wrap\">\r\n\t\t\t\t\t\t\t\t\t\t<input id=\"amount\" type=\"text\" placeholder=\"金额\" pattern=\"[0-9]*\" onChange={e => setAmount(e)} />\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>*/}\r\n\r\n                  <div className=\"form-body-wrap\">\r\n                    <div className=\"form-field transfer-wrap\">\r\n                      <div className=\"transfer--item\">\r\n                        <p className=\"title\">转出钱包</p>\r\n                        <p className=\"game\">中央钱包</p>\r\n                        <p className=\"balance\">\r\n                          {BigNumber(userAuth.data.balance).toFormat(2)}\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"transfer--item icon\">\r\n                        <Icon name=\"arrow-left\" />\r\n                      </div>\r\n                      <div className=\"transfer--item\">\r\n                        <p className=\"title\">转入钱包</p>\r\n                        <p className=\"game\">{balanceCurrent.name}</p>\r\n                        <p className=\"balance\">\r\n                          {BigNumber(balanceCurrent.balance).toFormat(2)}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-field\">\r\n                      <div className=\"slider-wrap\">\r\n                        <p>0</p>\r\n                        <div className=\"slider-subwrap\">\r\n                          <ReactSlider\r\n                            className=\"slider-picker\"\r\n                            thumbClassName=\"thumb\"\r\n                            trackClassName=\"track\"\r\n                            value={sliderPercent}\r\n                            onChange={(percent) => {\r\n                              const amount = BigNumber(\r\n                                (percent * userAuth.data.balance) / 100\r\n                              ).toFixed(0);\r\n                              setSliderPercent(percent);\r\n                              setBalanceForm((bf) => ({\r\n                                ...bf,\r\n                                amount,\r\n                              }));\r\n                            }}\r\n                          />\r\n                        </div>\r\n                        <p\r\n                          onClick={() => {\r\n                            const amount = BigNumber(\r\n                              userAuth.data.balance\r\n                            ).toFixed(0);\r\n\r\n                            setSliderPercent(100);\r\n                            setBalanceForm((bf) => ({\r\n                              ...bf,\r\n                              amount,\r\n                            }));\r\n                          }}\r\n                        >\r\n                          MAX\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"form-field\">\r\n                      <label htmlFor=\"amount\">金额/转入金额</label>\r\n                      <div className=\"input--wrap\">\r\n                        <input\r\n                          id=\"amount\"\r\n                          type=\"number\"\r\n                          placeholder=\"0.00\"\r\n                          pattern=\"[0-9]*\"\r\n                          value={balanceForm.amount}\r\n                          onChange={(e) => setAmount(e)}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"form-submit\">\r\n                    <button onClick={transfer}>立即转账</button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div\r\n        className={`game-sa-overlay picker-over${balanceOver ? \" shown\" : \"\"}`}\r\n      >\r\n        <div className=\"picker-container\">\r\n          <div className=\"picker-head\">\r\n            <button onClick={(e) => setBalanceOver(null)}>取消</button>\r\n            <p>{balanceOver === \"from\" ? \"推出\" : \"进入\"}</p>\r\n            <button onClick={(e) => setBalanceOver(null)}>确定</button>\r\n          </div>\r\n          {balanceOver ? <PickerWrap dist={balanceOver} /> : null}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withAuth(Game, 1);\r\n"]},"metadata":{},"sourceType":"module"}