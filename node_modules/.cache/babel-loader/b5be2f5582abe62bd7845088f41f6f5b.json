{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar react_1 = require(\"react\");\n\nvar useScrollAnimation_1 = __importDefault(require(\"../hooks/useScrollAnimation\"));\n\nvar setRefs = function setRefs(data) {\n  return function () {\n    return data.reduce(function (result, value) {\n      result[value.id] = react_1.createRef();\n      return result;\n    }, {});\n  };\n};\n\nvar calculatePercentageOfRootWithoutItem = function calculatePercentageOfRootWithoutItem(rootHeight, itemHeight) {\n  return 100 - itemHeight / rootHeight * 100;\n};\n\nvar calculateMarginVertical = function calculateMarginVertical(rootHeight, itemHeight) {\n  return calculatePercentageOfRootWithoutItem(rootHeight, itemHeight) / 2;\n};\n\nvar calculateRootMargin = function calculateRootMargin(rootHeight, itemHeight) {\n  return \"-\".concat(calculateMarginVertical(rootHeight, itemHeight), \"% 0px\");\n};\n\nvar useObserver = function useObserver(data, selectedID, itemHeight, onChange) {\n  var root = react_1.useRef(null);\n  var refs = react_1.useMemo(setRefs(data), [data]);\n  var observer = react_1.useRef(null);\n\n  var _react_1$useState = react_1.useState(selectedID),\n      _react_1$useState2 = _slicedToArray(_react_1$useState, 2),\n      activeID = _react_1$useState2[0],\n      setActiveID = _react_1$useState2[1];\n\n  var onScroll = useScrollAnimation_1.default(root, refs);\n  var handleOnFocus = react_1.useCallback(function (e) {\n    var target = e.target;\n    var id = target.getAttribute(\"data-itemid\");\n    var value = target.getAttribute(\"data-itemvalue\");\n\n    if (!id || !value) {\n      throw new Error(\"Can not found id or value\");\n    }\n\n    onScroll(data, id);\n    setActiveID(id);\n    onChange({\n      id: id,\n      value: value\n    });\n  }, [data, onChange, onScroll]);\n  react_1.useEffect(function () {\n    var observerCallback = function observerCallback(entries) {\n      entries.forEach(function (entry) {\n        if (!entry.isIntersecting) {\n          return;\n        }\n\n        var itemID = entry.target.getAttribute(\"data-itemid\");\n        var itemValue = entry.target.getAttribute(\"data-itemvalue\");\n\n        if (!itemID || !itemValue) {\n          throw new Error(\"Can not found id or value\");\n        }\n\n        onScroll(data, itemID, true);\n        setActiveID(itemID);\n        onChange({\n          id: itemID,\n          value: itemValue\n        });\n      });\n    };\n\n    if (!observer.current && root.current) {\n      observer.current = new IntersectionObserver(observerCallback, {\n        root: root.current,\n        rootMargin: calculateRootMargin(root.current.clientHeight, itemHeight),\n        threshold: [0.3, 0.79]\n      });\n      data.map(function (item) {\n        var elm = refs[item.id].current;\n\n        if (elm && observer.current) {\n          observer.current.observe(elm);\n        }\n      });\n      var firstItem = refs[data[0].id].current;\n      var item = refs[selectedID].current;\n\n      if (firstItem && item) {\n        root.current.scrollTo(0, item.offsetTop - firstItem.offsetTop);\n      }\n    }\n\n    return function () {\n      if (observer.current) {\n        observer.current.disconnect();\n        observer.current = null;\n      }\n    };\n  }, [data, refs, root, itemHeight]); // eslint-disable-line\n\n  return {\n    root: root,\n    refs: refs,\n    activeID: activeID,\n    onFocus: handleOnFocus\n  };\n};\n\nexports.default = useObserver;","map":{"version":3,"sources":["../../src/hooks/useObserver.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = require(\"react\");\nconst useScrollAnimation_1 = __importDefault(require(\"../hooks/useScrollAnimation\"));\nconst setRefs = (data) => {\n    return () => data.reduce((result, value) => {\n        result[value.id] = react_1.createRef();\n        return result;\n    }, {});\n};\nconst calculatePercentageOfRootWithoutItem = (rootHeight, itemHeight) => {\n    return 100 - (itemHeight / rootHeight) * 100;\n};\nconst calculateMarginVertical = (rootHeight, itemHeight) => {\n    return calculatePercentageOfRootWithoutItem(rootHeight, itemHeight) / 2;\n};\nconst calculateRootMargin = (rootHeight, itemHeight) => {\n    return `-${calculateMarginVertical(rootHeight, itemHeight)}% 0px`;\n};\nconst useObserver = (data, selectedID, itemHeight, onChange) => {\n    const root = react_1.useRef(null);\n    const refs = react_1.useMemo(setRefs(data), [data]);\n    const observer = react_1.useRef(null);\n    const [activeID, setActiveID] = react_1.useState(selectedID);\n    const onScroll = useScrollAnimation_1.default(root, refs);\n    const handleOnFocus = react_1.useCallback((e) => {\n        const target = e.target;\n        const id = target.getAttribute(\"data-itemid\");\n        const value = target.getAttribute(\"data-itemvalue\");\n        if (!id || !value) {\n            throw new Error(\"Can not found id or value\");\n        }\n        onScroll(data, id);\n        setActiveID(id);\n        onChange({ id, value });\n    }, [data, onChange, onScroll]);\n    react_1.useEffect(() => {\n        const observerCallback = (entries) => {\n            entries.forEach(entry => {\n                if (!entry.isIntersecting) {\n                    return;\n                }\n                const itemID = entry.target.getAttribute(\"data-itemid\");\n                const itemValue = entry.target.getAttribute(\"data-itemvalue\");\n                if (!itemID || !itemValue) {\n                    throw new Error(\"Can not found id or value\");\n                }\n                onScroll(data, itemID, true);\n                setActiveID(itemID);\n                onChange({ id: itemID, value: itemValue });\n            });\n        };\n        if (!observer.current && root.current) {\n            observer.current = new IntersectionObserver(observerCallback, {\n                root: root.current,\n                rootMargin: calculateRootMargin(root.current.clientHeight, itemHeight),\n                threshold: [0.3, 0.79]\n            });\n            data.map(item => {\n                const elm = refs[item.id].current;\n                if (elm && observer.current) {\n                    observer.current.observe(elm);\n                }\n            });\n            const firstItem = refs[data[0].id].current;\n            const item = refs[selectedID].current;\n            if (firstItem && item) {\n                root.current.scrollTo(0, item.offsetTop - firstItem.offsetTop);\n            }\n        }\n        return () => {\n            if (observer.current) {\n                observer.current.disconnect();\n                observer.current = null;\n            }\n        };\n    }, [data, refs, root, itemHeight]); // eslint-disable-line\n    return {\n        root,\n        refs,\n        activeID,\n        onFocus: handleOnFocus\n    };\n};\nexports.default = useObserver;\n//# sourceMappingURL=useObserver.js.map"]},"metadata":{},"sourceType":"script"}