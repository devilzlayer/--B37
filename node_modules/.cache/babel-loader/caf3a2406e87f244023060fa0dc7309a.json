{"ast":null,"code":"import _objectSpread from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{map}from\"lodash\";import{Service}from\"./\";import Wrap from\"./Wrap\";import\"../../assets/scss/profile/Collection.scss\";var CardItem=function CardItem(props){var label=props.label,value=props.value,className=props.className,onClick=props.onClick;return/*#__PURE__*/React.createElement(\"div\",{className:\"collection-card-item \".concat(className?className:\"\")},/*#__PURE__*/React.createElement(\"div\",{className:\"cl-item collection-card-text\"},label),/*#__PURE__*/React.createElement(\"div\",{className:\"cl-item collection-card-value\"},value?value:\"0.00\"),/*#__PURE__*/React.createElement(\"div\",{className:\"cl-item collection-card-button\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:onClick},\"\\u9886\\u53D6\")));};var Collection=function Collection(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),key=_useState2[0],setKey=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),bonus=_useState4[0],setBonus=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),angpao=_useState6[0],setAngpao=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),level=_useState8[0],setLevel=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),grab=_useState10[0],setGrab=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),yuan=_useState12[0],setYuan=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),gift=_useState14[0],setGift=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),monthly=_useState16[0],setMonthly=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),success=_useState18[0],setSuccess=_useState18[1];var _useState19=useState([1,2,3,4,5,6,7,8,9,10]),_useState20=_slicedToArray(_useState19,2),upgradeBonus=_useState20[0],setUpgradeBonus=_useState20[1];var upgradeData=[\"gid1903\",\"gid1905\",\"gid1909\",\"gid1910\",\"gid1911\",\"gid1912\",\"gid1913\",\"gid1914\",\"gid1915\",\"gid1916\"];useEffect(function(){var response=Service.User.collection(_objectSpread({},Service.User.read()));response.promise.then(function(result){// console.log(result);\nif(result.status===1){setBonus(result.info);setAngpao(result.info.gid1908);}},function(e){console.log(\"Unable to response:\",e);});var responseLvl=Service.Transaction.read(_objectSpread(_objectSpread({},Service.User.read()),{},{type:\"get_vip_level\"}));responseLvl.promise.then(function(r){// console.log(r);\nif(r.status===1){setLevel(r.info.viplevel);}},function(e){});},[]);var receiveBonus=function receiveBonus(recipient){var response=Service.User.receiveBonus(_objectSpread(_objectSpread({},Service.User.read()),{},{id:recipient}));response.promise.then(function(result){console.log(\"Bonus received\",result);setYuan(false);setSuccess(true);setAngpao(bonus.gid1908);var response=Service.User.collection(_objectSpread({},Service.User.read()));response.promise.then(function(result){console.log(result);if(result.status===1){setBonus(result.info);}},function(e){console.log(\"Unable to response:\",e);});},function(e){console.log(\"Unable to response:\",e);});};var onGrab=function onGrab(){setYuan(true);setTimeout(function(){receiveBonus(\"gid1908\");},2000);setTimeout(function(){setGrab(true);setYuan(false);},2500);};var onMonthly=function onMonthly(){if(bonus.gid1906){receiveBonus(\"gid1906\");setMonthly(true);}};var omGift=function omGift(){if(bonus.gid1907){receiveBonus(\"gid1907\");setGift(true);}};return/*#__PURE__*/React.createElement(Wrap,{className:\"profile-collection\",title:\"优惠领取\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab-head-item\"},/*#__PURE__*/React.createElement(\"span\",{onClick:function onClick(){return setKey(0);},className:key==0?\"active\":\"\"},\"\\u62A2\\u7EA2\\u5305\")),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab-head-item\"},/*#__PURE__*/React.createElement(\"span\",{onClick:function onClick(){return setKey(1);},className:key==1?\"active\":\"\"},\"\\u6BCF\\u6708\\u793C\\u91D1\")),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab-head-item\"},/*#__PURE__*/React.createElement(\"span\",{onClick:function onClick(){return setKey(2);},className:key==2?\"active\":\"\"},\"\\u5347\\u7EA7\\u793C\\u91D1\")),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab-head-item\"},/*#__PURE__*/React.createElement(\"span\",{onClick:function onClick(){return setKey(3);},className:key==3?\"active\":\"\"},\"\\u751F\\u65E5\\u793C\\u91D1\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab-col \".concat(key==0?\"active\":\"\")},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-wrap-cont\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-wrapper \"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-icon\"},/*#__PURE__*/React.createElement(\"i\",{className:\"grab\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box col-pao-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-pao-box-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-pao-caption\"},\"\\u62A2\\u5230\\u7EA2\\u5305\\u91D1\\u989D\"),grab&&/*#__PURE__*/React.createElement(\"div\",{className:\"col-pao-value\"},/*#__PURE__*/React.createElement(\"span\",null,angpao),\" RMB\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-pao-box-clip\"}),!grab&&!yuan&&/*#__PURE__*/React.createElement(\"div\",{className:\"col-pao-box-chip\",onClick:onGrab},\"\\u62A2\\u7EA2\\u5305\"),yuan&&!success&&/*#__PURE__*/React.createElement(\"div\",{className:\"col-pao-box-yuan\"})))))),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab-col \".concat(key==1?\"active\":\"\")},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-wrap-cont\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-icon\"},/*#__PURE__*/React.createElement(\"i\",{className:\"monthly\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-title\"},\"\\u6BCF\\u6708\\u793C\\u91D1\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-span\"},\"\\u60A8\\u83B7\\u5F97 \",/*#__PURE__*/React.createElement(\"span\",null,bonus.gid1906,\" \\u5143\\u7EA2\\u5305.\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-action \".concat(monthly||bonus.gid1906==0?\"redeemed\":\"\")},/*#__PURE__*/React.createElement(\"span\",{onClick:onMonthly},\"\\u7533\\u8BF7\"))))))),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab-col \".concat(key==2?\"active\":\"\")},upgradeBonus&&map(upgradeBonus,function(obj,i){var identifier=upgradeData[i];return/*#__PURE__*/React.createElement(CardItem,{key:i,label:\"VIP\".concat(obj,\"\\u5347\\u7EA7\\u793C\\u91D1\"),value:bonus[identifier],className:bonus[identifier]!==\"0.00\"?\"active\":\"\",onClick:function onClick(){return receiveBonus(identifier);}});})),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-desktop-tab-col \".concat(key==3?\"active\":\"\")},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-wrap-cont\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-icon\"},/*#__PURE__*/React.createElement(\"i\",{className:\"gift\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-title\"},\"\\u751F\\u65E5\\u5FEB\\u4E50\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-span\"},\"\\u60A8\\u83B7\\u5F97 \",/*#__PURE__*/React.createElement(\"span\",null,bonus.gid1907,\" \\u5143\\u7EA2\\u5305.\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-bonus-box-action \".concat(gift||bonus.gid1907==0?\"redeemed\":\"\")},/*#__PURE__*/React.createElement(\"span\",{onClick:omGift},\"\\u7533\\u8BF7\"))))))))));};export default Collection;","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/ubet-project (1)/src/view/profile/Collection.js"],"names":["React","useEffect","useState","map","Service","Wrap","CardItem","props","label","value","className","onClick","Collection","key","setKey","bonus","setBonus","angpao","setAngpao","level","setLevel","grab","setGrab","yuan","setYuan","gift","setGift","monthly","setMonthly","success","setSuccess","upgradeBonus","setUpgradeBonus","upgradeData","response","User","collection","read","promise","then","result","status","info","gid1908","e","console","log","responseLvl","Transaction","type","r","viplevel","receiveBonus","recipient","id","onGrab","setTimeout","onMonthly","gid1906","omGift","gid1907","obj","i","identifier"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { map } from \"lodash\";\r\n\r\nimport { Service } from \"./\";\r\n\r\nimport Wrap from \"./Wrap\";\r\n\r\nimport \"../../assets/scss/profile/Collection.scss\";\r\n\r\nconst CardItem = (props) => {\r\n  const { label, value, className, onClick } = props;\r\n  return (\r\n    <div className={`collection-card-item ${className ? className : \"\"}`}>\r\n      <div className=\"cl-item collection-card-text\">{label}</div>\r\n      <div className=\"cl-item collection-card-value\">\r\n        {value ? value : \"0.00\"}\r\n      </div>\r\n      <div className=\"cl-item collection-card-button\">\r\n        <button type=\"button\" onClick={onClick}>\r\n          领取\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Collection = () => {\r\n  const [key, setKey] = useState(0);\r\n  const [bonus, setBonus] = useState([]);\r\n  const [angpao, setAngpao] = useState(null);\r\n  const [level, setLevel] = useState(0);\r\n\r\n  const [grab, setGrab] = useState(false);\r\n  const [yuan, setYuan] = useState(false);\r\n  const [gift, setGift] = useState(false);\r\n  const [monthly, setMonthly] = useState(false);\r\n  const [success, setSuccess] = useState(false);\r\n\r\n  const [upgradeBonus, setUpgradeBonus] = useState([\r\n    1,\r\n    2,\r\n    3,\r\n    4,\r\n    5,\r\n    6,\r\n    7,\r\n    8,\r\n    9,\r\n    10,\r\n  ]);\r\n\r\n  const upgradeData = [\r\n    \"gid1903\",\r\n    \"gid1905\",\r\n    \"gid1909\",\r\n    \"gid1910\",\r\n    \"gid1911\",\r\n    \"gid1912\",\r\n    \"gid1913\",\r\n    \"gid1914\",\r\n    \"gid1915\",\r\n    \"gid1916\",\r\n  ];\r\n\r\n  useEffect(() => {\r\n    const response = Service.User.collection({\r\n      ...Service.User.read(),\r\n    });\r\n\r\n    response.promise.then(\r\n      (result) => {\r\n        // console.log(result);\r\n        if (result.status === 1) {\r\n          setBonus(result.info);\r\n          setAngpao(result.info.gid1908);\r\n        }\r\n      },\r\n      (e) => {\r\n        console.log(\"Unable to response:\", e);\r\n      }\r\n    );\r\n\r\n    const responseLvl = Service.Transaction.read({\r\n      ...Service.User.read(),\r\n      type: \"get_vip_level\",\r\n    });\r\n\r\n    responseLvl.promise.then(\r\n      (r) => {\r\n        // console.log(r);\r\n        if (r.status === 1) {\r\n          setLevel(r.info.viplevel);\r\n        }\r\n      },\r\n      (e) => {}\r\n    );\r\n  }, []);\r\n\r\n  const receiveBonus = (recipient) => {\r\n    const response = Service.User.receiveBonus({\r\n      ...Service.User.read(),\r\n      id: recipient,\r\n    });\r\n\r\n    response.promise.then(\r\n      (result) => {\r\n        console.log(\"Bonus received\", result);\r\n\r\n        setYuan(false);\r\n        setSuccess(true);\r\n        setAngpao(bonus.gid1908);\r\n\r\n        const response = Service.User.collection({\r\n          ...Service.User.read(),\r\n        });\r\n\r\n        response.promise.then(\r\n          (result) => {\r\n            console.log(result);\r\n            if (result.status === 1) {\r\n              setBonus(result.info);\r\n            }\r\n          },\r\n          (e) => {\r\n            console.log(\"Unable to response:\", e);\r\n          }\r\n        );\r\n      },\r\n      (e) => {\r\n        console.log(\"Unable to response:\", e);\r\n      }\r\n    );\r\n  };\r\n\r\n  const onGrab = () => {\r\n    setYuan(true);\r\n    setTimeout(() => {\r\n      receiveBonus(\"gid1908\");\r\n    }, 2000);\r\n    setTimeout(() => {\r\n      setGrab(true);\r\n      setYuan(false);\r\n    }, 2500);\r\n  };\r\n\r\n  const onMonthly = () => {\r\n    if (bonus.gid1906) {\r\n      receiveBonus(\"gid1906\");\r\n      setMonthly(true);\r\n    }\r\n  };\r\n\r\n  const omGift = () => {\r\n    if (bonus.gid1907) {\r\n      receiveBonus(\"gid1907\");\r\n      setGift(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Wrap className=\"profile-collection\" title={\"优惠领取\"}>\r\n      <div className=\"profile-desktop-tab\">\r\n        <div className=\"profile-desktop-tab-header\">\r\n          <div className={`profile-desktop-tab-head-item`}>\r\n            <span\r\n              onClick={() => setKey(0)}\r\n              className={key == 0 ? \"active\" : \"\"}\r\n            >\r\n              抢红包\r\n            </span>\r\n          </div>\r\n          <div className={`profile-desktop-tab-head-item`}>\r\n            <span\r\n              onClick={() => setKey(1)}\r\n              className={key == 1 ? \"active\" : \"\"}\r\n            >\r\n              每月礼金\r\n            </span>\r\n          </div>\r\n          <div className={`profile-desktop-tab-head-item`}>\r\n            <span\r\n              onClick={() => setKey(2)}\r\n              className={key == 2 ? \"active\" : \"\"}\r\n            >\r\n              升级礼金\r\n            </span>\r\n          </div>\r\n          <div className={`profile-desktop-tab-head-item`}>\r\n            <span\r\n              onClick={() => setKey(3)}\r\n              className={key == 3 ? \"active\" : \"\"}\r\n            >\r\n              生日礼金\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div className=\"profile-desktop-tab-body\">\r\n          <div\r\n            className={`profile-desktop-tab-col ${key == 0 ? \"active\" : \"\"}`}\r\n          >\r\n            <div className=\"col-bonus-box-wrap\">\r\n              <div className=\"col-bonus-box-wrap-cont\">\r\n                <div className=\"col-bonus-box-wrapper \">\r\n                  <div className=\"col-bonus-box-icon\">\r\n                    <i className=\"grab\"></i>\r\n                  </div>\r\n                  <div className=\"col-bonus-box col-pao-box\">\r\n                    <div className=\"col-pao-box-body\">\r\n                      <div className=\"col-pao-caption\">抢到红包金额</div>\r\n                      {grab && (\r\n                        <div className=\"col-pao-value\">\r\n                          <span>{angpao}</span> RMB\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"col-pao-box-clip\"></div>\r\n                    {!grab && !yuan && (\r\n                      <div className=\"col-pao-box-chip\" onClick={onGrab}>\r\n                        抢红包\r\n                      </div>\r\n                    )}\r\n                    {yuan && !success && <div className=\"col-pao-box-yuan\" />}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div\r\n            className={`profile-desktop-tab-col ${key == 1 ? \"active\" : \"\"}`}\r\n          >\r\n            <div className=\"col-bonus-box-wrap\">\r\n              <div className=\"col-bonus-box-wrap-cont\">\r\n                <div className=\"col-bonus-box-wrapper\">\r\n                  <div className=\"col-bonus-box-icon\">\r\n                    <i className=\"monthly\"></i>\r\n                  </div>\r\n                  <div className=\"col-bonus-box\">\r\n                    <div className=\"col-bonus-box-title\">每月礼金</div>\r\n                    <div className=\"col-bonus-box-span\">\r\n                      您获得 <span>{bonus.gid1906} 元红包.</span>\r\n                    </div>\r\n                    <div\r\n                      className={`col-bonus-box-action ${\r\n                        monthly || bonus.gid1906 == 0 ? \"redeemed\" : \"\"\r\n                      }`}\r\n                    >\r\n                      {/* <i /> */}\r\n                      <span onClick={onMonthly}>申请</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            className={`profile-desktop-tab-col ${key == 2 ? \"active\" : \"\"}`}\r\n          >\r\n            {upgradeBonus &&\r\n              map(upgradeBonus, (obj, i) => {\r\n                const identifier = upgradeData[i];\r\n                return (\r\n                  <CardItem\r\n                    key={i}\r\n                    label={`VIP${obj}升级礼金`}\r\n                    value={bonus[identifier]}\r\n                    className={bonus[identifier] !== \"0.00\" ? \"active\" : \"\"}\r\n                    onClick={() => receiveBonus(identifier)}\r\n                  />\r\n                );\r\n              })}\r\n          </div>\r\n          <div\r\n            className={`profile-desktop-tab-col ${key == 3 ? \"active\" : \"\"}`}\r\n          >\r\n            <div className=\"col-bonus-box-wrap\">\r\n              <div className=\"col-bonus-box-wrap-cont\">\r\n                <div className=\"col-bonus-box-wrapper\">\r\n                  <div className=\"col-bonus-box-icon\">\r\n                    <i className=\"gift\"></i>\r\n                  </div>\r\n                  <div className=\"col-bonus-box\">\r\n                    <div className=\"col-bonus-box-title\">生日快乐</div>\r\n                    <div className=\"col-bonus-box-span\">\r\n                      您获得 <span>{bonus.gid1907} 元红包.</span>\r\n                    </div>\r\n                    <div\r\n                      className={`col-bonus-box-action ${\r\n                        gift || bonus.gid1907 == 0 ? \"redeemed\" : \"\"\r\n                      }`}\r\n                    >\r\n                      {/* <i /> */}\r\n                      <span onClick={omGift}>申请</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default Collection;\r\n"]},"metadata":{},"sourceType":"module"}