{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Documents/New PWA/GIT/src/pwa/view/profile/Transfer.js\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport Picker from \"react-mobile-picker\";\nimport cx from \"classnames\";\nimport BigNumber from \"bignumber.js\";\nimport { map, findIndex, isNumber, toSafeInteger } from 'lodash';\nimport WheelPicker from 'react-simple-wheel-picker';\nimport { Wrap } from \"./\";\nimport { Icon } from \"../../../component/\";\nimport { UIAlertSA } from \"../../component/\";\nimport { User, Game } from \"../../../service/\";\nimport { withAuth } from \"../../util\";\nimport Wheel from './transfer/wheel';\n\nconst Transfer = () => {\n  const {\n    userAuth,\n    setUserAuthFN\n  } = useContext(User.Context);\n  const [balances, setBalances] = useState({\n    from: [],\n    to: []\n  });\n  const [balancesFill, setBalancesFill] = useState({\n    wallet: [],\n    games: []\n  });\n  const [message, setMessage] = useState({});\n  const [balancesRaw, setBalancesRaw] = useState([]);\n  const [balanceTransferred, setBalanceTransferred] = useState(false);\n  const [balanceLoad, setBalanceLoad] = useState(false);\n  const [balanceUpdateI, setBalanceUpdateI] = useState(0);\n  const [balancesMap, setBalancesMap] = useState({});\n  const [balanceOver, setBalanceOver] = useState(null);\n  const [balanceForm, setBalanceForm] = useState({\n    from: null,\n    to: null,\n    amount: \"\"\n  });\n  const [balanceTime, setBalanceTime] = useState(false);\n  useEffect(() => {\n    setBalances({\n      from: [],\n      to: []\n    });\n    setBalancesMap({});\n    setBalancesFill({\n      wallet: [],\n      games: []\n    });\n    Game.balances({ ...User.read()\n    }).then(_balances => {\n      setBalancesRaw(_balances.filter(b => !b.error)); // const __balances = _balances.map(b => `${b.game.name}: ${b.balance} ¥`);\n      // \t\t\t__balances.unshift(`中央钱包: ${userAuth.data.balance} ¥`);\n\n      const __balances = _balances.filter(b => !b.error).map(b => `${b.game.name}`);\n\n      __balances.unshift(`中心钱包`);\n\n      const _bFillWallet = [`中心钱包`];\n\n      const _bFillGames = _balances.filter(b => !b.error).map(b => b.game.name);\n\n      setBalancesFill({\n        wallet: _bFillWallet,\n        games: _bFillGames\n      });\n      setBalanceForm(balanceForm => ({ ...balanceForm,\n        from: __balances[0],\n        to: __balances[1]\n      }));\n      setBalances({\n        from: __balances,\n        // to: __balances,\n        to: _bFillGames\n      }); // console.log(_balances )\n      // console.log(__balances )\n      // console.log(_bFillGames )\n\n      const __balancesMap = {};\n\n      _balances.filter(b => !b.error).forEach(b => {\n        __balancesMap[b.game.name] = b;\n      });\n\n      __balancesMap[\"中心钱包\"] = {\n        game: {\n          id: 0,\n          name: \"wallet\"\n        },\n        wallet: true,\n        balance: +userAuth.data.balance\n      };\n      setBalancesMap(__balancesMap);\n    });\n  }, [balanceUpdateI, userAuth.data.balance]);\n  useEffect(() => {\n    User.session({ ...User.read()\n    }).promise.then(r => setUserAuthFN(1, r.info));\n    setBalanceForm(bf => ({ ...bf,\n      amount: \"\"\n    })); // eslint-disable-next-line\n  }, [balanceUpdateI]);\n  const AmountVariants = [100, 500, 1000, 2000, 5000]; // useEffect(() => { \n  //     // console.log(balances)\n  //     Game.activateListV1({\n  //       ...User.read(),\n  //     }).promise.then((r) =>{\n  //       // console.log(r)\n  //     })\n  // },[balances])\n\n  const onSetWheelValSelect = dist => {\n    const thisWrap = document.querySelector(\".wheelwrap ul\"); // console.log(thisWrap.childNodes)\n\n    let value;\n    map(thisWrap.childNodes, obj => {\n      if (obj.ariaSelected == \"true\") {\n        value = obj.ariaLabel;\n      } // console.log( obj.ariaLabel , obj.ariaSelected)\n\n    }); // console.log(value)\n    // return false;\n\n    if (dist === \"from\") {\n      const _d = balancesMap[value].wallet ? \"games\" : \"wallet\";\n\n      setBalances(b => ({ ...b,\n        to: balancesFill[_d]\n      }));\n      setBalanceForm(bf => ({ ...bf,\n        to: balancesFill[_d][0]\n      }));\n    }\n\n    setBalanceForm(bf => ({ ...bf,\n      [dist]: value\n    }));\n    setBalanceOver(null);\n  };\n\n  const PickerWrap = ({\n    dist\n  }) => {\n    const selectedBal = findIndex(balances[dist], obj => obj === balanceForm[dist]);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"picker-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 13\n      }\n    }, balances[dist].length && /*#__PURE__*/React.createElement(Wheel, {\n      options: balances[dist],\n      selected: selectedBal,\n      onChange: value => {\n        // console.log(value)\n        if (dist === \"from\") {\n          const _d = balancesMap[value].wallet ? \"games\" : \"wallet\";\n\n          setBalances(b => ({ ...b,\n            to: balancesFill[_d]\n          }));\n          setBalanceForm(bf => ({ ...bf,\n            to: balancesFill[_d][0]\n          }));\n        }\n\n        setBalanceForm(bf => ({ ...bf,\n          [dist]: value\n        }));\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 17\n      }\n    }));\n  };\n\n  const swap = () => {\n    const [to, from] = [balanceForm.from, balanceForm.to];\n\n    const _d1 = balancesMap[from].wallet ? \"games\" : \"wallet\";\n\n    const _d2 = balancesMap[to].wallet ? \"games\" : \"wallet\";\n\n    setBalances(b => ({ ...b,\n      to: balancesFill[_d1],\n      from: balancesFill[_d2]\n    }));\n    setBalanceForm(bf => ({ ...bf,\n      to,\n      from\n    }));\n  };\n\n  const setAmount = e => {\n    const amount = e.target ? e.target.value : e;\n    setBalanceForm(form => ({ ...form,\n      amount\n    }));\n  };\n\n  const setMax = () => {\n    const _game = balancesMap[balanceForm.from];\n    let _max = _game.balance;\n\n    if (_game.wallet) {\n      _max = userAuth.data.balance;\n    }\n\n    setAmount(Math.floor(_max));\n  };\n\n  const onlyNumbers = e => {\n    const {\n      value\n    } = e.currentTarget;\n    let regexp = /^[0-9\\b]+$/;\n\n    if (!value || regexp.test(value)) {\n      setAmount(value);\n    }\n  };\n\n  const transfer = e => {\n    if (!balanceForm.amount || isNaN(+balanceForm.amount)) {\n      setMessage({\n        title: '系统提示',\n        message: '没有金额'\n      });\n      setBalanceTransferred(true);\n      return void console.warn(\"[transfer] No amount\");\n    }\n\n    const _getMap = n => balancesMap[n.split(\": \")[0]] || null;\n\n    const _from = _getMap(balanceForm.from);\n\n    const _to = _getMap(balanceForm.to);\n\n    if (_from.game.id === _to.game.id) {\n      setMessage({\n        title: '系统提示',\n        message: '同一个游戏'\n      });\n      setBalanceTransferred(true);\n      return void console.warn(\"[transfer] Same game\");\n    }\n\n    if (_from.balance === 0) {\n      setMessage({\n        title: '系统提示',\n        message: '零余额'\n      });\n      setBalanceTransferred(true);\n      return void console.warn(\"[transfer] Zero balance\");\n    }\n\n    if (_from.balance < +balanceForm.amount) {\n      setMessage({\n        title: '系统提示',\n        message: '余额不足'\n      });\n      setBalanceTransferred(true);\n      return void console.warn(\"[transfer] Not enough game balance\");\n    }\n\n    console.info(`You're transfering ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}`);\n    setBalanceLoad(true);\n    Game.transfer({ ...User.read(),\n      amount: +balanceForm.amount,\n      from: _from.game.id,\n      to: _to.game.id\n    }).then(r => {\n      console.info(`You have successfully transferred ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}: ${r.info}`);\n      setMessage({\n        title: '转账成功',\n        valid: true\n      });\n      setBalanceLoad(false);\n      setBalanceTransferred(true);\n    }, e => {\n      console.error(e);\n      setMessage({\n        title: '系统提示',\n        message: e\n      });\n      setBalanceTransferred(true);\n      setBalanceLoad(false);\n    });\n  };\n\n  const wallet = _e => {\n    setBalanceTime(true);\n    setBalanceLoad(true);\n    Game.transferToWallet().promise.then(r => {\n      setBalanceLoad(false);\n      setBalanceTransferred(true);\n    }, e => {\n      console.warn(e);\n      setBalanceLoad(false);\n    });\n    setTimeout(() => {\n      setBalanceTime(false);\n    }, 10000);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Wrap, {\n    className: \"profile-transfer\",\n    name: \"\\u8F6C\\u8D26\",\n    isLoading: !balancesRaw.length || balanceLoad,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"fields\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field user-balance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"user-balance-wrap wallet\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"user-balance-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 17\n    }\n  }), \" \\u4E2D\\u5FC3\\u94B1\\u5305\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"user-balance-amount\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 15\n    }\n  }, BigNumber(userAuth.data.balance).toFormat(2))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"user-balance-wrap hr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"user-balance-wrap refresh\",\n    onClick: !balanceLoad && !balanceTime ? wallet : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"user-balance-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 15\n    }\n  }, \"\\u4E00\\u952E\\u56DE\\u6536\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field-section\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 437,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field balances-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 13\n    }\n  }, balancesRaw.map((balance, i) => /*#__PURE__*/React.createElement(\"div\", {\n    key: i,\n    className: \"balances-list--item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 440,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"game-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 19\n    }\n  }, balance.game.name), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"game-balance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 19\n    }\n  }, BigNumber(balance.balance).toFormat(2)))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field-section\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 452,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field--doubler\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 453,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 454,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 455,\n      columnNumber: 17\n    }\n  }, \"\\u63A8\\u51FA\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input--wrap with-dot\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(\"input-like\", {\n      \"has-value\": balanceForm.from\n    }),\n    onClick: e => setBalanceOver(\"from\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 19\n    }\n  }, balanceForm.from || \"推出\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field-swap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => swap(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 468,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 473,\n      columnNumber: 17\n    }\n  }, \"\\u8FDB\\u5165\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input--wrap with-dot\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 474,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(\"input-like\", {\n      \"has-value\": balanceForm.to\n    }),\n    onClick: e => setBalanceOver(\"to\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 475,\n      columnNumber: 19\n    }\n  }, balanceForm.to || \"进入\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field amount-variants\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 486,\n      columnNumber: 13\n    }\n  }, AmountVariants.map((amount, i) => /*#__PURE__*/React.createElement(\"button\", {\n    key: i,\n    className: cx(\"amount-variant\", {\n      disabled: amount > userAuth.data.balance\n    }),\n    onClick: () => setAmount(amount),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 488,\n      columnNumber: 17\n    }\n  }, amount))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field with-max\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 499,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"amount-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input--wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 502,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 503,\n      columnNumber: 19\n    }\n  }, \"\\uFFE5\"), /*#__PURE__*/React.createElement(\"input\", {\n    id: \"amount\",\n    type: \"text\",\n    placeholder: \"\\u91D1\\u989D\",\n    className: cx({\n      \"has-value\": balanceForm.amount\n    }),\n    value: balanceForm.amount,\n    onChange: e => onlyNumbers(e) // onKeyDown={(e) => onlyNumbers(e)}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 504,\n      columnNumber: 19\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"amount-max-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 516,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: cx({\n      disabled: !balancesMap[balanceForm.from] || !balancesMap[balanceForm.from].balance\n    }),\n    onClick: () => setMax(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 517,\n      columnNumber: 17\n    }\n  }, \"\\u6700\\u5927\\u91D1\\u989D\"))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 532,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"button-stylized\",\n    onClick: transfer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 533,\n      columnNumber: 11\n    }\n  }, \"\\u7ACB\\u5373\\u8F6C\\u8D26\")), /*#__PURE__*/React.createElement(UIAlertSA, {\n    onClose: () => null,\n    shown: balanceOver,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 538,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `game-sa-overlay picker-over`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 539,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 540,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 541,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 542,\n      columnNumber: 17\n    }\n  }, balanceOver === \"from\" ? \"推出\" : \"进入\")), balanceOver ? /*#__PURE__*/React.createElement(PickerWrap, {\n    dist: balanceOver,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 544,\n      columnNumber: 30\n    }\n  }) : null), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 547,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: e => setBalanceOver(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 548,\n      columnNumber: 15\n    }\n  }, \"\\u53D6\\u6D88\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"active\",\n    onClick: e => onSetWheelValSelect(balanceOver),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 549,\n      columnNumber: 15\n    }\n  }, \"\\u786E\\u5B9A\")))), /*#__PURE__*/React.createElement(UIAlertSA, {\n    onClose: () => null,\n    shown: balanceTransferred,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 556,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `game-sa-overlay`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 557,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"overlay-layer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 558,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form response\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 559,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 560,\n      columnNumber: 17\n    }\n  }, message.valid && /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 561,\n      columnNumber: 35\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 562,\n      columnNumber: 17\n    }\n  }, message.title)), message.message && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"game-transfer-p\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 564,\n      columnNumber: 37\n    }\n  }, message.message), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 565,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => {\n      setBalanceTransferred(false);\n      setBalanceUpdateI(i => i + 1);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 566,\n      columnNumber: 19\n    }\n  }, \"\\u786E\\u8BA4\"))))))));\n};\n\nexport default withAuth(Transfer, 1);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/pwa/view/profile/Transfer.js"],"names":["React","useEffect","useState","useContext","Picker","cx","BigNumber","map","findIndex","isNumber","toSafeInteger","WheelPicker","Wrap","Icon","UIAlertSA","User","Game","withAuth","Wheel","Transfer","userAuth","setUserAuthFN","Context","balances","setBalances","from","to","balancesFill","setBalancesFill","wallet","games","message","setMessage","balancesRaw","setBalancesRaw","balanceTransferred","setBalanceTransferred","balanceLoad","setBalanceLoad","balanceUpdateI","setBalanceUpdateI","balancesMap","setBalancesMap","balanceOver","setBalanceOver","balanceForm","setBalanceForm","amount","balanceTime","setBalanceTime","read","then","_balances","filter","b","error","__balances","game","name","unshift","_bFillWallet","_bFillGames","__balancesMap","forEach","id","balance","data","session","promise","r","info","bf","AmountVariants","onSetWheelValSelect","dist","thisWrap","document","querySelector","value","childNodes","obj","ariaSelected","ariaLabel","_d","PickerWrap","selectedBal","length","swap","_d1","_d2","setAmount","e","target","form","setMax","_game","_max","Math","floor","onlyNumbers","currentTarget","regexp","test","transfer","isNaN","title","console","warn","_getMap","n","split","_from","_to","valid","_e","transferToWallet","setTimeout","toFormat","i","disabled"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\r\nimport Picker from \"react-mobile-picker\";\r\nimport cx from \"classnames\";\r\nimport BigNumber from \"bignumber.js\";\r\nimport{ map , findIndex , isNumber, toSafeInteger } from 'lodash'\r\nimport WheelPicker from 'react-simple-wheel-picker';\r\n\r\nimport { Wrap } from \"./\";\r\nimport { Icon } from \"../../../component/\";\r\nimport { UIAlertSA } from \"../../component/\";\r\nimport { User, Game } from \"../../../service/\";\r\nimport { withAuth } from \"../../util\";\r\n\r\nimport Wheel from './transfer/wheel'\r\n\r\nconst Transfer = () => {\r\n  const { userAuth, setUserAuthFN } = useContext(User.Context);\r\n\r\n  const [balances, setBalances] = useState({\r\n    from: [],\r\n    to: [],\r\n  });\r\n\r\n  const [balancesFill, setBalancesFill] = useState({\r\n    wallet: [],\r\n    games: [],\r\n  });\r\n\r\n  const [message , setMessage] = useState({});\r\n\r\n  const [balancesRaw, setBalancesRaw] = useState([]);\r\n\r\n  const [balanceTransferred, setBalanceTransferred] = useState(false);\r\n  const [balanceLoad, setBalanceLoad] = useState(false);\r\n  const [balanceUpdateI, setBalanceUpdateI] = useState(0);\r\n  const [balancesMap, setBalancesMap] = useState({});\r\n  const [balanceOver, setBalanceOver] = useState(null);\r\n  const [balanceForm, setBalanceForm] = useState({\r\n    from: null,\r\n    to: null,\r\n    amount: \"\",\r\n  });\r\n  const [balanceTime, setBalanceTime] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setBalances({\r\n      from: [],\r\n      to: [],\r\n    });\r\n\r\n    setBalancesMap({});\r\n\r\n    setBalancesFill({\r\n      wallet: [],\r\n      games: [],\r\n    });\r\n\r\n    Game.balances({\r\n      ...User.read(),\r\n    }).then((_balances) => {\r\n      setBalancesRaw(_balances.filter((b) => !b.error));\r\n\r\n      // const __balances = _balances.map(b => `${b.game.name}: ${b.balance} ¥`);\r\n      // \t\t\t__balances.unshift(`中央钱包: ${userAuth.data.balance} ¥`);\r\n      const __balances = _balances\r\n        .filter((b) => !b.error)\r\n        .map((b) => `${b.game.name}`);\r\n      __balances.unshift(`中心钱包`);\r\n\r\n      const _bFillWallet = [`中心钱包`];\r\n      const _bFillGames = _balances\r\n        .filter((b) => !b.error)\r\n        .map((b) => b.game.name);\r\n\r\n      setBalancesFill({\r\n        wallet: _bFillWallet,\r\n        games: _bFillGames,\r\n      });\r\n\r\n      setBalanceForm((balanceForm) => ({\r\n        ...balanceForm,\r\n        from: __balances[0],\r\n        to: __balances[1],\r\n      }));\r\n\r\n      setBalances({\r\n        from: __balances,\r\n        // to: __balances,\r\n        to: _bFillGames,\r\n      });\r\n\r\n      // console.log(_balances )\r\n      // console.log(__balances )\r\n      // console.log(_bFillGames )\r\n\r\n      const __balancesMap = {};\r\n\r\n      _balances\r\n        .filter((b) => !b.error)\r\n        .forEach((b) => {\r\n          __balancesMap[b.game.name] = b;\r\n        });\r\n\r\n      __balancesMap[\"中心钱包\"] = {\r\n        game: {\r\n          id: 0,\r\n          name: \"wallet\",\r\n        },\r\n        wallet: true,\r\n        balance: +userAuth.data.balance,\r\n      };\r\n\r\n      setBalancesMap(__balancesMap);\r\n    });\r\n  }, [balanceUpdateI, userAuth.data.balance]);\r\n\r\n  useEffect(() => {\r\n    User.session({\r\n      ...User.read(),\r\n    }).promise.then((r) => setUserAuthFN(1, r.info));\r\n\r\n    setBalanceForm((bf) => ({\r\n      ...bf,\r\n      amount: \"\",\r\n    }));\r\n\r\n    // eslint-disable-next-line\r\n  }, [balanceUpdateI]);\r\n\r\n  const AmountVariants = [100, 500, 1000, 2000, 5000];\r\n\r\n\r\n  // useEffect(() => { \r\n  //     // console.log(balances)\r\n  //     Game.activateListV1({\r\n  //       ...User.read(),\r\n  //     }).promise.then((r) =>{\r\n  //       // console.log(r)\r\n  //     })\r\n  // },[balances])\r\n\r\n  const onSetWheelValSelect = (dist) =>{\r\n\r\n    const thisWrap = document.querySelector(\".wheelwrap ul\");\r\n    // console.log(thisWrap.childNodes)\r\n    let value \r\n    map( thisWrap.childNodes , obj =>{\r\n      if(obj.ariaSelected == \"true\"){\r\n        value = obj.ariaLabel\r\n      }\r\n      // console.log( obj.ariaLabel , obj.ariaSelected)\r\n    })\r\n\r\n    // console.log(value)\r\n    // return false;\r\n\r\n    if (dist === \"from\") {\r\n      const _d = balancesMap[value].wallet ? \"games\" : \"wallet\";\r\n\r\n      setBalances((b) => ({\r\n        ...b,\r\n        to: balancesFill[_d],\r\n      }));\r\n\r\n      setBalanceForm((bf) => ({\r\n        ...bf,\r\n        to: balancesFill[_d][0],\r\n      }));\r\n    }\r\n\r\n    setBalanceForm((bf) => ({\r\n      ...bf,\r\n      [dist]: value,\r\n    }));\r\n\r\n    setBalanceOver(null)\r\n  }\r\n\r\n\r\n  const PickerWrap = ({ dist }) => {\r\n    \r\n    const selectedBal = findIndex(balances[dist] , obj => obj === balanceForm[dist])\r\n\r\n    return  <div className=\"picker-wrap\">\r\n              {\r\n                balances[dist].length  &&\r\n                <Wheel \r\n                  options={balances[dist]}\r\n                  selected={selectedBal}\r\n                  onChange={(value) => {\r\n                    // console.log(value)\r\n                    if (dist === \"from\") {\r\n                      const _d = balancesMap[value].wallet ? \"games\" : \"wallet\";\r\n\r\n                      setBalances((b) => ({\r\n                        ...b,\r\n                        to: balancesFill[_d],\r\n                      }));\r\n\r\n                      setBalanceForm((bf) => ({\r\n                        ...bf,\r\n                        to: balancesFill[_d][0],\r\n                      }));\r\n                    }\r\n\r\n                    setBalanceForm((bf) => ({\r\n                      ...bf,\r\n                      [dist]: value,\r\n                    }));\r\n\r\n                  }}\r\n                />\r\n\r\n              }\r\n\r\n\r\n              {/* {balances[dist].length ? (\r\n                <Picker\r\n                  height={180}\r\n                  valueGroups={{ [dist]: balanceForm[dist] }}\r\n                  optionGroups={{ [dist]: balances[dist] }}\r\n                  onChange={(key, value) => {\r\n                    if (dist === \"from\") {\r\n                      const _d = balancesMap[value].wallet ? \"games\" : \"wallet\";\r\n\r\n                      setBalances((b) => ({\r\n                        ...b,\r\n                        to: balancesFill[_d],\r\n                      }));\r\n\r\n                      setBalanceForm((bf) => ({\r\n                        ...bf,\r\n                        to: balancesFill[_d][0],\r\n                      }));\r\n                    }\r\n\r\n                    setBalanceForm((bf) => ({\r\n                      ...bf,\r\n                      [key]: value,\r\n                    }));\r\n                  }}\r\n                />\r\n              ) : null} */}\r\n            </div>\r\n  }\r\n    \r\n  \r\n\r\n  const swap = () => {\r\n    const [to, from] = [balanceForm.from, balanceForm.to];\r\n\r\n    const _d1 = balancesMap[from].wallet ? \"games\" : \"wallet\";\r\n    const _d2 = balancesMap[to].wallet ? \"games\" : \"wallet\";\r\n\r\n    setBalances((b) => ({\r\n      ...b,\r\n      to: balancesFill[_d1],\r\n      from: balancesFill[_d2],\r\n    }));\r\n\r\n    setBalanceForm((bf) => ({\r\n      ...bf,\r\n      to,\r\n      from,\r\n    }));\r\n  };\r\n\r\n  const setAmount = (e) => {\r\n    const amount = e.target ? e.target.value : e;\r\n\r\n    setBalanceForm((form) => ({ ...form, amount }));\r\n  };\r\n\r\n  const setMax = () => {\r\n    const _game = balancesMap[balanceForm.from];\r\n\r\n    let _max = _game.balance;\r\n\r\n    if (_game.wallet) {\r\n      _max = userAuth.data.balance;\r\n    }\r\n\r\n    setAmount( Math.floor(_max) );\r\n  };\r\n\r\n  const onlyNumbers = (e) => {\r\n    const { value } = e.currentTarget\r\n    let regexp  = /^[0-9\\b]+$/\r\n    if (!value || regexp.test(value)) {\r\n      setAmount(value);\r\n    }\r\n\r\n  };\r\n\r\n  const transfer = (e) => {\r\n\r\n    if (!balanceForm.amount || isNaN(+balanceForm.amount)) {\r\n       setMessage({\r\n        title : '系统提示',\r\n        message: '没有金额',\r\n      })\r\n      setBalanceTransferred(true);\r\n      return void console.warn(\"[transfer] No amount\");\r\n    }\r\n\r\n    const _getMap = (n) => balancesMap[n.split(\": \")[0]] || null;\r\n\r\n    const _from = _getMap(balanceForm.from);\r\n    const _to = _getMap(balanceForm.to);\r\n\r\n    if (_from.game.id === _to.game.id) {\r\n      setMessage({\r\n        title : '系统提示',\r\n        message: '同一个游戏',\r\n      })\r\n      setBalanceTransferred(true);\r\n      return void console.warn(\"[transfer] Same game\");\r\n    }\r\n\r\n    if (_from.balance === 0) {\r\n      setMessage({\r\n        title : '系统提示',\r\n        message: '零余额',\r\n      })\r\n      setBalanceTransferred(true);\r\n      return void console.warn(\"[transfer] Zero balance\");\r\n    }\r\n\r\n    if (_from.balance < +balanceForm.amount) {\r\n      setMessage({\r\n        title : '系统提示',\r\n        message: '余额不足',\r\n      })\r\n      setBalanceTransferred(true);\r\n      return void console.warn(\"[transfer] Not enough game balance\");\r\n    }\r\n\r\n    console.info(\r\n      `You're transfering ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}`\r\n    );\r\n\r\n    setBalanceLoad(true);\r\n\r\n    Game.transfer({\r\n      ...User.read(),\r\n      amount: +balanceForm.amount,\r\n      from: _from.game.id,\r\n      to: _to.game.id,\r\n    }).then(\r\n      (r) => {\r\n        console.info(\r\n          `You have successfully transferred ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}: ${r.info}`\r\n        );\r\n\r\n        setMessage({\r\n          title: '转账成功',\r\n          valid: true,\r\n        })\r\n\r\n        setBalanceLoad(false);\r\n\r\n        setBalanceTransferred(true);\r\n      },\r\n      (e) => {\r\n        console.error(e);\r\n\r\n        setMessage({\r\n          title : '系统提示',\r\n          message: e,\r\n        })\r\n        setBalanceTransferred(true);\r\n\r\n        setBalanceLoad(false);\r\n      }\r\n    );\r\n  };\r\n\r\n  const wallet = (_e) => {\r\n    setBalanceTime(true);\r\n    setBalanceLoad(true);\r\n\r\n    Game.transferToWallet().promise.then(\r\n      (r) => {\r\n        setBalanceLoad(false);\r\n\r\n        setBalanceTransferred(true);\r\n      },\r\n      (e) => {\r\n        console.warn(e);\r\n\r\n        setBalanceLoad(false);\r\n      }\r\n    );\r\n    setTimeout(() => {\r\n      setBalanceTime(false);\r\n    }, 10000);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Wrap\r\n        className=\"profile-transfer\"\r\n        name=\"转账\"\r\n        isLoading={!balancesRaw.length || balanceLoad}\r\n      >\r\n        <div className=\"fields\">\r\n          <div className=\"form-field user-balance\">\r\n            <div className=\"user-balance-wrap wallet\">\r\n              <span className=\"user-balance-label\">\r\n                <i /> 中心钱包\r\n              </span>\r\n              <span className=\"user-balance-amount\">\r\n                {BigNumber(userAuth.data.balance).toFormat(2)}\r\n              </span>\r\n            </div>\r\n            <div className=\"user-balance-wrap hr\" />\r\n            <div\r\n              className=\"user-balance-wrap refresh\"\r\n              onClick={!balanceLoad && !balanceTime ? wallet : null}\r\n            >\r\n              <i />\r\n              <span className=\"user-balance-label\">一键回收</span>\r\n            </div>\r\n\r\n            {/* <i></i>\r\n\t\t\t\t\t<div className=\"wrap\">\r\n\t\t\t\t\t\t<p className=\"label\">中心钱包</p>\r\n\t\t\t\t\t\t<p className=\"amount\">¥ {BigNumber(userAuth.data.balance).toFormat(2)}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<button className=\"to-wallet\" onClick={wallet}>\r\n\t\t\t\t\t\t<Icon name=\"refresh\" />\r\n\t\t\t\t\t\t<span>一键回收</span>\r\n\t\t\t\t\t</button> */}\r\n          </div>\r\n\r\n          {/* ============================ SECTION ============================  */}\r\n          <div className=\"form-field-section\">\r\n            <div className=\"form-field balances-list\">\r\n              {balancesRaw.map((balance, i) => (\r\n                <div key={i} className=\"balances-list--item\">\r\n                  <div className=\"game-name\">{balance.game.name}</div>\r\n                  <div className=\"game-balance\">\r\n                    {BigNumber(balance.balance).toFormat(2)}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          {/* ============================ SECTION ============================  */}\r\n\r\n          {/* ============================ SECTION ============================  */}\r\n          <div className=\"form-field-section\">\r\n            <div className=\"form-field--doubler\">\r\n              <div className=\"form-field\">\r\n                <label>推出</label>\r\n                <div className=\"input--wrap with-dot\">\r\n                  <div\r\n                    className={cx(\"input-like\", {\r\n                      \"has-value\": balanceForm.from,\r\n                    })}\r\n                    onClick={(e) => setBalanceOver(\"from\")}\r\n                  >\r\n                    {balanceForm.from || \"推出\"}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"form-field-swap\">\r\n                <button onClick={() => swap()}>\r\n                  {/* <Icon name=\"switch\" /> */}\r\n                </button>\r\n              </div>\r\n              <div className=\"form-field\">\r\n                <label>进入</label>\r\n                <div className=\"input--wrap with-dot\">\r\n                  <div\r\n                    className={cx(\"input-like\", {\r\n                      \"has-value\": balanceForm.to,\r\n                    })}\r\n                    onClick={(e) => setBalanceOver(\"to\")}\r\n                  >\r\n                    {balanceForm.to || \"进入\"}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"form-field amount-variants\">\r\n              {AmountVariants.map((amount, i) => (\r\n                <button\r\n                  key={i}\r\n                  className={cx(\"amount-variant\", {\r\n                    disabled: amount > userAuth.data.balance,\r\n                  })}\r\n                  onClick={() => setAmount(amount)}\r\n                >\r\n                  {amount}\r\n                </button>\r\n              ))}\r\n            </div>\r\n            <div className=\"form-field with-max\">\r\n              <div className=\"amount-wrap\">\r\n                {/* <label htmlFor=\"amount\">金额</label> */}\r\n                <div className=\"input--wrap\">\r\n                  <span>￥</span>\r\n                  <input\r\n                    id=\"amount\"\r\n                    type=\"text\"\r\n                    placeholder=\"金额\"\r\n                    className={cx({ \"has-value\": balanceForm.amount })}\r\n                    value={balanceForm.amount}\r\n                    onChange={(e) => onlyNumbers(e)}\r\n                    // onKeyDown={(e) => onlyNumbers(e)}\r\n                    \r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"amount-max-wrap\">\r\n                <button\r\n                  className={cx({\r\n                    disabled:\r\n                      !balancesMap[balanceForm.from] ||\r\n                      !balancesMap[balanceForm.from].balance,\r\n                  })}\r\n                  onClick={() => setMax()}\r\n                >\r\n                  最大金额\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          {/* ============================ SECTION ============================  */}\r\n        </div>\r\n        <div className=\"submit\">\r\n          <button className=\"button-stylized\" onClick={transfer}>\r\n            立即转账\r\n          </button>\r\n        </div>\r\n\r\n        <UIAlertSA onClose={() => null} shown={balanceOver}>\r\n          <div className={`game-sa-overlay picker-over`}>\r\n            <div className=\"picker-container\">\r\n              <div className=\"picker-head\">\r\n                <p>{balanceOver === \"from\" ? \"推出\" : \"进入\"}</p>\r\n              </div>\r\n              {balanceOver ? <PickerWrap dist={balanceOver} /> : null}\r\n            </div>\r\n            \r\n            <div className=\"picker-footer\">\r\n              <button onClick={(e) => setBalanceOver(null)}>取消</button>\r\n              <button className=\"active\" onClick={(e) => onSetWheelValSelect(balanceOver)}>\r\n                确定\r\n              </button>\r\n            </div>\r\n            \r\n          </div>\r\n        </UIAlertSA>\r\n        <UIAlertSA onClose={() => null} shown={balanceTransferred}>\r\n          <div className={`game-sa-overlay`}>\r\n            <div className=\"overlay-layer\">\r\n              <div className=\"form response\">\r\n                <div className=\"form-head\">\r\n                {message.valid && <i />}\r\n                <h2>{message.title}</h2>\r\n                </div>\r\n                {message.message && <p className=\"game-transfer-p\">{message.message}</p>}\r\n                <div className=\"form-body\">\r\n                  <button\r\n                    onClick={() => {\r\n                      setBalanceTransferred(false);\r\n                      setBalanceUpdateI((i) => i + 1);\r\n                    }}\r\n                  >\r\n                    确认\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </UIAlertSA>\r\n      </Wrap>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default withAuth(Transfer, 1);\r\n"]},"metadata":{},"sourceType":"module"}