{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{Link}from'react-router-dom';import{StickyProvider,Sticky}from'react-stickup';import{map}from'lodash';import{withAuth}from'../util/';import{Promotions as Service}from'../service/';import'../assets/scss/Promotions.scss';function Promotions(){var container=useRef(null);var nav=useRef(null);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),promotions=_useState2[0],setPromotions=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),active=_useState4[0],setActive=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),position=_useState6[0],setPosition=_useState6[1];useEffect(function(){window.scrollTo(0,0);document.body.classList.add('promotions-page');return function(){return document.body.classList.remove('promotions-page');};},[]);useEffect(function(){var req=Service.read_updated();req.promise.then(function(r){console.log(r);setPromotions(r.info);},function(e){});return function(){return req.cancel();};},[]);var buttonLabels=[\"所有事件\",\"体育\",\"真人\",\"电竞\",\"棋牌\",\"电子\"];var PromoButton=function PromoButton(_ref){var label=_ref.label,active=_ref.active,onClick=_ref.onClick;return/*#__PURE__*/React.createElement(\"div\",{className:\"button \".concat(active?\"active\":null),onClick:onClick},console.warn(active),label);};var _onClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(i){var children;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return setActive(i);case 2:children=nav.current.children;map(children,function(obj){// console.log(obj.offsetLeft)\nif(obj.classList.contains('active')){setPosition(obj.offsetLeft);}});// var el = document.querySelector('.button.active');\n// console.log(el.offsetLeft, el.offsetTop);\ncase 4:case\"end\":return _context.stop();}}},_callee);}));return function onClick(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(StickyProvider,null,/*#__PURE__*/React.createElement(\"div\",{className:\"promotions\",ref:container},/*#__PURE__*/React.createElement(\"div\",{className:\"promotions-flex-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"promotions-inner\"},/*#__PURE__*/React.createElement(\"div\",{className:\"promotions-buttons\",ref:nav},buttonLabels.map(function(label,i){return/*#__PURE__*/React.createElement(PromoButton,{label:label,key:i,active:active===i,onClick:function onClick(){return _onClick(i);}});}),/*#__PURE__*/React.createElement(\"div\",{className:\"switch active-\".concat(active),style:{left:position}})),/*#__PURE__*/React.createElement(\"div\",{className:\"promotions-banners\"},promotions.map(function(promotion,i){return/*#__PURE__*/React.createElement(Link,{className:\"banner\",to:\"/promotion/\".concat(promotion.id),key:i},/*#__PURE__*/React.createElement(\"div\",{className:\"banner-inner\"},/*#__PURE__*/React.createElement(\"div\",{className:\"banner-img\"},/*#__PURE__*/React.createElement(\"img\",{src:\"https://\".concat(promotion.bannerurl),alt:promotion.title})),/*#__PURE__*/React.createElement(\"div\",{className:\"banner-body\"},/*#__PURE__*/React.createElement(\"p\",null,\"\\u79BB\\u6D3B\\u52A8\\u7ED3\\u675F: \",promotion.endTime),/*#__PURE__*/React.createElement(\"span\",{className:\"arrow\"},\"\\u66F4\\u591A\\u5185\\u5BB9\"))));}))))));}export default withAuth(Promotions,0);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/view/Promotions.js"],"names":["React","useState","useEffect","useRef","Link","StickyProvider","Sticky","map","withAuth","Promotions","Service","container","nav","promotions","setPromotions","active","setActive","position","setPosition","window","scrollTo","document","body","classList","add","remove","req","read_updated","promise","then","r","console","log","info","e","cancel","buttonLabels","PromoButton","label","onClick","warn","i","children","current","obj","contains","offsetLeft","left","promotion","id","bannerurl","title","endTime"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { StickyProvider, Sticky } from 'react-stickup';\r\nimport { map } from 'lodash'\r\nimport { withAuth } from '../util/';\r\nimport { Promotions as Service } from '../service/';\r\n\r\nimport '../assets/scss/Promotions.scss';\r\n\r\n\r\nfunction Promotions() {\r\n\r\n\tconst container = useRef(null);\r\n\tconst nav = useRef(null);\r\n\tconst [promotions, setPromotions] = useState([]);\r\n\tconst [ active , setActive ] = useState(0)\r\n\tconst [ position , setPosition ] = useState(0)\r\n\tuseEffect(() => {\r\n\r\n\t\twindow.scrollTo(0, 0);\r\n\r\n\t\tdocument.body.classList.add('promotions-page');\r\n\r\n\t\treturn () => document.body.classList.remove('promotions-page');\r\n\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tconst req = Service.read_updated();\r\n\r\n\t\treq.promise.then(r => {\r\n\r\n\t\t\tconsole.log(r);\r\n\r\n\t\t\tsetPromotions(r.info);\r\n\r\n\t\t}, e => { });\r\n\r\n\t\treturn () => req.cancel();\r\n\r\n\t}, []);\r\n\r\n\tconst buttonLabels = [\"所有事件\", \"体育\", \"真人\", \"电竞\", \"棋牌\", \"电子\"]\r\n\r\n\tconst PromoButton = ({ label, active, onClick }) => (\r\n\t\t<div className={`button ${active ? \"active\" : null}`} onClick={onClick}>\r\n\t\t\t{console.warn(active)}\r\n\t\t\t{label}\r\n\t\t</div>\r\n\t)\r\n\r\n\tconst onClick = async(i) =>{\r\n\t\tawait setActive(i)\r\n\t\tconst { children } = nav.current\r\n\t\tmap(children , (obj ) =>{\r\n\t\t\t// console.log(obj.offsetLeft)\r\n\t\t\tif(obj.classList.contains('active')){\r\n\t\t\t\tsetPosition(obj.offsetLeft)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t})\r\n\t\t// var el = document.querySelector('.button.active');\r\n\t\t// console.log(el.offsetLeft, el.offsetTop);\r\n\r\n\t}\r\n\r\n\treturn (\r\n\t\t<StickyProvider>\r\n\t\t\t<div className=\"promotions\" ref={container}>\r\n\t\t\t\t<div className=\"promotions-flex-wrap\">\r\n\t\t\t\t\t<div className=\"promotions-inner\">\r\n\t\t\t\t\t\t<div className=\"promotions-buttons\" ref={nav}>\r\n\t\t\t\t\t\t\t{buttonLabels.map((label, i) => <PromoButton label={label} key={i} active={active === i} onClick={() => onClick(i)}/>)}\r\n\t\t\t\t\t\t\t<div className={`switch active-${active}`} style={{left : position}}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"promotions-banners\">\r\n\t\t\t\t\t\t\t{promotions.map((promotion, i) => (\r\n\t\t\t\t\t\t\t\t<Link className=\"banner\" to={`/promotion/${promotion.id}`} key={i}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"banner-inner\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"banner-img\">\r\n\t\t\t\t\t\t\t\t\t\t\t<img src={`https://${promotion.bannerurl}`} alt={promotion.title} />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"banner-body\">\r\n\t\t\t\t\t\t\t\t\t\t\t<p>离活动结束: {promotion.endTime}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"arrow\">更多内容</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</StickyProvider>\r\n\t);\r\n\r\n}\r\n\r\nexport default withAuth(Promotions, 0);\r\n"]},"metadata":{},"sourceType":"module"}