{"ast":null,"code":"import _slicedToArray from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{map,isEmpty}from\"lodash\";import{withAuth}from\"../../util\";import{Service}from\"./\";import Wrap from\"./Wrap\";var status=[\"未读\",\"已读\"];var Inbox=function Inbox(){var _useState=useState({status:0,list:null}),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),read=_useState4[0],setRead=_useState4[1];useEffect(function(){var req=Service.Inbox.read({record_type:\"message\"});req.promise.then(function(r){// console.info(r);\nsetMessages({status:1,list:r.info});},function(e){console.warn(e);});},[]);var onRead=function onRead(id){Service.Inbox.readCurrent({id:id}).promise.then(function(r){console.info(r);setRead(r.info);},function(e){console.warn(e);});};console.log(messages.list);return/*#__PURE__*/React.createElement(Wrap,{className:\"profile-inbox-desktop\",title:\"信息\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-section section-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-section-message-wrap\"},!isEmpty(messages.list)?/*#__PURE__*/React.createElement(\"div\",{className:\"profile-section-message-list\"},map(messages.list,function(obj,i){return/*#__PURE__*/React.createElement(\"div\",{key:i,className:\"p-section-m-item\",onClick:function onClick(){return onRead(obj.id);}},/*#__PURE__*/React.createElement(\"div\",{className:\"p-section-m-subject\"},obj.subject),/*#__PURE__*/React.createElement(\"div\",{className:\"p-section-m-time\"},obj.send_time),/*#__PURE__*/React.createElement(\"div\",{className:\"p-section-m-status\"},/*#__PURE__*/React.createElement(\"span\",{className:obj.message_status==0?\"unread\":\"\"},status[obj.message_status])));})):/*#__PURE__*/React.createElement(\"div\",{className:\"profile-section-message-norecord\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-section-message-norecord-wrap\"},/*#__PURE__*/React.createElement(\"i\",null),/*#__PURE__*/React.createElement(\"span\",null,\"\\u627E\\u4E0D\\u5230\\u8BAF\\u606F\"))))),read&&/*#__PURE__*/React.createElement(\"div\",{className:\"read-message\"},/*#__PURE__*/React.createElement(\"div\",{className:\"read-message-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"read-message-title\"},\"\\u4FE1\\u606F\"),/*#__PURE__*/React.createElement(\"div\",{className:\"read-message-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"read-message-subject-time\"},/*#__PURE__*/React.createElement(\"span\",null,read.subject),/*#__PURE__*/React.createElement(\"span\",null,read.send_time)),/*#__PURE__*/React.createElement(\"div\",{className:\"read-message-text\"},read.content)),/*#__PURE__*/React.createElement(\"div\",{className:\"read-message-button\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return setRead(null);}},\"\\u786E\\u5B9A\")))));};export default Inbox;","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/ubet-project (1)/src/view/profile/Inbox.js"],"names":["React","useEffect","useState","map","isEmpty","withAuth","Service","Wrap","status","Inbox","list","messages","setMessages","read","setRead","req","record_type","promise","then","r","info","e","console","warn","onRead","id","readCurrent","log","obj","i","subject","send_time","message_status","content"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { map , isEmpty} from \"lodash\";\r\nimport { withAuth } from \"../../util\";\r\n\r\nimport { Service } from \"./\";\r\n\r\nimport Wrap from \"./Wrap\";\r\n\r\nconst status = [\"未读\", \"已读\"];\r\nconst Inbox = () => {\r\n  const [messages, setMessages] = useState({\r\n    status: 0,\r\n    list: null,\r\n  });\r\n\r\n  const [read, setRead] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const req = Service.Inbox.read({\r\n      record_type: \"message\",\r\n    });\r\n    req.promise.then(\r\n      (r) => {\r\n        // console.info(r);\r\n        setMessages({\r\n          status: 1,\r\n          list: r.info,\r\n        });\r\n      },\r\n      (e) => {\r\n        console.warn(e);\r\n      }\r\n    );\r\n  }, []);\r\n\r\n  const onRead = (id) => {\r\n    Service.Inbox.readCurrent({ id }).promise.then(\r\n      (r) => {\r\n        console.info(r);\r\n        setRead(r.info);\r\n      },\r\n      (e) => {\r\n        console.warn(e);\r\n      }\r\n    );\r\n  };\r\n\r\n  console.log( messages.list )\r\n\r\n  return (\r\n    <Wrap className=\"profile-inbox-desktop\" title={\"信息\"}>\r\n      <div className=\"profile-section section-box\">\r\n        \r\n        {/* <div className=\"profile-section-title\">信息</div> */}\r\n\r\n        <div className=\"profile-section-message-wrap\">\r\n          {!isEmpty(messages.list) ? (\r\n            <div className=\"profile-section-message-list\">\r\n              {map(messages.list, (obj, i) => {\r\n                return (\r\n                  <div\r\n                    key={i}\r\n                    className=\"p-section-m-item\"\r\n                    onClick={() => onRead(obj.id)}\r\n                  >\r\n                    <div className=\"p-section-m-subject\">{obj.subject}</div>\r\n                    <div className=\"p-section-m-time\">{obj.send_time}</div>\r\n                    <div className=\"p-section-m-status\">\r\n                      <span className={obj.message_status == 0 ? \"unread\" : \"\"}>\r\n                        {status[obj.message_status]}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          ) : (\r\n            <div className=\"profile-section-message-norecord\">\r\n              <div className=\"profile-section-message-norecord-wrap\">\r\n                <i />\r\n                <span>找不到讯息</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {read && (\r\n        <div className=\"read-message\">\r\n          <div className=\"read-message-wrap\">\r\n            <div className=\"read-message-title\">信息</div>\r\n\r\n            <div className=\"read-message-content\">\r\n              <div className=\"read-message-subject-time\">\r\n                <span>{read.subject}</span>\r\n                <span>{read.send_time}</span>\r\n              </div>\r\n              <div className=\"read-message-text\">{read.content}</div>\r\n            </div>\r\n            <div className=\"read-message-button\">\r\n              <button onClick={() => setRead(null)}>确定</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default Inbox;\r\n"]},"metadata":{},"sourceType":"module"}