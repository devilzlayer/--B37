{"ast":null,"code":"import _objectSpread from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext,useRef}from\"react\";import{mobileModel}from\"react-device-detect\";import{useHistory}from\"react-router-dom\";import{Wrap,Service}from\"../\";import{FormField}from\"../../../../component\";var Name=function Name(){var history=useHistory();var _useContext=useContext(Service.User.Context),data=_useContext.userAuth.data,setUserAuthFN=_useContext.setUserAuthFN;var refName=useRef(null);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),formname=_useState2[0],setFormName=_useState2[1];var form={email:data.email,birthday:data.birthday,phone:data.telephone,qq:data.qq,wechat:data.wechat||\"\",device:mobileModel,//\"Huawei Mate 20 Pro\",\nupdates:[{text:\"4.14.116\"},{text:\"Thu Apr 30 18:27:58 CSTt 2020\"}]};var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),active=_useState4[0],setActive=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),disabled=_useState6[0],setDisabled=_useState6[1];useEffect(function(){if(formname!==\"\"&&formname.length>1&&formname.length<5)setActive(true);else setActive(false);},[formname]);var onChange=function onChange(e){var nameinput=e.target.value;setFormName(nameinput);};var update=function update(){console.info(\"You're updating account full name:\",formname);Service.User.update(_objectSpread(_objectSpread(_objectSpread({},form),Service.User.read()),{},{realname:formname})).promise.then(function(r){console.info(\"✅ You have successfully updated account full name:\",r.info);setActive(false);setDisabled(true);Service.User.session(_objectSpread({},Service.User.read())).promise.then(function(r){return setUserAuthFN(1,r.info);});},function(e){console.warn(\"Unable to update account full name:\",e);});};return/*#__PURE__*/React.createElement(Wrap,{className:\"profile-general\",name:\"\\u771F\\u5B9E\\u59D3\\u540D\",sublevel:[true,function(){return history.push(\"/profile/personal\");}]},disabled&&/*#__PURE__*/React.createElement(\"span\",{className:\"profile-valid\"}),/*#__PURE__*/React.createElement(FormField,{field:{label:\"真实姓名\"},input:{id:\"name\",name:\"name\",type:\"text\",placeholder:\"用于提现时安全核对\",maxLength:4,ref:refName,onChange:onChange,onInput:function onInput(){if(refName.current.value>4)refName.current.value.slice(0,4);}}}),/*#__PURE__*/React.createElement(\"div\",{className:\"submit\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-button \".concat(active&&!disabled&&\"form-button-active\"),onClick:active&&!disabled?update:null},/*#__PURE__*/React.createElement(\"span\",null,\"\\u63D0\\u4EA4\"))));};export default Name;","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/pwa/view/profile/personal/Name.js"],"names":["React","useState","useEffect","useContext","useRef","mobileModel","useHistory","Wrap","Service","FormField","Name","history","User","Context","data","userAuth","setUserAuthFN","refName","formname","setFormName","form","email","birthday","phone","telephone","qq","wechat","device","updates","text","active","setActive","disabled","setDisabled","length","onChange","e","nameinput","target","value","update","console","info","read","realname","promise","then","r","session","warn","push","label","id","name","type","placeholder","maxLength","ref","onInput","current","slice"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext, useRef } from \"react\";\r\nimport { mobileModel } from \"react-device-detect\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nimport { Wrap, Service } from \"../\";\r\nimport { FormField } from \"../../../../component\";\r\n\r\nconst Name = () => {\r\n  const history = useHistory();\r\n\r\n  const {\r\n    userAuth: { data },\r\n    setUserAuthFN,\r\n  } = useContext(Service.User.Context);\r\n\r\n  const refName = useRef(null);\r\n\r\n  const [formname, setFormName] = useState(\"\");\r\n  const form = {\r\n    email: data.email,\r\n    birthday: data.birthday,\r\n    phone: data.telephone,\r\n    qq: data.qq,\r\n    wechat: data.wechat || \"\",\r\n    device: mobileModel, //\"Huawei Mate 20 Pro\",\r\n    updates: [{ text: \"4.14.116\" }, { text: \"Thu Apr 30 18:27:58 CSTt 2020\" }],\r\n  };\r\n\r\n  const [active, setActive] = useState(false);\r\n  const [disabled, setDisabled] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (formname !== \"\" && formname.length > 1 && formname.length < 5)\r\n      setActive(true);\r\n    else setActive(false);\r\n  }, [formname]);\r\n\r\n  const onChange = (e) => {\r\n    const nameinput = e.target.value;\r\n    setFormName(nameinput);\r\n  };\r\n\r\n  const update = () => {\r\n    console.info(\"You're updating account full name:\", formname);\r\n\r\n    Service.User.update({\r\n      ...form,\r\n      ...Service.User.read(),\r\n      realname: formname,\r\n    }).promise.then(\r\n      (r) => {\r\n        console.info(\r\n          \"✅ You have successfully updated account full name:\",\r\n          r.info\r\n        );\r\n        setActive(false);\r\n        setDisabled(true);\r\n\r\n        Service.User.session({\r\n          ...Service.User.read(),\r\n        }).promise.then((r) => setUserAuthFN(1, r.info));\r\n      },\r\n      (e) => {\r\n        console.warn(\"Unable to update account full name:\", e);\r\n      }\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Wrap\r\n      className=\"profile-general\"\r\n      name=\"真实姓名\"\r\n      sublevel={[true, () => history.push(\"/profile/personal\")]}\r\n    >\r\n      {disabled && <span className=\"profile-valid\" />}\r\n      <FormField\r\n        field={{ label: \"真实姓名\" }}\r\n        input={{\r\n          id: \"name\",\r\n          name: \"name\",\r\n          type: \"text\",\r\n          placeholder: \"用于提现时安全核对\",\r\n          maxLength: 4,\r\n          ref: refName,\r\n          onChange,\r\n          onInput: () => {\r\n            if (refName.current.value > 4) refName.current.value.slice(0, 4);\r\n          },\r\n        }}\r\n      />\r\n      <div className=\"submit\">\r\n        <div\r\n          className={`form-button ${\r\n            active && !disabled && \"form-button-active\"\r\n          }`}\r\n          onClick={active && !disabled ? update : null}\r\n        >\r\n          <span>提交</span>\r\n        </div>\r\n      </div>\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default Name;\r\n"]},"metadata":{},"sourceType":"module"}