{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Documents/New PWA/GIT/src/pwa/view/profile/personal/Email.js\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { mobileModel } from \"react-device-detect\";\nimport { useHistory } from \"react-router-dom\";\nimport { Wrap, Service } from \"../\";\nimport { FormField } from \"../../../../component\";\n\nconst Email = () => {\n  const history = useHistory();\n  const {\n    userAuth: {\n      data\n    },\n    setUserAuthFN\n  } = useContext(Service.User.Context);\n  const [formemail, setFormEmail] = useState(\"\");\n  const form = {\n    realname: data.realName,\n    birthday: data.birthday,\n    phone: data.telephone,\n    qq: data.qq,\n    wechat: data.wechat || \"\",\n    device: mobileModel,\n    //\"Huawei Mate 20 Pro\",\n    updates: [{\n      text: \"4.14.116\"\n    }, {\n      text: \"Thu Apr 30 18:27:58 CSTt 2020\"\n    }]\n  };\n  const [active, setActive] = useState(false);\n  const [disabled, setDisabled] = useState(false);\n  useEffect(() => {\n    function validateEmail(email) {\n      const re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n      return re.test(email);\n    }\n\n    if (formemail !== \"\" && validateEmail(formemail)) setActive(true);else setActive(false);\n  }, [formemail]);\n\n  const onChange = e => {\n    const emailinput = e.target.value;\n    setFormEmail(emailinput);\n  };\n\n  const update = () => {\n    console.info(\"You're updating account email:\", formemail);\n    Service.User.update({ ...form,\n      ...Service.User.read(),\n      email: formemail\n    }).promise.then(r => {\n      console.info(\"✅ You have successfully updated account email:\", r.info);\n      setActive(false);\n      setDisabled(true);\n      Service.User.session({ ...Service.User.read()\n      }).promise.then(r => setUserAuthFN(1, r.info));\n    }, e => {\n      console.warn(\"Unable to update account email:\", e);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(Wrap, {\n    className: \"profile-general profile-email\",\n    name: \"\\u90AE\\u7BB1\\u5730\\u5740\",\n    sublevel: [true, () => history.goBack()],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 5\n    }\n  }, disabled && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"profile-valid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 20\n    }\n  }), /*#__PURE__*/React.createElement(FormField, {\n    field: {\n      label: \"邮箱地址\"\n    },\n    input: {\n      id: \"email\",\n      name: \"email\",\n      type: \"text\",\n      placeholder: \"请输入绑定的邮箱地址\",\n      onChange\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `form-button ${active && !disabled && \"form-button-active\"}`,\n    onClick: active && !disabled ? update : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  }, \"\\u63D0\\u4EA4\"))));\n};\n\nexport default Email;","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/pwa/view/profile/personal/Email.js"],"names":["React","useState","useEffect","useContext","mobileModel","useHistory","Wrap","Service","FormField","Email","history","userAuth","data","setUserAuthFN","User","Context","formemail","setFormEmail","form","realname","realName","birthday","phone","telephone","qq","wechat","device","updates","text","active","setActive","disabled","setDisabled","validateEmail","email","re","test","onChange","e","emailinput","target","value","update","console","info","read","promise","then","r","session","warn","goBack","label","id","name","type","placeholder"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\nimport { mobileModel } from \"react-device-detect\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nimport { Wrap, Service } from \"../\";\r\nimport { FormField } from \"../../../../component\";\r\n\r\nconst Email = () => {\r\n  const history = useHistory();\r\n\r\n  const {\r\n    userAuth: { data },\r\n    setUserAuthFN,\r\n  } = useContext(Service.User.Context);\r\n\r\n  const [formemail, setFormEmail] = useState(\"\");\r\n  const form = {\r\n    realname: data.realName,\r\n    birthday: data.birthday,\r\n    phone: data.telephone,\r\n    qq: data.qq,\r\n    wechat: data.wechat || \"\",\r\n    device: mobileModel, //\"Huawei Mate 20 Pro\",\r\n    updates: [{ text: \"4.14.116\" }, { text: \"Thu Apr 30 18:27:58 CSTt 2020\" }],\r\n  };\r\n\r\n  const [active, setActive] = useState(false);\r\n  const [disabled, setDisabled] = useState(false);\r\n\r\n  useEffect(() => {\r\n    function validateEmail(email) {\r\n      const re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n      return re.test(email);\r\n    }\r\n\r\n    if (formemail !== \"\" && validateEmail(formemail)) setActive(true);\r\n    else setActive(false);\r\n  }, [formemail]);\r\n\r\n  const onChange = (e) => {\r\n    const emailinput = e.target.value;\r\n\r\n    setFormEmail(emailinput);\r\n  };\r\n\r\n  const update = () => {\r\n    console.info(\"You're updating account email:\", formemail);\r\n\r\n    Service.User.update({\r\n      ...form,\r\n      ...Service.User.read(),\r\n      email: formemail,\r\n    }).promise.then(\r\n      (r) => {\r\n        console.info(\"✅ You have successfully updated account email:\", r.info);\r\n        setActive(false);\r\n        setDisabled(true);\r\n\r\n        Service.User.session({\r\n          ...Service.User.read(),\r\n        }).promise.then((r) => setUserAuthFN(1, r.info));\r\n      },\r\n      (e) => {\r\n        console.warn(\"Unable to update account email:\", e);\r\n      }\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Wrap\r\n      className=\"profile-general profile-email\"\r\n      name=\"邮箱地址\"\r\n      sublevel={[true, () => history.goBack()]}\r\n    >\r\n      {disabled && <span className=\"profile-valid\" />}\r\n      <FormField\r\n        field={{ label: \"邮箱地址\" }}\r\n        input={{\r\n          id: \"email\",\r\n          name: \"email\",\r\n          type: \"text\",\r\n          placeholder: \"请输入绑定的邮箱地址\",\r\n          onChange,\r\n        }}\r\n      />\r\n      <div className=\"submit\">\r\n        <div\r\n          className={`form-button ${\r\n            active && !disabled && \"form-button-active\"\r\n          }`}\r\n          onClick={active && !disabled ? update : null}\r\n        >\r\n          <span>提交</span>\r\n        </div>\r\n      </div>\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default Email;\r\n"]},"metadata":{},"sourceType":"module"}