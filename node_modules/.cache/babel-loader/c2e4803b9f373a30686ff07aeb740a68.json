{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Downloads/usportproject 2/src/view/Game.js\";\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useHistory, useLocation } from 'react-router-dom';\nimport { withAuth } from '../util/';\nimport { User } from '../service';\nimport { Game as Service } from '../service';\nconst externals = [1204, 1209, 1211];\n\nfunction Game() {\n  const history = useHistory();\n  const {\n    id\n  } = useParams();\n  const isExternal = externals.includes(+id);\n  const [iframe, setIframe] = useState(null);\n  const {\n    search\n  } = useLocation(); // eslint-disable-next-line\n\n  const [fromHome, setFromHome] = useState(search.includes('from_home=1'));\n  useEffect(() => {\n    if (fromHome) {\n      history.replace({\n        search: ''\n      });\n    }\n  }, [history, fromHome]);\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n  useEffect(() => {\n    const user = User.read();\n    const req = Service.activate({ ...user,\n      num: 1,\n      gameid: id\n    });\n\n    function LogIn() {\n      Service.login({ ...user,\n        num: 1,\n        gameid: id\n      }).promise.then(r => {\n        console.log(r); // setIframe(r.info);\n\n        if (!isExternal) {\n          setIframe(r.info);\n        } else {\n          if (fromHome) {\n            window.location.href = r.info;\n          } else {\n            history.push('/');\n          }\n        }\n      }, e => {\n        console.error('Unable to login to the game', e);\n      });\n    }\n\n    req.promise.then(r => {\n      console.log(r);\n      LogIn();\n    }, e => {\n      if (!e.is_aborted) {\n        console.error('Unable to activate the game:', e);\n        LogIn();\n      }\n    });\n    return () => req.cancel();\n  }, [history, id, fromHome, isExternal]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, iframe ? /*#__PURE__*/React.createElement(\"iframe\", {\n    style: {\n      height: 800,\n      overflow: 'auto'\n    },\n    title: `IFRAME-N${id}`,\n    src: iframe,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 4\n    }\n  }) : null);\n}\n\nexport default withAuth(Game, 1);","map":{"version":3,"sources":["/Users/cramj/Downloads/usportproject 2/src/view/Game.js"],"names":["React","useState","useEffect","useParams","useHistory","useLocation","withAuth","User","Game","Service","externals","history","id","isExternal","includes","iframe","setIframe","search","fromHome","setFromHome","replace","window","scrollTo","user","read","req","activate","num","gameid","LogIn","login","promise","then","r","console","log","info","location","href","push","e","error","is_aborted","cancel","height","overflow"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useHistory, useLocation } from 'react-router-dom';\r\n\r\nimport { withAuth } from '../util/';\r\nimport { User } from '../service';\r\nimport { Game as Service } from '../service';\r\n\r\nconst externals = [ 1204, 1209, 1211 ];\r\n\r\nfunction Game () {\r\n\r\n\tconst history = useHistory();\r\n\r\n\tconst { id } = useParams();\r\n\tconst isExternal = externals.includes(+ id);\r\n\tconst [ iframe, setIframe ] = useState(null);\r\n\r\n\tconst { search } = useLocation();\r\n\t// eslint-disable-next-line\r\n\tconst [ fromHome, setFromHome ] = useState(search.includes('from_home=1'));\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tif (fromHome) {\r\n\t\t\thistory.replace({ search: '' });\r\n\t\t}\r\n\r\n\t}, [ history, fromHome ]);\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\twindow.scrollTo(0, 0);\r\n\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tconst user = User.read();\r\n\r\n\t\tconst req = Service.activate({\r\n\t\t\t...user,\r\n\t\t\tnum: 1,\r\n\t\t\tgameid: id,\r\n\t\t});\r\n\r\n\t\tfunction LogIn () {\r\n\r\n\t\t\tService.login({\r\n\t\t\t\t...user,\r\n\t\t\t\tnum: 1,\r\n\t\t\t\tgameid: id,\r\n\t\t\t}).promise.then(r => {\r\n\r\n\t\t\t\tconsole.log(r);\r\n\r\n\t\t\t\t// setIframe(r.info);\r\n\r\n\t\t\t\tif (!isExternal) {\r\n\r\n\t\t\t\t\tsetIframe(r.info);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif (fromHome) {\r\n\t\t\t\t\t\twindow.location.href = r.info;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\thistory.push('/');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, e => {\r\n\r\n\t\t\t\tconsole.error('Unable to login to the game', e);\r\n\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t\treq.promise.then(r => {\r\n\r\n\t\t\tconsole.log(r);\r\n\r\n\t\t\tLogIn();\r\n\r\n\t\t}, e => {\r\n\r\n\t\t\tif (!e.is_aborted) {\r\n\r\n\t\t\t\tconsole.error('Unable to activate the game:', e);\r\n\r\n\t\t\t\tLogIn();\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\treturn () => req.cancel();\r\n\r\n\t}, [ history, id, fromHome, isExternal ]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{iframe ? (\r\n\t\t\t<iframe \r\n\t\t\t\tstyle={{ height: 800, overflow: 'auto' }}\r\n\t\t\t\ttitle={`IFRAME-N${id}`}\r\n\t\t\t\tsrc={iframe}>\r\n\t\t\t</iframe>\r\n\t\t\t) : null}\r\n\t\t</>\r\n\t);\r\n\r\n}\r\n\r\nexport default withAuth(Game, 1);\r\n"]},"metadata":{},"sourceType":"module"}