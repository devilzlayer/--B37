{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cramj/Documents/New PWA/GIT/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useMemo}from\"react\";import{map,filter,isEmpty}from'lodash';import*as moment from\"moment\";import{Service}from'../';import{toDate}from\"../../../util\";var CardItem=function CardItem(props){// console.log(props)\nvar label=props.label,time=props.time,value=props.value,status=props.status,index=props.index,className=props.className,obj=props.obj,onSetKey=props.onSetKey,setKey=props.setKey;//成功 SUCCESS\n//失败 FAILURE\n//未审核 UNREVIEWED\n//出款中 WITHDRAWING\n//已审核 AUDITED\n//汇款中 REMITTANCE\nvar statusText=\"\";var classStatus=\"\";var cancel=false;var fail=false;if(status===\"成功\"){statusText=\"成功\";classStatus=\"success\";}if(status===\"失败\"){statusText=\"失败\";classStatus=\"failure\";fail=true;}if(status===\"未审核\"){statusText=\"未审核\";classStatus=\"unreviewed\";cancel=true;}if(status===\"出款中\"){statusText=\"出款中\";classStatus=\"withdrawing\";}if(status===\"汇款中\"){statusText=\"汇款中\";classStatus=\"remittance\";}// if(status === \"已审核\"){\n// \tstatusText = \"已审核\"\n// \tclassStatus = \"audited\"\n// }\nreturn/*#__PURE__*/React.createElement(\"div\",{className:\"withdrawal-history-card-item \".concat(className?className:\"\")},/*#__PURE__*/React.createElement(\"div\",{className:\"cl-item withdrawal-history-card-text\"},/*#__PURE__*/React.createElement(\"p\",{className:\"cl-card-text\"},label),/*#__PURE__*/React.createElement(\"p\",{className:\"cl-card-time\"},time)),/*#__PURE__*/React.createElement(\"div\",{className:\"cl-item withdrawal-history-card-value\"},cancel&&/*#__PURE__*/React.createElement(\"span\",{className:\"cancel\",onClick:function onClick(){return props.onCancel(obj);}},\"\\u53D6\\u6D88\\u63D0\\u6B3E\"),/*#__PURE__*/React.createElement(\"p\",{className:\"cl-card-amount\"},\"\\u91D1\\u989D: \",/*#__PURE__*/React.createElement(\"span\",null,value)),/*#__PURE__*/React.createElement(\"p\",{className:\"cl-card-status \".concat(classStatus)},/*#__PURE__*/React.createElement(\"span\",null,statusText,fail&&/*#__PURE__*/React.createElement(\"span\",{className:\"fail\",onClick:function onClick(){return onSetKey(index);}},setKey===index&&/*#__PURE__*/React.createElement(\"span\",null,obj.verifyComment),/*#__PURE__*/React.createElement(\"i\",null))))));};var WithdrawalHistory=function WithdrawalHistory(props){var id=props.id,refresh=props.refresh,onStop=props.onStop;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),key=_useState2[0],setKey=_useState2[1];var _useState3=useState({status:0,list:[]}),_useState4=_slicedToArray(_useState3,2),items=_useState4[0],setItems=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),load=_useState6[0],setLoad=_useState6[1];var _useState7=useState(\"today\"),_useState8=_slicedToArray(_useState7,2),range=_useState8[0],setRange=_useState8[1];var _useState9=useState({from:moment().subtract(30,\"days\").toDate(),to:moment().toDate()}),_useState10=_slicedToArray(_useState9,2),customRange=_useState10[0],setCustomRange=_useState10[1];useEffect(function(){if(refresh==id){setLoad(true);}},[refresh]);useEffect(function(){var fetch=function fetch(){var response=Service.Transaction.read(_objectSpread(_objectSpread({},Service.User.read()),{},{record_type:\"debit\"}));response.promise.then(function(result){// console.log(result);\nif(result.status===1){// setItems(result.info);\nsetItems({status:1,list:result.info.map(function(t){return _objectSpread(_objectSpread({},t),{},{ts:toDate(t.requestTime,true)});})});setLoad(false);onStop();}},function(e){console.log(\"Unable to response:\",e);});};fetch();},[load]);var _onCancel=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(w){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(w);// const r = await Service.User.withdrawCancel({ id: w.id }).promise;\n_context.next=3;return Service.User.withdrawCancel({id:w.id}).promise;case 3:response=_context.sent;// console.log(response);\nif(response.status===1){setLoad(true);}case 5:case\"end\":return _context.stop();}}},_callee);}));return function onCancel(_x){return _ref.apply(this,arguments);};}();var _onSetKey=function onSetKey(value){setKey(null);if(key!==value)setKey(value);};var __withdraws=useMemo(function(){var _rangeMap={today:function today(){var today=moment();return[today.startOf(\"day\").unix(),today.endOf(\"day\").unix()];},yesterday:function yesterday(){var yesterday=moment().subtract(1,\"days\");return[yesterday.startOf(\"day\").unix(),yesterday.endOf(\"day\").unix()];},week:function week(){return[moment().subtract(1,\"weeks\").startOf(\"day\").unix(),moment().endOf(\"day\").unix()];},month:function month(){return[moment().subtract(30,\"days\").startOf(\"day\").unix(),moment().endOf(\"day\").unix()];},custom:function custom(){var from=customRange.from,to=customRange.to;return[moment(from).startOf(\"day\").unix(),moment(to).endOf(\"day\").unix()];}};var _rangeMap$range=_rangeMap[range](),_rangeMap$range2=_slicedToArray(_rangeMap$range,2),from=_rangeMap$range2[0],to=_rangeMap$range2[1];// return withdraws.list.filter((t) => t.ts >= from && t.ts < to);\nreturn filter(items.list,function(t){return t.ts>=from&&t.ts<to;});},[items.list,customRange,range]);// console.log(__withdraws)\nif(!isEmpty(__withdraws)){return/*#__PURE__*/React.createElement(\"div\",{className:\"withdrawal-history-card-body\"},map(__withdraws,function(obj,i){return/*#__PURE__*/React.createElement(CardItem,{obj:obj,key:i,index:i,label:obj.cardNumber,time:obj.requestTime,value:obj.amount,status:obj.status,onCancel:function onCancel(val){return _onCancel(val);},onSetKey:function onSetKey(val){return _onSetKey(val);},setKey:key});}));}return/*#__PURE__*/React.createElement(\"div\",{className:\"no-transactions\"},/*#__PURE__*/React.createElement(\"div\",{className:\"image-box\"}),/*#__PURE__*/React.createElement(\"span\",null,\"\\u6682\\u65E0\\u8BB0\\u5F55\"));};export default WithdrawalHistory;","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/view/profile/transferhistory/withdrawalhistory.js"],"names":["React","useEffect","useState","useMemo","map","filter","isEmpty","moment","Service","toDate","CardItem","props","label","time","value","status","index","className","obj","onSetKey","setKey","statusText","classStatus","cancel","fail","onCancel","verifyComment","WithdrawalHistory","id","refresh","onStop","key","list","items","setItems","load","setLoad","range","setRange","from","subtract","to","customRange","setCustomRange","fetch","response","Transaction","read","User","record_type","promise","then","result","info","t","ts","requestTime","e","console","log","w","withdrawCancel","__withdraws","_rangeMap","today","startOf","unix","endOf","yesterday","week","month","custom","i","cardNumber","amount","val"],"mappings":"4jBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,CAAqCC,OAArC,KAAoD,OAApD,CACA,OAASC,GAAT,CAAeC,MAAf,CAAuBC,OAAvB,KAAqC,QAArC,CACA,MAAO,GAAKC,CAAAA,MAAZ,KAAwB,QAAxB,CAEA,OAASC,OAAT,KAAwB,KAAxB,CAEA,OAASC,MAAT,KAAuB,eAAvB,CAIA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,KAAD,CAAW,CACxB;AADwB,GAGtBC,CAAAA,KAHsB,CAYpBD,KAZoB,CAGtBC,KAHsB,CAItBC,IAJsB,CAYpBF,KAZoB,CAItBE,IAJsB,CAKtBC,KALsB,CAYpBH,KAZoB,CAKtBG,KALsB,CAMtBC,MANsB,CAYpBJ,KAZoB,CAMtBI,MANsB,CAOtBC,KAPsB,CAYpBL,KAZoB,CAOtBK,KAPsB,CAQtBC,SARsB,CAYpBN,KAZoB,CAQtBM,SARsB,CAStBC,GATsB,CAYpBP,KAZoB,CAStBO,GATsB,CAUtBC,QAVsB,CAYpBR,KAZoB,CAUtBQ,QAVsB,CAWtBC,MAXsB,CAYpBT,KAZoB,CAWtBS,MAXsB,CAaxB;AACA;AACA;AACA;AACA;AACA;AAEA,GAAIC,CAAAA,UAAU,CAAG,EAAjB,CACA,GAAIC,CAAAA,WAAW,CAAG,EAAlB,CACA,GAAIC,CAAAA,MAAM,CAAG,KAAb,CACA,GAAIC,CAAAA,IAAI,CAAG,KAAX,CACA,GAAIT,MAAM,GAAK,IAAf,CAAqB,CACnBM,UAAU,CAAG,IAAb,CACAC,WAAW,CAAG,SAAd,CACD,CAED,GAAIP,MAAM,GAAK,IAAf,CAAqB,CACnBM,UAAU,CAAG,IAAb,CACAC,WAAW,CAAG,SAAd,CACAE,IAAI,CAAG,IAAP,CACD,CAED,GAAIT,MAAM,GAAK,KAAf,CAAsB,CACpBM,UAAU,CAAG,KAAb,CACAC,WAAW,CAAG,YAAd,CACAC,MAAM,CAAG,IAAT,CACD,CAED,GAAIR,MAAM,GAAK,KAAf,CAAsB,CACpBM,UAAU,CAAG,KAAb,CACAC,WAAW,CAAG,aAAd,CACD,CAED,GAAIP,MAAM,GAAK,KAAf,CAAsB,CACpBM,UAAU,CAAG,KAAb,CACAC,WAAW,CAAG,YAAd,CACD,CAED;AACA;AACA;AACA;AAEA,mBACE,2BACE,SAAS,wCAAkCL,SAAS,CAAGA,SAAH,CAAe,EAA1D,CADX,eAGE,2BAAK,SAAS,CAAC,sCAAf,eACE,yBAAG,SAAS,CAAC,cAAb,EAA6BL,KAA7B,CADF,cAEE,yBAAG,SAAS,CAAC,cAAb,EAA6BC,IAA7B,CAFF,CAHF,cAOE,2BAAK,SAAS,CAAC,uCAAf,EACGU,MAAM,eACL,4BAAM,SAAS,CAAC,QAAhB,CAAyB,OAAO,CAAE,yBAAMZ,CAAAA,KAAK,CAACc,QAAN,CAAeP,GAAf,CAAN,EAAlC,6BAFJ,cAME,yBAAG,SAAS,CAAC,gBAAb,gCACM,gCAAOJ,KAAP,CADN,CANF,cASE,yBAAG,SAAS,0BAAoBQ,WAApB,CAAZ,eACE,gCACGD,UADH,CAEGG,IAAI,eACH,4BAAM,SAAS,CAAC,MAAhB,CAAuB,OAAO,CAAE,yBAAML,CAAAA,QAAQ,CAACH,KAAD,CAAd,EAAhC,EACGI,MAAM,GAAKJ,KAAX,eAAoB,gCAAOE,GAAG,CAACQ,aAAX,CADvB,cAEE,6BAFF,CAHJ,CADF,CATF,CAPF,CADF,CA+BD,CAvFH,CAyFA,GAAMC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAAChB,KAAD,CAAW,IAC3BiB,CAAAA,EAD2B,CACFjB,KADE,CAC3BiB,EAD2B,CACvBC,OADuB,CACFlB,KADE,CACvBkB,OADuB,CACbC,MADa,CACFnB,KADE,CACbmB,MADa,eAGb5B,QAAQ,CAAC,IAAD,CAHK,wCAG5B6B,GAH4B,eAGvBX,MAHuB,8BAKTlB,QAAQ,CAAC,CACjCa,MAAM,CAAE,CADyB,CAEjCiB,IAAI,CAAE,EAF2B,CAAD,CALC,yCAK5BC,KAL4B,eAKrBC,QALqB,8BASXhC,QAAQ,CAAC,KAAD,CATG,yCAS5BiC,IAT4B,eAStBC,OATsB,8BAWTlC,QAAQ,CAAC,OAAD,CAXC,yCAW5BmC,KAX4B,eAWrBC,QAXqB,8BAYGpC,QAAQ,CAAC,CAC7CqC,IAAI,CAAEhC,MAAM,GAAGiC,QAAT,CAAkB,EAAlB,CAAsB,MAAtB,EAA8B/B,MAA9B,EADuC,CAE7CgC,EAAE,CAAElC,MAAM,GAAGE,MAAT,EAFyC,CAAD,CAZX,0CAY5BiC,WAZ4B,gBAYfC,cAZe,gBAiBnC1C,SAAS,CAAC,UAAK,CACb,GAAG4B,OAAO,EAAID,EAAd,CAAkB,CAChBQ,OAAO,CAAC,IAAD,CAAP,CACD,CACF,CAJQ,CAIP,CAACP,OAAD,CAJO,CAAT,CAMA5B,SAAS,CAAC,UAAM,CACd,GAAM2C,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,EAAM,CAClB,GAAMC,CAAAA,QAAQ,CAAGrC,OAAO,CAACsC,WAAR,CAAoBC,IAApB,gCACZvC,OAAO,CAACwC,IAAR,CAAaD,IAAb,EADY,MAEfE,WAAW,CAAE,OAFE,GAAjB,CAKAJ,QAAQ,CAACK,OAAT,CAAiBC,IAAjB,CACE,SAACC,MAAD,CAAY,CACV;AACA,GAAIA,MAAM,CAACrC,MAAP,GAAkB,CAAtB,CAAyB,CACvB;AACAmB,QAAQ,CAAC,CACPnB,MAAM,CAAE,CADD,CAEPiB,IAAI,CAAEoB,MAAM,CAACC,IAAP,CAAYjD,GAAZ,CAAgB,SAACkD,CAAD,wCACjBA,CADiB,MAEpBC,EAAE,CAAE9C,MAAM,CAAC6C,CAAC,CAACE,WAAH,CAAgB,IAAhB,CAFU,IAAhB,CAFC,CAAD,CAAR,CAOApB,OAAO,CAAC,KAAD,CAAP,CACAN,MAAM,GAEP,CACF,CAhBH,CAiBE,SAAC2B,CAAD,CAAO,CACLC,OAAO,CAACC,GAAR,CAAY,qBAAZ,CAAmCF,CAAnC,EACD,CAnBH,EAqBD,CA3BD,CA4BAb,KAAK,GACN,CA9BQ,CA8BN,CAACT,IAAD,CA9BM,CAAT,CAgCA,GAAMV,CAAAA,SAAQ,0FAAG,iBAAOmC,CAAP,+HACfF,OAAO,CAACC,GAAR,CAAYC,CAAZ,EACA;AAFe,sBAGQpD,CAAAA,OAAO,CAACwC,IAAR,CAAaa,cAAb,CAA4B,CAAEjC,EAAE,CAAEgC,CAAC,CAAChC,EAAR,CAA5B,EAA0CsB,OAHlD,QAGTL,QAHS,eAIf;AACA,GAAIA,QAAQ,CAAC9B,MAAT,GAAoB,CAAxB,CAA2B,CACzBqB,OAAO,CAAC,IAAD,CAAP,CACD,CAPc,sDAAH,kBAARX,CAAAA,QAAQ,4CAAd,CAUA,GAAMN,CAAAA,SAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACL,KAAD,CAAW,CAC1BM,MAAM,CAAC,IAAD,CAAN,CACA,GAAIW,GAAG,GAAKjB,KAAZ,CAAmBM,MAAM,CAACN,KAAD,CAAN,CACpB,CAHD,CAMA,GAAMgD,CAAAA,WAAW,CAAG3D,OAAO,CAAC,UAAM,CAChC,GAAM4D,CAAAA,SAAS,CAAG,CAChBC,KAAK,CAAE,gBAAM,CACX,GAAMA,CAAAA,KAAK,CAAGzD,MAAM,EAApB,CACA,MAAO,CAACyD,KAAK,CAACC,OAAN,CAAc,KAAd,EAAqBC,IAArB,EAAD,CAA8BF,KAAK,CAACG,KAAN,CAAY,KAAZ,EAAmBD,IAAnB,EAA9B,CAAP,CACD,CAJe,CAKhBE,SAAS,CAAE,oBAAM,CACf,GAAMA,CAAAA,SAAS,CAAG7D,MAAM,GAAGiC,QAAT,CAAkB,CAAlB,CAAqB,MAArB,CAAlB,CACA,MAAO,CAAC4B,SAAS,CAACH,OAAV,CAAkB,KAAlB,EAAyBC,IAAzB,EAAD,CAAkCE,SAAS,CAACD,KAAV,CAAgB,KAAhB,EAAuBD,IAAvB,EAAlC,CAAP,CACD,CARe,CAShBG,IAAI,CAAE,eAAM,CACV,MAAO,CACL9D,MAAM,GAAGiC,QAAT,CAAkB,CAAlB,CAAqB,OAArB,EAA8ByB,OAA9B,CAAsC,KAAtC,EAA6CC,IAA7C,EADK,CAEL3D,MAAM,GAAG4D,KAAT,CAAe,KAAf,EAAsBD,IAAtB,EAFK,CAAP,CAID,CAde,CAehBI,KAAK,CAAE,gBAAM,CACX,MAAO,CACL/D,MAAM,GAAGiC,QAAT,CAAkB,EAAlB,CAAsB,MAAtB,EAA8ByB,OAA9B,CAAsC,KAAtC,EAA6CC,IAA7C,EADK,CAEL3D,MAAM,GAAG4D,KAAT,CAAe,KAAf,EAAsBD,IAAtB,EAFK,CAAP,CAID,CApBe,CAqBhBK,MAAM,CAAE,iBAAM,IACNhC,CAAAA,IADM,CACOG,WADP,CACNH,IADM,CACAE,EADA,CACOC,WADP,CACAD,EADA,CAEZ,MAAO,CACLlC,MAAM,CAACgC,IAAD,CAAN,CAAa0B,OAAb,CAAqB,KAArB,EAA4BC,IAA5B,EADK,CAEL3D,MAAM,CAACkC,EAAD,CAAN,CAAW0B,KAAX,CAAiB,KAAjB,EAAwBD,IAAxB,EAFK,CAAP,CAID,CA3Be,CAAlB,CADgC,oBA+BbH,SAAS,CAAC1B,KAAD,CAAT,EA/Ba,oDA+BzBE,IA/ByB,qBA+BnBE,EA/BmB,qBAiChC;AACA,MAAOpC,CAAAA,MAAM,CAAC4B,KAAK,CAACD,IAAP,CAAa,SAACsB,CAAD,QAAOA,CAAAA,CAAC,CAACC,EAAF,EAAQhB,IAAR,EAAgBe,CAAC,CAACC,EAAF,CAAOd,EAA9B,EAAb,CAAb,CACD,CAnC0B,CAmCxB,CAACR,KAAK,CAACD,IAAP,CAAaU,WAAb,CAA0BL,KAA1B,CAnCwB,CAA3B,CAqCA;AAEE,GAAG,CAAC/B,OAAO,CAACwD,WAAD,CAAX,CAAyB,CACrB,mBAAQ,2BAAK,SAAS,CAAC,8BAAf,EAEI1D,GAAG,CAAC0D,WAAD,CAAc,SAAC5C,GAAD,CAAMsD,CAAN,CAAY,CACzB,mBACI,oBAAC,QAAD,EACI,GAAG,CAAEtD,GADT,CAEI,GAAG,CAAEsD,CAFT,CAGI,KAAK,CAAEA,CAHX,CAII,KAAK,CAAEtD,GAAG,CAACuD,UAJf,CAKI,IAAI,CAAEvD,GAAG,CAACsC,WALd,CAMI,KAAK,CAAEtC,GAAG,CAACwD,MANf,CAOI,MAAM,CAAExD,GAAG,CAACH,MAPhB,CAQI,QAAQ,CAAE,kBAAC4D,GAAD,QAASlD,CAAAA,SAAQ,CAACkD,GAAD,CAAjB,EARd,CASI,QAAQ,CAAE,kBAACA,GAAD,QAASxD,CAAAA,SAAQ,CAACwD,GAAD,CAAjB,EATd,CAUI,MAAM,CAAE5C,GAVZ,EADJ,CAcH,CAfE,CAFP,CAAR,CAqBH,CAED,mBAAQ,2BAAK,SAAS,CAAC,iBAAf,eACI,2BAAK,SAAS,CAAC,WAAf,EADJ,cAEI,2DAFJ,CAAR,CAMH,CA5ID,CA8IA,cAAeJ,CAAAA,iBAAf","sourcesContent":["import React, { useEffect, useState, useMemo } from \"react\";\r\nimport { map , filter ,isEmpty} from 'lodash'\r\nimport * as moment from \"moment\";\r\n\r\nimport { Service } from '../'\r\n\r\nimport { toDate } from \"../../../util\";\r\n\r\n\r\n\r\nconst CardItem = (props) => {\r\n    // console.log(props)\r\n    const {\r\n      label,\r\n      time,\r\n      value,\r\n      status,\r\n      index,\r\n      className,\r\n      obj,\r\n      onSetKey,\r\n      setKey,\r\n    } = props;\r\n    //成功 SUCCESS\r\n    //失败 FAILURE\r\n    //未审核 UNREVIEWED\r\n    //出款中 WITHDRAWING\r\n    //已审核 AUDITED\r\n    //汇款中 REMITTANCE\r\n  \r\n    let statusText = \"\";\r\n    let classStatus = \"\";\r\n    let cancel = false;\r\n    let fail = false;\r\n    if (status === \"成功\") {\r\n      statusText = \"成功\";\r\n      classStatus = \"success\";\r\n    }\r\n  \r\n    if (status === \"失败\") {\r\n      statusText = \"失败\";\r\n      classStatus = \"failure\";\r\n      fail = true;\r\n    }\r\n  \r\n    if (status === \"未审核\") {\r\n      statusText = \"未审核\";\r\n      classStatus = \"unreviewed\";\r\n      cancel = true;\r\n    }\r\n  \r\n    if (status === \"出款中\") {\r\n      statusText = \"出款中\";\r\n      classStatus = \"withdrawing\";\r\n    }\r\n  \r\n    if (status === \"汇款中\") {\r\n      statusText = \"汇款中\";\r\n      classStatus = \"remittance\";\r\n    }\r\n  \r\n    // if(status === \"已审核\"){\r\n    // \tstatusText = \"已审核\"\r\n    // \tclassStatus = \"audited\"\r\n    // }\r\n  \r\n    return (\r\n      <div\r\n        className={`withdrawal-history-card-item ${className ? className : \"\"}`}\r\n      >\r\n        <div className=\"cl-item withdrawal-history-card-text\">\r\n          <p className=\"cl-card-text\">{label}</p>\r\n          <p className=\"cl-card-time\">{time}</p>\r\n        </div>\r\n        <div className=\"cl-item withdrawal-history-card-value\">\r\n          {cancel && (\r\n            <span className=\"cancel\" onClick={() => props.onCancel(obj)}>\r\n              取消提款\r\n            </span>\r\n          )}\r\n          <p className=\"cl-card-amount\">\r\n            金额: <span>{value}</span>\r\n          </p>\r\n          <p className={`cl-card-status ${classStatus}`}>\r\n            <span>\r\n              {statusText}\r\n              {fail && (\r\n                <span className=\"fail\" onClick={() => onSetKey(index)}>\r\n                  {setKey === index && <span>{obj.verifyComment}</span>}\r\n                  <i />\r\n                </span>\r\n              )}\r\n            </span>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\nconst WithdrawalHistory = (props) => {\r\n  const { id ,refresh , onStop } = props\r\n\r\n  const [key, setKey] = useState(null);\r\n\r\n  const [items, setItems] = useState({\r\n    status: 0,\r\n    list: [],\r\n  });\r\n  const [load, setLoad] = useState(false);\r\n\r\n  const [range, setRange] = useState(\"today\");\r\n  const [customRange, setCustomRange] = useState({\r\n    from: moment().subtract(30, \"days\").toDate(),\r\n    to: moment().toDate(),\r\n  });\r\n\r\n  useEffect(() =>{\r\n    if(refresh == id ){\r\n      setLoad(true)\r\n    }\r\n  },[refresh])\r\n\r\n  useEffect(() => {\r\n    const fetch = () => {\r\n      const response = Service.Transaction.read({\r\n        ...Service.User.read(),\r\n        record_type: \"debit\",\r\n      });\r\n\r\n      response.promise.then(\r\n        (result) => {\r\n          // console.log(result);\r\n          if (result.status === 1) {\r\n            // setItems(result.info);\r\n            setItems({\r\n              status: 1,\r\n              list: result.info.map((t) => ({\r\n                ...t,\r\n                ts: toDate(t.requestTime, true),\r\n              })),\r\n            });\r\n            setLoad(false);\r\n            onStop()\r\n\r\n          }\r\n        },\r\n        (e) => {\r\n          console.log(\"Unable to response:\", e);\r\n        }\r\n      );\r\n    };\r\n    fetch();\r\n  }, [load]);\r\n\r\n  const onCancel = async (w) => {\r\n    console.log(w);\r\n    // const r = await Service.User.withdrawCancel({ id: w.id }).promise;\r\n    const response = await Service.User.withdrawCancel({ id: w.id }).promise;\r\n    // console.log(response);\r\n    if (response.status === 1) {\r\n      setLoad(true);\r\n    }\r\n  };\r\n\r\n  const onSetKey = (value) => {\r\n    setKey(null);\r\n    if (key !== value) setKey(value);\r\n  };\r\n\r\n\r\n  const __withdraws = useMemo(() => {\r\n    const _rangeMap = {\r\n      today: () => {\r\n        const today = moment();\r\n        return [today.startOf(\"day\").unix(), today.endOf(\"day\").unix()];\r\n      },\r\n      yesterday: () => {\r\n        const yesterday = moment().subtract(1, \"days\");\r\n        return [yesterday.startOf(\"day\").unix(), yesterday.endOf(\"day\").unix()];\r\n      },\r\n      week: () => {\r\n        return [\r\n          moment().subtract(1, \"weeks\").startOf(\"day\").unix(),\r\n          moment().endOf(\"day\").unix(),\r\n        ];\r\n      },\r\n      month: () => {\r\n        return [\r\n          moment().subtract(30, \"days\").startOf(\"day\").unix(),\r\n          moment().endOf(\"day\").unix(),\r\n        ];\r\n      },\r\n      custom: () => {\r\n        let { from, to } = customRange;\r\n        return [\r\n          moment(from).startOf(\"day\").unix(),\r\n          moment(to).endOf(\"day\").unix(),\r\n        ];\r\n      },\r\n    };\r\n\r\n    const [from, to] = _rangeMap[range]();\r\n\r\n    // return withdraws.list.filter((t) => t.ts >= from && t.ts < to);\r\n    return filter(items.list, (t) => t.ts >= from && t.ts < to);\r\n  }, [items.list, customRange, range]);\r\n\r\n  // console.log(__withdraws)\r\n\r\n    if(!isEmpty(__withdraws)){\r\n        return  <div className=\"withdrawal-history-card-body\">\r\n                    {\r\n                    map(__withdraws, (obj, i) => {\r\n                        return (\r\n                            <CardItem\r\n                                obj={obj}\r\n                                key={i}\r\n                                index={i}\r\n                                label={obj.cardNumber}\r\n                                time={obj.requestTime}\r\n                                value={obj.amount}\r\n                                status={obj.status}\r\n                                onCancel={(val) => onCancel(val)}\r\n                                onSetKey={(val) => onSetKey(val)}\r\n                                setKey={key}\r\n                          />\r\n                        );\r\n                    })\r\n                    }\r\n\r\n                </div>\r\n    }\r\n\r\n    return  <div className=\"no-transactions\">\r\n                <div className=\"image-box\" />\r\n                <span>暂无记录</span>\r\n            </div>\r\n\r\n\r\n}\r\n\r\nexport default WithdrawalHistory"]},"metadata":{},"sourceType":"module"}