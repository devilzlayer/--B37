{"ast":null,"code":"import _objectSpread from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{useHistory}from\"react-router-dom\";import QRCode from\"react-qr-code\";import{Wrap}from\"../view/profile/\";import{User,Transaction}from\"../../service/\";import{withAuth}from\"../util/\";import ToolTip from\"../component/ToolTip\";import\"../assets/scss/Referral.scss\";import{UIAlertSA}from\"../component\";var Referral=function Referral(){var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),tool=_useState2[0],setTool=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),modal=_useState4[0],setModal=_useState4[1];var _User$read=User.read(),account=_User$read.account;var qrLink=\"\".concat(window.location.origin,\"/?act=\").concat(account);var copyToClipboard=function copyToClipboard(e){// navigator.clipboard.writeText(qrLink);\nvar el=document.createElement(\"textarea\");el.value=qrLink;el.setAttribute(\"readonly\",\"\");el.style.position=\"absolute\";el.style.left=\"-9999px\";document.body.appendChild(el);el.select();document.execCommand(\"copy\");document.body.removeChild(el);setTool(true);};useEffect(function(){setTimeout(function(){setTool(false);},3000);},[tool]);var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),agents=_useState6[0],setAgents=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),promotions=_useState8[0],setPromotions=_useState8[1];useEffect(function(){var response=Transaction.read(_objectSpread({record_type:\"agent\"},User.read()));response.promise.then(function(r){console.log(\"Referral Agent List\",r);setAgents(r.info);},function(e){console.log(\"Unable to get records:\",e);});var res=Transaction.read(_objectSpread({record_type:\"promotions\"},User.read()));res.promise.then(function(r){console.log(\"Referral Promotions List\",r);setPromotions(r.info);},function(e){console.log(\"Unable to get records:\",e);});},[]);function referral(account,regTime){var req=User.referralGift(_objectSpread({act:\"applyFriendsPro\",acc:account,regTime:regTime},User.read()));req.promise.then(function(r){console.log(\"Referral Success!\");setModal(r.message);},function(e){console.log(\"Referral Fail!\",e);setModal(e);});}return/*#__PURE__*/React.createElement(Wrap,{className:\"referral-wrap\",centerName:\"\\u9080\\u8BF7\\u5956\\u52B1\",faq:false,sublevel:[true,function(){return history.goBack();}]},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-wrap-inner\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-wrap-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-link-caption\"},\"\\u60A8\\u7684\\u4E13\\u5C5E\\u63A8\\u8350\\u94FE\\u63A5\\u53CA\\u4E8C\\u7EF4\\u7801:\"),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-banner-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-banner\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-link-text\"},/*#__PURE__*/React.createElement(\"p\",null,qrLink),/*#__PURE__*/React.createElement(\"div\",{className:\"module-border-wrap\",onClick:copyToClipboard},/*#__PURE__*/React.createElement(\"div\",{className:\"module\"},/*#__PURE__*/React.createElement(ToolTip,{show:tool}),/*#__PURE__*/React.createElement(\"span\",null,\"\\u590D\\u5236\\u94FE\\u63A5\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-qr-code-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-qr-code-image\"},/*#__PURE__*/React.createElement(QRCode,{value:qrLink,size:155})),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-qr-code-text\"},/*#__PURE__*/React.createElement(\"p\",null,\"\\u4ED6\\u4EBA\\u626B\\u4E00\\u626B\\u4E8C\\u7EF4\\u7801\\u5373\\u53EF\\u6210\\u4E3A\\u60A8\\u7684\\u63A8\\u8350\\u597D\\u53CB\"),/*#__PURE__*/React.createElement(\"p\",{className:\"special\"},\"\\u8BF7\\u4F7F\\u7528\\u6D4F\\u89C8\\u5668\\u626B\\u63CF\\u4E8C\\u7EF4\\u7801(\\u5982UC,QQ\\u7B49\\u6D4F\\u89C8\\u5668)\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-caption\"},\"\\u597D\\u53CB\\u6CE8\\u518C\\u8BB0\\u5F55\"),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-head\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u597D\\u53CB\\u8D26\\u53F7\")),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u6CE8\\u518C\\u65F6\\u95F4\")),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text smaller\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u64CD\\u4F5C\"))),agents.length!==0?agents.map(function(_ref,i){var regTime=_ref.regTime,account=_ref.account;return/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-body\",key:i},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text\"},/*#__PURE__*/React.createElement(\"span\",null,account)),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text\"},/*#__PURE__*/React.createElement(\"span\",null,regTime)),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text special smaller\",onClick:function onClick(){return referral(account,regTime);}},/*#__PURE__*/React.createElement(\"span\",null,\"\\u7533\\u8BF7\\u793C\\u91D1\")));}):/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text large\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u6682\\u65E0\\u8BB0\\u5F55\"))))),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-caption\"},\"\\u597D\\u53CB\\u63A8\\u8350\\u5F69\\u91D1\\u7533\\u8BF7\\u8BB0\\u5F55 \"),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-head\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text xs\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u5F69\\u91D1\")),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text smaller\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u597D\\u53CB\\u8D26\\u53F7\")),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text smaller\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u7533\\u8BF7\\u72B6\\u6001\")),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text medium\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u7533\\u8BF7\\u65F6\\u95F4\")),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text xs\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u5907\\u6CE8\"))),promotions.length!==0?promotions.map(function(data,i){return/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-body\",key:i},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text xs\"},/*#__PURE__*/React.createElement(\"span\",null,data.apply_money)),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text smaller\"},/*#__PURE__*/React.createElement(\"span\",null,data.invite_person)),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text smaller\"},/*#__PURE__*/React.createElement(\"span\",null,data.state)),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text medium\"},/*#__PURE__*/React.createElement(\"span\",null,data.add_time)),/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text xs\"},/*#__PURE__*/React.createElement(\"span\",null,data.check_info?data.check_info:\"--\")));}):/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"referral-tab-text large\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\u6682\\u65E0\\u8BB0\\u5F55\"))))))),/*#__PURE__*/React.createElement(UIAlertSA,{onClose:function onClose(){return null;},shown:modal},/*#__PURE__*/React.createElement(\"div\",{className:\"game-sa-overlay\"},/*#__PURE__*/React.createElement(\"div\",{className:\"overlay-layer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form response\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-head\"},/*#__PURE__*/React.createElement(\"h2\",null,\"\\u63D0\\u793A\")),/*#__PURE__*/React.createElement(\"div\",{className:\"form-body\"},modal,/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return setModal(\"\");}},\"\\u786E\\u8BA4\")))))));};export default withAuth(Referral,1);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/ubet-project (1)/src/pwa/view/Referral.js"],"names":["React","useEffect","useState","useHistory","QRCode","Wrap","User","Transaction","withAuth","ToolTip","UIAlertSA","Referral","history","tool","setTool","modal","setModal","read","account","qrLink","window","location","origin","copyToClipboard","e","el","document","createElement","value","setAttribute","style","position","left","body","appendChild","select","execCommand","removeChild","setTimeout","agents","setAgents","promotions","setPromotions","response","record_type","promise","then","r","console","log","info","res","referral","regTime","req","referralGift","act","acc","message","goBack","length","map","i","data","apply_money","invite_person","state","add_time","check_info"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport QRCode from \"react-qr-code\";\r\n\r\nimport { Wrap } from \"../view/profile/\";\r\nimport { User, Transaction } from \"../../service/\";\r\nimport { withAuth } from \"../util/\";\r\nimport ToolTip from \"../component/ToolTip\";\r\n\r\nimport \"../assets/scss/Referral.scss\";\r\nimport { UIAlertSA } from \"../component\";\r\n\r\nconst Referral = () => {\r\n  const history = useHistory();\r\n  const [tool, setTool] = useState(false);\r\n  const [modal, setModal] = useState(\"\");\r\n\r\n  const { account } = User.read();\r\n\r\n  const qrLink = `${window.location.origin}/?act=${account}`;\r\n\r\n  const copyToClipboard = (e) => {\r\n    // navigator.clipboard.writeText(qrLink);\r\n    const el = document.createElement(\"textarea\");\r\n    el.value = qrLink;\r\n    el.setAttribute(\"readonly\", \"\");\r\n    el.style.position = \"absolute\";\r\n    el.style.left = \"-9999px\";\r\n    document.body.appendChild(el);\r\n    el.select();\r\n    document.execCommand(\"copy\");\r\n    document.body.removeChild(el);\r\n    setTool(true);\r\n  };\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      setTool(false);\r\n    }, 3000);\r\n  }, [tool]);\r\n\r\n  const [agents, setAgents] = useState([]);\r\n\r\n  const [promotions, setPromotions] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const response = Transaction.read({\r\n      record_type: \"agent\",\r\n      ...User.read(),\r\n    });\r\n    response.promise.then(\r\n      (r) => {\r\n        console.log(\"Referral Agent List\", r);\r\n        setAgents(r.info);\r\n      },\r\n      (e) => {\r\n        console.log(\"Unable to get records:\", e);\r\n      }\r\n    );\r\n\r\n    const res = Transaction.read({\r\n      record_type: \"promotions\",\r\n      ...User.read(),\r\n    });\r\n    res.promise.then(\r\n      (r) => {\r\n        console.log(\"Referral Promotions List\", r);\r\n        setPromotions(r.info);\r\n      },\r\n      (e) => {\r\n        console.log(\"Unable to get records:\", e);\r\n      }\r\n    );\r\n  }, []);\r\n\r\n  function referral(account, regTime) {\r\n    const req = User.referralGift({\r\n      act: \"applyFriendsPro\",\r\n      acc: account,\r\n      regTime: regTime,\r\n      ...User.read(),\r\n    });\r\n\r\n    req.promise.then(\r\n      (r) => {\r\n        console.log(\"Referral Success!\");\r\n        setModal(r.message);\r\n      },\r\n      (e) => {\r\n        console.log(\"Referral Fail!\", e);\r\n        setModal(e);\r\n      }\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Wrap\r\n      className=\"referral-wrap\"\r\n      centerName=\"邀请奖励\"\r\n      faq={false}\r\n      sublevel={[true, () => history.goBack()]}\r\n    >\r\n      <div className=\"referral-wrap-inner\">\r\n        <div className=\"referral-wrap-content\">\r\n          <div className=\"referral-link-caption\">您的专属推荐链接及二维码:</div>\r\n          <div className=\"referral-banner-wrap\">\r\n            <div className=\"referral-banner\" />\r\n          </div>\r\n\r\n          <div className=\"referral-link-text\">\r\n            <p>{qrLink}</p>\r\n            <div className=\"module-border-wrap\" onClick={copyToClipboard}>\r\n              <div className=\"module\">\r\n                <ToolTip show={tool} />\r\n                <span>复制链接</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"referral-qr-code-wrap\">\r\n            <div className=\"referral-qr-code-image\">\r\n              <QRCode value={qrLink} size={155} />\r\n            </div>\r\n            <div className=\"referral-qr-code-text\">\r\n              <p>他人扫一扫二维码即可成为您的推荐好友</p>\r\n              <p className=\"special\">请使用浏览器扫描二维码(如UC,QQ等浏览器)</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"referral-tab\">\r\n            <div className=\"referral-tab-caption\">好友注册记录</div>\r\n            <div className=\"referral-tab-wrap\">\r\n              <div className=\"referral-tab-head\">\r\n                <div className=\"referral-tab-text\">\r\n                  <span>好友账号</span>\r\n                </div>\r\n                <div className=\"referral-tab-text\">\r\n                  <span>注册时间</span>\r\n                </div>\r\n                <div className=\"referral-tab-text smaller\">\r\n                  <span>操作</span>\r\n                </div>\r\n              </div>\r\n\r\n              {agents.length !== 0 ? (\r\n                agents.map(({ regTime, account }, i) => (\r\n                  <div className=\"referral-tab-body\" key={i}>\r\n                    <div className=\"referral-tab-text\">\r\n                      <span>{account}</span>\r\n                    </div>\r\n                    <div className=\"referral-tab-text\">\r\n                      <span>{regTime}</span>\r\n                    </div>\r\n                    <div\r\n                      className=\"referral-tab-text special smaller\"\r\n                      onClick={() => referral(account, regTime)}\r\n                    >\r\n                      <span>申请礼金</span>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <div className=\"referral-tab-body\">\r\n                  <div className=\"referral-tab-text large\">\r\n                    <span>暂无记录</span>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"referral-tab\">\r\n            <div className=\"referral-tab-caption\">好友推荐彩金申请记录 </div>\r\n            <div className=\"referral-tab-wrap\">\r\n              <div className=\"referral-tab-head\">\r\n                <div className=\"referral-tab-text xs\">\r\n                  <span>彩金</span>\r\n                </div>\r\n                <div className=\"referral-tab-text smaller\">\r\n                  <span>好友账号</span>\r\n                </div>\r\n                <div className=\"referral-tab-text smaller\">\r\n                  <span>申请状态</span>\r\n                </div>\r\n                <div className=\"referral-tab-text medium\">\r\n                  <span>申请时间</span>\r\n                </div>\r\n                <div className=\"referral-tab-text xs\">\r\n                  <span>备注</span>\r\n                </div>\r\n              </div>\r\n\r\n              {promotions.length !== 0 ? (\r\n                promotions.map((data, i) => (\r\n                  <div className=\"referral-tab-body\" key={i}>\r\n                    <div className=\"referral-tab-text xs\">\r\n                      <span>{data.apply_money}</span>\r\n                    </div>\r\n                    <div className=\"referral-tab-text smaller\">\r\n                      <span>{data.invite_person}</span>\r\n                    </div>\r\n                    <div className=\"referral-tab-text smaller\">\r\n                      <span>{data.state}</span>\r\n                    </div>\r\n                    <div className=\"referral-tab-text medium\">\r\n                      <span>{data.add_time}</span>\r\n                    </div>\r\n                    <div className=\"referral-tab-text xs\">\r\n                      <span>{data.check_info ? data.check_info : \"--\"}</span>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <div className=\"referral-tab-body\">\r\n                  <div className=\"referral-tab-text large\">\r\n                    <span>暂无记录</span>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <UIAlertSA onClose={() => null} shown={modal}>\r\n        <div className={`game-sa-overlay`}>\r\n          <div className=\"overlay-layer\">\r\n            <div className=\"form response\">\r\n              <div className=\"form-head\">\r\n                <h2>提示</h2>\r\n              </div>\r\n              <div className=\"form-body\">\r\n                {modal}\r\n                <button onClick={() => setModal(\"\")}>确认</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </UIAlertSA>\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default withAuth(Referral, 1);\r\n"]},"metadata":{},"sourceType":"module"}