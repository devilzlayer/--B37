{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Documents/New PWA/GIT/src/pwa/view/profile/personal/Birthdate.js\";\nimport React, { useState, useEffect, useMemo, useContext, useCallback } from \"react\";\nimport Picker from \"react-mobile-picker\";\nimport { mobileModel } from \"react-device-detect\";\nimport { useHistory } from \"react-router-dom\";\nimport { Wrap, Service } from \"../\";\nimport { getDates } from \"../../../../util\";\n\nconst Birthdate = () => {\n  const history = useHistory();\n  const {\n    userAuth: {\n      data\n    },\n    setUserAuthFN\n  } = useContext(Service.User.Context);\n  const [birthday, setBirthday] = useState({\n    year: 1989,\n    month: 8,\n    day: 12\n  });\n  const form = {\n    realname: data.realName,\n    phone: data.telephone,\n    email: data.email,\n    qq: data.qq,\n    wechat: data.wechat || \"\",\n    device: mobileModel,\n    //\"Huawei Mate 20 Pro\",\n    updates: [{\n      text: \"4.14.116\"\n    }, {\n      text: \"Thu Apr 30 18:27:58 CSTt 2020\"\n    }]\n  };\n  const [active, setActive] = useState(false);\n  const [disabled, setDisabled] = useState(false);\n  useEffect(() => {\n    if (birthday !== \"\") setActive(true);else setActive(false);\n  }, [birthday]);\n\n  const _dates = useMemo(() => getDates({\n    date: birthday,\n    year: [18, 150]\n  }), [birthday]);\n\n  const _dateFormat = useCallback(date => date.year ? `${date.year}年${date.month}月${date.day}日` : \"请选择一个日期\", []);\n\n  const update = () => {\n    console.info(\"You're updating account's birthdate:\", birthday);\n    Service.User.update({ ...form,\n      ...Service.User.read(),\n      birthday: _dateFormat(birthday)\n    }).promise.then(r => {\n      console.info(\"✅ You have successfully updated account's birthdate:\", r.info);\n      setActive(false);\n      setDisabled(true);\n      Service.User.session({ ...Service.User.read()\n      }).promise.then(r => setUserAuthFN(1, r.info));\n    }, e => {\n      console.warn(\"Unable to update account's birthdate:\", e);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(Wrap, {\n    className: \"profile-birthdate\",\n    name: \"\\u7528\\u4E8E\\u53D1\\u653E\\u751F\\u65E5\\u793C\\u91D1\",\n    sublevel: [true, () => history.goBack()],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 5\n    }\n  }, disabled && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"profile-valid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 20\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: `date-select-overlay`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-selected\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `date-year`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: `date-month`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: `date-day`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Picker, {\n    height: 260,\n    valueGroups: birthday,\n    optionGroups: { ..._dates\n    },\n    onChange: (k, v) => setBirthday({ ...birthday,\n      [k]: v\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `form-button ${active && !disabled && \"form-button-active\"}`,\n    onClick: active && !disabled ? update : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 11\n    }\n  }, \"\\u63D0\\u4EA4\"))));\n};\n\nexport default Birthdate;","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/pwa/view/profile/personal/Birthdate.js"],"names":["React","useState","useEffect","useMemo","useContext","useCallback","Picker","mobileModel","useHistory","Wrap","Service","getDates","Birthdate","history","userAuth","data","setUserAuthFN","User","Context","birthday","setBirthday","year","month","day","form","realname","realName","phone","telephone","email","qq","wechat","device","updates","text","active","setActive","disabled","setDisabled","_dates","date","_dateFormat","update","console","info","read","promise","then","r","session","e","warn","goBack","k","v"],"mappings":"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","sourcesContent":["import React, {\r\n  useState,\r\n  useEffect,\r\n  useMemo,\r\n  useContext,\r\n  useCallback,\r\n} from \"react\";\r\nimport Picker from \"react-mobile-picker\";\r\nimport { mobileModel } from \"react-device-detect\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nimport { Wrap, Service } from \"../\";\r\nimport { getDates } from \"../../../../util\";\r\n\r\nconst Birthdate = () => {\r\n  const history = useHistory();\r\n\r\n  const {\r\n    userAuth: { data },\r\n    setUserAuthFN,\r\n  } = useContext(Service.User.Context);\r\n\r\n  const [birthday, setBirthday] = useState({\r\n    year: 1989,\r\n    month: 8,\r\n    day: 12,\r\n  });\r\n  const form = {\r\n    realname: data.realName,\r\n    phone: data.telephone,\r\n    email: data.email,\r\n    qq: data.qq,\r\n    wechat: data.wechat || \"\",\r\n    device: mobileModel, //\"Huawei Mate 20 Pro\",\r\n    updates: [{ text: \"4.14.116\" }, { text: \"Thu Apr 30 18:27:58 CSTt 2020\" }],\r\n  };\r\n\r\n  const [active, setActive] = useState(false);\r\n  const [disabled, setDisabled] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (birthday !== \"\") setActive(true);\r\n    else setActive(false);\r\n  }, [birthday]);\r\n\r\n  const _dates = useMemo(() => getDates({ date: birthday, year: [18, 150] }), [\r\n    birthday,\r\n  ]);\r\n\r\n  const _dateFormat = useCallback(\r\n    (date) =>\r\n      date.year\r\n        ? `${date.year}年${date.month}月${date.day}日`\r\n        : \"请选择一个日期\",\r\n    []\r\n  );\r\n\r\n  const update = () => {\r\n    console.info(\"You're updating account's birthdate:\", birthday);\r\n\r\n    Service.User.update({\r\n      ...form,\r\n      ...Service.User.read(),\r\n      birthday: _dateFormat(birthday),\r\n    }).promise.then(\r\n      (r) => {\r\n        console.info(\r\n          \"✅ You have successfully updated account's birthdate:\",\r\n          r.info\r\n        );\r\n        setActive(false);\r\n        setDisabled(true);\r\n\r\n        Service.User.session({\r\n          ...Service.User.read(),\r\n        }).promise.then((r) => setUserAuthFN(1, r.info));\r\n      },\r\n      (e) => {\r\n        console.warn(\"Unable to update account's birthdate:\", e);\r\n      }\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Wrap\r\n      className=\"profile-birthdate\"\r\n      name=\"用于发放生日礼金\"\r\n      sublevel={[true, () => history.goBack()]}\r\n    >\r\n      {disabled && <span className=\"profile-valid\" />}\r\n      <div className={`date-select-overlay`}>\r\n        <div className=\"picker-body\">\r\n          <div className=\"picker-selected\">\r\n            <span className={`date-year`} />\r\n            <span className={`date-month`} />\r\n            <span className={`date-day`} />\r\n          </div>\r\n          <Picker\r\n            height={260}\r\n            valueGroups={birthday}\r\n            optionGroups={{ ..._dates }}\r\n            onChange={(k, v) => setBirthday({ ...birthday, [k]: v })}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div className=\"submit\">\r\n        <div\r\n          className={`form-button ${\r\n            active && !disabled && \"form-button-active\"\r\n          }`}\r\n          onClick={active && !disabled ? update : null}\r\n        >\r\n          <span>提交</span>\r\n        </div>\r\n      </div>\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default Birthdate;\r\n"]},"metadata":{},"sourceType":"module"}