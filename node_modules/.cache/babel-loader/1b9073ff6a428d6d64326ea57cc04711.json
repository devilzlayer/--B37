{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Documents/New PWA/GIT/src/view/profile/Transfer.js\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport Picker from \"react-mobile-picker\";\nimport cx from \"classnames\";\nimport BigNumber from \"bignumber.js\";\nimport { map, toInteger, isNumber } from 'lodash'; // import { UIAlert } from \"../../component\";\n\nimport { User, Game } from \"../../service\";\nimport { withAuth } from \"../../util\";\nimport Wrap from \"./Wrap\";\nimport \"../../assets/scss/profile/Transfer.scss\";\n\nconst Transfer = () => {\n  const {\n    userAuth,\n    setUserAuthFN\n  } = useContext(User.Context);\n  const [balances, setBalances] = useState({\n    from: [],\n    to: []\n  });\n  const [balancesFill, setBalancesFill] = useState({\n    wallet: [],\n    games: []\n  });\n  const [balancesRaw, setBalancesRaw] = useState([]);\n  const [balanceTransferred, setBalanceTransferred] = useState(false);\n  const [balanceLoad, setBalanceLoad] = useState(false);\n  const [balanceUpdateI, setBalanceUpdateI] = useState(0);\n  const [balancesMap, setBalancesMap] = useState({});\n  const [balanceOver, setBalanceOver] = useState(null);\n  const [balanceForm, setBalanceForm] = useState({\n    from: null,\n    to: null,\n    amount: \"\"\n  });\n  const [balanceTime, setBalanceTime] = useState(false);\n  useEffect(() => {\n    setBalances({\n      from: [],\n      to: []\n    });\n    setBalancesMap({});\n    setBalancesFill({\n      wallet: [],\n      games: []\n    });\n    Game.balances({ ...User.read()\n    }).then(_balances => {\n      setBalancesRaw(_balances.filter(b => !b.error)); // const __balances = _balances.map(b => `${b.game.name}: ${b.balance} ¥`);\n      // \t\t\t__balances.unshift(`中央钱包: ${userAuth.data.balance} ¥`);\n\n      const __balances = _balances.filter(b => !b.error).map(b => `${b.game.name}`);\n\n      __balances.unshift(`中心钱包`);\n\n      const _bFillWallet = [`中心钱包`];\n\n      const _bFillGames = _balances.filter(b => !b.error).map(b => b.game.name);\n\n      setBalancesFill({\n        wallet: _bFillWallet,\n        games: _bFillGames\n      });\n      setBalanceForm(balanceForm => ({ ...balanceForm,\n        from: __balances[0],\n        to: __balances[1]\n      }));\n      setBalances({\n        from: __balances,\n        // to: __balances,\n        to: _bFillGames\n      });\n      const __balancesMap = {};\n\n      _balances.filter(b => !b.error).forEach(b => {\n        __balancesMap[b.game.name] = b;\n      });\n\n      __balancesMap[\"中心钱包\"] = {\n        game: {\n          id: 0,\n          name: \"wallet\"\n        },\n        wallet: true,\n        balance: +userAuth.data.balance\n      };\n      setBalancesMap(__balancesMap);\n    });\n  }, [balanceUpdateI, userAuth.data.balance]);\n  useEffect(() => {\n    User.session({ ...User.read()\n    }).promise.then(r => setUserAuthFN(1, r.info));\n    setBalanceForm(bf => ({ ...bf,\n      amount: \"\"\n    })); // eslint-disable-next-line\n  }, [balanceUpdateI]);\n  const AmountVariants = [100, 500, 1000, 2000, 5000];\n\n  const PickerWrap = ({\n    dist\n  }) => {\n    // console.log( dist )\n    // console.log( balances[dist] )\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"picker-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"bank-picker-body-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 15\n      }\n    }, balances[dist].length && map(balances[dist], (obj, i) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: i,\n        className: `bank-picker-item ${balanceForm[dist] === obj ? 'active' : ''}`,\n        onClick: () => {\n          if (dist === \"from\") {\n            const _d = balancesMap[obj].wallet ? \"games\" : \"wallet\";\n\n            setBalances(b => ({ ...b,\n              to: balancesFill[_d]\n            }));\n            setBalanceForm(bf => ({ ...bf,\n              to: balancesFill[_d][0]\n            }));\n          }\n\n          setBalanceForm(bf => ({ ...bf,\n            [dist]: obj\n          }));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 27\n        }\n      }, obj);\n    }) // <Picker\n    //   height={180}\n    //   valueGroups={{ [dist]: balanceForm[dist] }}\n    //   optionGroups={{ [dist]: balances[dist] }}\n    //   onChange={(key, value) => {\n    //     console.log(value)\n    //     if (dist === \"from\") {\n    //       console.log(key,value)\n    //       const _d = balancesMap[value].wallet ? \"games\" : \"wallet\";\n    //       setBalances((b) => ({\n    //         ...b,\n    //         to: balancesFill[_d],\n    //       }));\n    //       setBalanceForm((bf) => ({\n    //         ...bf,\n    //         to: balancesFill[_d][0],\n    //       }));\n    //     }\n    //     setBalanceForm((bf) => ({\n    //       ...bf,\n    //       [key]: value,\n    //     }));\n    //   }}\n    // />\n    ));\n  };\n\n  const swap = () => {\n    const [to, from] = [balanceForm.from, balanceForm.to];\n\n    const _d1 = balancesMap[from].wallet ? \"games\" : \"wallet\";\n\n    const _d2 = balancesMap[to].wallet ? \"games\" : \"wallet\";\n\n    setBalances(b => ({ ...b,\n      to: balancesFill[_d1],\n      from: balancesFill[_d2]\n    }));\n    setBalanceForm(bf => ({ ...bf,\n      to,\n      from\n    }));\n  };\n\n  const setAmount = e => {\n    const amount = e.target ? e.target.value : e;\n    setBalanceForm(form => ({ ...form,\n      amount\n    }));\n  };\n\n  const setMax = () => {\n    const _game = balancesMap[balanceForm.from];\n    let _max = _game.balance;\n\n    if (_game.wallet) {\n      _max = userAuth.data.balance;\n    }\n\n    setAmount(Math.floor(_max));\n  };\n\n  const onlyNumbers = e => {\n    const {\n      value\n    } = e.currentTarget;\n    let regexp = /^[0-9\\b]+$/;\n\n    if (!value || regexp.test(value)) {\n      setAmount(value);\n    }\n  };\n\n  const transfer = e => {\n    if (!balanceForm.amount || isNaN(+balanceForm.amount)) {\n      setUserAuthFN(userAuth.status, userAuth.data, {\n        text: \"系统提示\",\n        message: \"没有金额\"\n      });\n      return void console.warn(\"[transfer] No amount\");\n    }\n\n    const _getMap = n => balancesMap[n.split(\": \")[0]] || null;\n\n    const _from = _getMap(balanceForm.from);\n\n    const _to = _getMap(balanceForm.to);\n\n    if (_from.game.id === _to.game.id) {\n      setUserAuthFN(userAuth.status, userAuth.data, {\n        text: \"系统提示\",\n        message: \"同一个游戏\"\n      });\n      return void console.warn(\"[transfer] Same game\");\n    }\n\n    if (_from.balance === 0) {\n      setUserAuthFN(userAuth.status, userAuth.data, {\n        text: \"系统提示\",\n        message: \"零余额\"\n      });\n      return void console.warn(\"[transfer] Zero balance\");\n    }\n\n    if (_from.balance < +balanceForm.amount) {\n      setUserAuthFN(userAuth.status, userAuth.data, {\n        text: \"系统提示\",\n        message: \"余额不足\"\n      });\n      return void console.warn(\"[transfer] Not enough game balance\");\n    }\n\n    console.info(`You're transfering ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}`);\n    setBalanceLoad(true);\n    Game.transfer({ ...User.read(),\n      amount: +balanceForm.amount,\n      from: _from.game.id,\n      to: _to.game.id\n    }).then(r => {\n      console.info(`You have successfully transferred ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}: ${r.info}`);\n      setBalanceLoad(false);\n      setBalanceTransferred(true);\n    }, e => {\n      console.error(e);\n      setUserAuthFN(userAuth.status, userAuth.data, {\n        text: \"系统提示\",\n        message: e\n      });\n      setBalanceLoad(false);\n    });\n  };\n\n  const wallet = _e => {\n    setBalanceTime(true);\n    setBalanceLoad(true);\n    Game.transferToWallet().promise.then(r => {\n      setBalanceLoad(false);\n      setBalanceTransferred(true);\n    }, e => {\n      console.warn(e);\n      setUserAuthFN(userAuth.status, userAuth.data, {\n        text: \"系统提示\",\n        message: e\n      });\n      setBalanceLoad(false);\n    });\n    setTimeout(() => {\n      setBalanceTime(false);\n    }, 10000);\n  };\n\n  const onTransferPerGame = obj => {\n    const _from = {\n      id: 0,\n      name: 'wallet'\n    };\n    const _to = obj; // console.log(userAuth.data.balance,Math.floor(userAuth.data.balance) , _from , _to) \n    // return false\n\n    console.info(`You are transferring ${Math.floor(userAuth.data.balance)} ¥ from ${_from.name} to ${_to.game.name}`);\n    Game.transfer({ ...User.read(),\n      amount: Math.floor(userAuth.data.balance),\n      from: _from.id,\n      to: _to.game.id\n    }).then(r => {\n      console.info(`You have successfully transferred ${Math.floor(userAuth.data.balance)} ¥ from ${_from.name} to ${_to.game.name}: ${r.info}`);\n      setBalanceLoad(false);\n      setBalanceTransferred(true);\n    }, e => {\n      console.error(e);\n      setUserAuthFN(userAuth.status, userAuth.data, {\n        text: \"系统提示\",\n        message: e\n      });\n      setBalanceLoad(false);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(Wrap, {\n    className: \"transfer-desktop\",\n    title: \"转账\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profile-section section-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"user-balance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"user-balance-wrap wallet\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 11\n    }\n  }, \"\\u4E2D\\u5FC3\\u94B1\\u5305 :\", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"user-balance-amount\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 13\n    }\n  }, \"\\xA5\", BigNumber(userAuth.data.balance).toFormat(2))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"user-balance-wrap refresh\",\n    onClick: !balanceLoad && !balanceTime ? wallet : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"user-balance-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 13\n    }\n  }, \"\\u4E00\\u952E\\u56DE\\u6536\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"transfer-hr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"balances-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 9\n    }\n  }, balancesRaw.map((balance, i) => /*#__PURE__*/React.createElement(\"div\", {\n    key: i,\n    className: \"balances-list--item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"game-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 15\n    }\n  }, balance.game.name), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"game-balance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 15\n    }\n  }, BigNumber(balance.balance).toFormat(2)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"game-button\",\n    onClick: !balanceLoad && !balanceTime ? () => onTransferPerGame(balance) : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 15\n    }\n  }, \"\\u4E00\\u952E\\u8F6C\\u5165\"))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"profile-section section-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field-section\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field--doubler\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 15\n    }\n  }, \"\\u63A8\\u51FA\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input--wrap with-dot\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(\"input-like\", {\n      \"has-value\": balanceForm.from\n    }),\n    onClick: e => setBalanceOver(\"from\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 17\n    }\n  }, balanceForm.from || \"推出\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field-swap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => swap(),\n    id: \"swapButton\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 15\n    }\n  }, \"\\u8FDB\\u5165\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input--wrap with-dot\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 432,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(\"input-like\", {\n      \"has-value\": balanceForm.to\n    }),\n    onClick: e => setBalanceOver(\"to\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 17\n    }\n  }, balanceForm.to || \"进入\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field with-max\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"amount-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"input--wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 17\n    }\n  }, \"\\uFFE5\"), /*#__PURE__*/React.createElement(\"input\", {\n    id: \"amount\",\n    type: \"text\",\n    placeholder: \"\\u91D1\\u989D\" // pattern=\"[0-9]*\"\n    ,\n    className: cx({\n      \"has-value\": balanceForm.amount\n    }),\n    value: balanceForm.amount,\n    onChange: e => onlyNumbers(e) // onKeyDown={(e) => onlyNumbers(e)}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 449,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"amount-max-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 461,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    id: \"maxButton\",\n    className: cx({\n      disabled: !balancesMap[balanceForm.from] || !balancesMap[balanceForm.from].balance\n    }),\n    onClick: () => setMax(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 462,\n      columnNumber: 15\n    }\n  }, \"\\u6700\\u5927\\u91D1\\u989D\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field-section bottom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 477,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-field amount-variants\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 478,\n      columnNumber: 11\n    }\n  }, AmountVariants.map((amount, i) => /*#__PURE__*/React.createElement(\"button\", {\n    id: \"amountVariants\",\n    key: i,\n    className: cx(\"amount-variant\", {\n      disabled: amount > userAuth.data.balance\n    }),\n    onClick: () => setAmount(amount),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 480,\n      columnNumber: 15\n    }\n  }, amount))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 492,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: transfer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 493,\n      columnNumber: 13\n    }\n  }, \"\\u7ACB\\u5373\\u8F6C\\u8D26\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: `modal-container ${balanceOver ? \"shown\" : null}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 497,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `game-sa-overlay picker-over`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 498,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 499,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 501,\n      columnNumber: 17\n    }\n  }, balanceOver === \"from\" ? \"推出\" : \"进入\")), balanceOver && /*#__PURE__*/React.createElement(PickerWrap, {\n    dist: balanceOver,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 504,\n      columnNumber: 31\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"picker-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 507,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: e => setBalanceOver(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 15\n    }\n  }, \"\\u53D6\\u6D88\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"active\",\n    onClick: e => setBalanceOver(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 509,\n      columnNumber: 15\n    }\n  }, \"\\u786E\\u5B9A\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: `modal-container ${balanceTransferred ? \"shown\" : null}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 516,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `game-sa-overlay`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 519,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"overlay-layer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 520,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form response\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 521,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 522,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 523,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 524,\n      columnNumber: 19\n    }\n  }, \"\\u8F6C\\u8D26\\u6210\\u529F\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 526,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => {\n      setBalanceTransferred(false);\n      setBalanceUpdateI(i => i + 1);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 527,\n      columnNumber: 19\n    }\n  }, \"\\u786E\\u8BA4\"))))))));\n};\n\nexport default withAuth(Transfer, 1);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/view/profile/Transfer.js"],"names":["React","useEffect","useState","useContext","Picker","cx","BigNumber","map","toInteger","isNumber","User","Game","withAuth","Wrap","Transfer","userAuth","setUserAuthFN","Context","balances","setBalances","from","to","balancesFill","setBalancesFill","wallet","games","balancesRaw","setBalancesRaw","balanceTransferred","setBalanceTransferred","balanceLoad","setBalanceLoad","balanceUpdateI","setBalanceUpdateI","balancesMap","setBalancesMap","balanceOver","setBalanceOver","balanceForm","setBalanceForm","amount","balanceTime","setBalanceTime","read","then","_balances","filter","b","error","__balances","game","name","unshift","_bFillWallet","_bFillGames","__balancesMap","forEach","id","balance","data","session","promise","r","info","bf","AmountVariants","PickerWrap","dist","length","obj","i","_d","swap","_d1","_d2","setAmount","e","target","value","form","setMax","_game","_max","Math","floor","onlyNumbers","currentTarget","regexp","test","transfer","isNaN","status","text","message","console","warn","_getMap","n","split","_from","_to","_e","transferToWallet","setTimeout","onTransferPerGame","toFormat","disabled"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\r\nimport Picker from \"react-mobile-picker\";\r\nimport cx from \"classnames\";\r\nimport BigNumber from \"bignumber.js\";\r\nimport { map  ,toInteger , isNumber} from 'lodash'\r\n// import { UIAlert } from \"../../component\";\r\nimport { User, Game } from \"../../service\";\r\nimport { withAuth } from \"../../util\";\r\nimport Wrap from \"./Wrap\";\r\n\r\nimport \"../../assets/scss/profile/Transfer.scss\";\r\n\r\nconst Transfer = () => {\r\n  const { userAuth, setUserAuthFN } = useContext(User.Context);\r\n\r\n  const [balances, setBalances] = useState({\r\n    from: [],\r\n    to: [],\r\n  });\r\n\r\n  const [balancesFill, setBalancesFill] = useState({\r\n    wallet: [],\r\n    games: [],\r\n  });\r\n\r\n  const [balancesRaw, setBalancesRaw] = useState([]);\r\n\r\n  const [balanceTransferred, setBalanceTransferred] = useState(false);\r\n  const [balanceLoad, setBalanceLoad] = useState(false);\r\n  const [balanceUpdateI, setBalanceUpdateI] = useState(0);\r\n  const [balancesMap, setBalancesMap] = useState({});\r\n  const [balanceOver, setBalanceOver] = useState(null);\r\n  const [balanceForm, setBalanceForm] = useState({\r\n    from: null,\r\n    to: null,\r\n    amount: \"\",\r\n  });\r\n  const [balanceTime, setBalanceTime] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setBalances({\r\n      from: [],\r\n      to: [],\r\n    });\r\n\r\n    setBalancesMap({});\r\n\r\n    setBalancesFill({\r\n      wallet: [],\r\n      games: [],\r\n    });\r\n\r\n    Game.balances({\r\n      ...User.read(),\r\n    }).then((_balances) => {\r\n      setBalancesRaw(_balances.filter((b) => !b.error));\r\n\r\n      // const __balances = _balances.map(b => `${b.game.name}: ${b.balance} ¥`);\r\n      // \t\t\t__balances.unshift(`中央钱包: ${userAuth.data.balance} ¥`);\r\n      const __balances = _balances\r\n        .filter((b) => !b.error)\r\n        .map((b) => `${b.game.name}`);\r\n      __balances.unshift(`中心钱包`);\r\n\r\n      const _bFillWallet = [`中心钱包`];\r\n      const _bFillGames = _balances\r\n        .filter((b) => !b.error)\r\n        .map((b) => b.game.name);\r\n\r\n      setBalancesFill({\r\n        wallet: _bFillWallet,\r\n        games: _bFillGames,\r\n      });\r\n\r\n      setBalanceForm((balanceForm) => ({\r\n        ...balanceForm,\r\n        from: __balances[0],\r\n        to: __balances[1],\r\n      }));\r\n\r\n      setBalances({\r\n        from: __balances,\r\n        // to: __balances,\r\n        to: _bFillGames,\r\n      });\r\n\r\n      const __balancesMap = {};\r\n\r\n      _balances\r\n        .filter((b) => !b.error)\r\n        .forEach((b) => {\r\n          __balancesMap[b.game.name] = b;\r\n        });\r\n\r\n      __balancesMap[\"中心钱包\"] = {\r\n        game: {\r\n          id: 0,\r\n          name: \"wallet\",\r\n        },\r\n        wallet: true,\r\n        balance: +userAuth.data.balance,\r\n      };\r\n\r\n      setBalancesMap(__balancesMap);\r\n    });\r\n  }, [balanceUpdateI, userAuth.data.balance]);\r\n\r\n  useEffect(() => {\r\n    User.session({\r\n      ...User.read(),\r\n    }).promise.then((r) => setUserAuthFN(1, r.info));\r\n\r\n    setBalanceForm((bf) => ({\r\n      ...bf,\r\n      amount: \"\",\r\n    }));\r\n\r\n    // eslint-disable-next-line\r\n  }, [balanceUpdateI]);\r\n\r\n  const AmountVariants = [100, 500, 1000, 2000, 5000];\r\n\r\n  const PickerWrap = ({ dist }) => {\r\n    // console.log( dist )\r\n    // console.log( balances[dist] )\r\n    return  <div className=\"picker-wrap\">\r\n              <div className=\"bank-picker-body-wrap\">\r\n              {balances[dist].length &&\r\n                map( balances[dist] , (obj , i) =>{\r\n                  return  <div key={i} className={`bank-picker-item ${balanceForm[dist] === obj ? 'active' : ''}`}\r\n                            onClick={()=>{\r\n                              if (dist === \"from\") {\r\n                                const _d = balancesMap[obj].wallet ? \"games\" : \"wallet\";\r\n          \r\n                                setBalances((b) => ({\r\n                                  ...b,\r\n                                  to: balancesFill[_d],\r\n                                }));\r\n          \r\n                                setBalanceForm((bf) => ({\r\n                                  ...bf,\r\n                                  to: balancesFill[_d][0],\r\n                                }));\r\n                              }\r\n                              setBalanceForm((bf) => ({\r\n                                ...bf,\r\n                                [dist] : obj,\r\n                              }));\r\n                              \r\n                            }}\r\n                          >\r\n                            {obj}\r\n                          </div>\r\n                })\r\n                // <Picker\r\n                //   height={180}\r\n                //   valueGroups={{ [dist]: balanceForm[dist] }}\r\n                //   optionGroups={{ [dist]: balances[dist] }}\r\n                //   onChange={(key, value) => {\r\n                //     console.log(value)\r\n                //     if (dist === \"from\") {\r\n                //       console.log(key,value)\r\n                //       const _d = balancesMap[value].wallet ? \"games\" : \"wallet\";\r\n\r\n                //       setBalances((b) => ({\r\n                //         ...b,\r\n                //         to: balancesFill[_d],\r\n                //       }));\r\n\r\n                //       setBalanceForm((bf) => ({\r\n                //         ...bf,\r\n                //         to: balancesFill[_d][0],\r\n                //       }));\r\n                //     }\r\n\r\n                //     setBalanceForm((bf) => ({\r\n                //       ...bf,\r\n                //       [key]: value,\r\n                //     }));\r\n                //   }}\r\n                // />\r\n\r\n              }\r\n              </div>\r\n              \r\n            </div>\r\n  }\r\n    \r\n  \r\n\r\n  const swap = () => {\r\n    const [to, from] = [balanceForm.from, balanceForm.to];\r\n\r\n    const _d1 = balancesMap[from].wallet ? \"games\" : \"wallet\";\r\n    const _d2 = balancesMap[to].wallet ? \"games\" : \"wallet\";\r\n\r\n    setBalances((b) => ({\r\n      ...b,\r\n      to: balancesFill[_d1],\r\n      from: balancesFill[_d2],\r\n    }));\r\n\r\n    setBalanceForm((bf) => ({\r\n      ...bf,\r\n      to,\r\n      from,\r\n    }));\r\n  };\r\n\r\n  const setAmount = (e) => {\r\n    const amount = e.target ? e.target.value : e;\r\n\r\n    setBalanceForm((form) => ({ ...form, amount }));\r\n  };\r\n\r\n  const setMax = () => {\r\n    const _game = balancesMap[balanceForm.from];\r\n\r\n    let _max = _game.balance;\r\n\r\n    if (_game.wallet) {\r\n      _max = userAuth.data.balance;\r\n    }\r\n\r\n    setAmount( Math.floor(_max) );\r\n  };\r\n\r\n  const onlyNumbers = (e) => {\r\n    const { value } = e.currentTarget\r\n    let regexp  = /^[0-9\\b]+$/\r\n    if (!value || regexp.test(value)) {\r\n      setAmount(value);\r\n    }\r\n\r\n  };\r\n\r\n  const transfer = (e) => {\r\n    if (!balanceForm.amount || isNaN(+balanceForm.amount)) {\r\n      setUserAuthFN(userAuth.status, userAuth.data, {\r\n        text: \"系统提示\",\r\n        message: \"没有金额\",\r\n      });\r\n      return void console.warn(\"[transfer] No amount\");\r\n    }\r\n\r\n    const _getMap = (n) => balancesMap[n.split(\": \")[0]] || null;\r\n\r\n    const _from = _getMap(balanceForm.from);\r\n    const _to = _getMap(balanceForm.to);\r\n\r\n\r\n  \r\n    if (_from.game.id === _to.game.id) {\r\n      setUserAuthFN(userAuth.status, userAuth.data, {\r\n        text: \"系统提示\",\r\n        message: \"同一个游戏\",\r\n      });\r\n      return void console.warn(\"[transfer] Same game\");\r\n    }\r\n\r\n    if (_from.balance === 0) {\r\n      setUserAuthFN(userAuth.status, userAuth.data, {\r\n        text: \"系统提示\",\r\n        message: \"零余额\",\r\n      });\r\n      return void console.warn(\"[transfer] Zero balance\");\r\n    }\r\n\r\n    if (_from.balance < +balanceForm.amount) {\r\n      setUserAuthFN(userAuth.status, userAuth.data, {\r\n        text: \"系统提示\",\r\n        message: \"余额不足\",\r\n      });\r\n      return void console.warn(\"[transfer] Not enough game balance\");\r\n    }\r\n\r\n    console.info(\r\n      `You're transfering ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}`\r\n    );\r\n\r\n    setBalanceLoad(true);\r\n\r\n    Game.transfer({\r\n      ...User.read(),\r\n      amount: +balanceForm.amount,\r\n      from: _from.game.id,\r\n      to: _to.game.id,\r\n    }).then(\r\n      (r) => {\r\n        console.info(\r\n          `You have successfully transferred ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}: ${r.info}`\r\n        );\r\n\r\n        setBalanceLoad(false);\r\n\r\n        setBalanceTransferred(true);\r\n      },\r\n      (e) => {\r\n        console.error(e);\r\n        setUserAuthFN(userAuth.status, userAuth.data, {\r\n          text: \"系统提示\",\r\n          message: e,\r\n        });\r\n        setBalanceLoad(false);\r\n      }\r\n    );\r\n  };\r\n\r\n  const wallet = (_e) => {\r\n    setBalanceTime(true);\r\n    setBalanceLoad(true);\r\n\r\n    Game.transferToWallet().promise.then(\r\n      (r) => {\r\n        setBalanceLoad(false);\r\n\r\n        setBalanceTransferred(true);\r\n      },\r\n      (e) => {\r\n        console.warn(e);\r\n        setUserAuthFN(userAuth.status, userAuth.data, {\r\n          text: \"系统提示\",\r\n          message: e,\r\n        });\r\n        setBalanceLoad(false);\r\n      }\r\n    );\r\n    setTimeout(() => {\r\n      setBalanceTime(false);\r\n    }, 10000);\r\n  };\r\n\r\n  const onTransferPerGame = (obj) =>{\r\n    \r\n\r\n    const _from = {\r\n      id: 0,\r\n      name: 'wallet'\r\n    }\r\n    const _to = obj\r\n    // console.log(userAuth.data.balance,Math.floor(userAuth.data.balance) , _from , _to) \r\n    // return false\r\n    console.info(\r\n      `You are transferring ${Math.floor(userAuth.data.balance)} ¥ from ${_from.name} to ${_to.game.name}`\r\n    );\r\n\r\n    Game.transfer({\r\n      ...User.read(),\r\n      amount: Math.floor(userAuth.data.balance),\r\n      from: _from.id,\r\n      to: _to.game.id,\r\n    }).then(\r\n      (r) => {\r\n        console.info(\r\n          `You have successfully transferred ${Math.floor(userAuth.data.balance)} ¥ from ${_from.name} to ${_to.game.name}: ${r.info}`\r\n        );\r\n\r\n        setBalanceLoad(false);\r\n\r\n        setBalanceTransferred(true);\r\n      },\r\n      (e) => {\r\n        console.error(e);\r\n        setUserAuthFN(userAuth.status, userAuth.data, {\r\n          text: \"系统提示\",\r\n          message: e,\r\n        });\r\n        setBalanceLoad(false);\r\n      }\r\n    );\r\n\r\n\r\n  }\r\n\r\n  return (\r\n    <Wrap className=\"transfer-desktop\" title={\"转账\"}>\r\n      <div className=\"profile-section section-box\">\r\n        <div className=\"user-balance\">\r\n          <div className=\"user-balance-wrap wallet\">\r\n            中心钱包 :\r\n            <span className=\"user-balance-amount\">\r\n              ¥{BigNumber(userAuth.data.balance).toFormat(2)}\r\n            </span>\r\n          </div>\r\n          <div\r\n            className=\"user-balance-wrap refresh\"\r\n            onClick={!balanceLoad && !balanceTime ? wallet : null}\r\n          >\r\n            <i />\r\n            <span className=\"user-balance-label\">一键回收</span>\r\n          </div>\r\n        </div>\r\n        <div className=\"transfer-hr\" />\r\n        <div className=\"balances-list\">\r\n          {balancesRaw.map((balance, i) => (\r\n            <div key={i} className=\"balances-list--item\">\r\n              <div className=\"game-name\">{balance.game.name}</div>\r\n              <div className=\"game-balance\">\r\n                {BigNumber(balance.balance).toFormat(2)}\r\n              </div>\r\n              <div className=\"game-button\"\r\n               onClick={!balanceLoad && !balanceTime ? () => onTransferPerGame(balance) : null}\r\n              >一键转入</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"profile-section section-box\">\r\n        <div className=\"form-field-section\">\r\n          <div className=\"form-field--doubler\">\r\n            <div className=\"form-field\">\r\n              <label>推出</label>\r\n              <div className=\"input--wrap with-dot\">\r\n                <div\r\n                  className={cx(\"input-like\", {\r\n                    \"has-value\": balanceForm.from,\r\n                  })}\r\n                  onClick={(e) => setBalanceOver(\"from\")}\r\n                >\r\n                  {balanceForm.from || \"推出\"}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"form-field-swap\">\r\n              <button onClick={() => swap()} id=\"swapButton\">\r\n                {/* <Icon name=\"switch\" /> */}\r\n              </button>\r\n            </div>\r\n            <div className=\"form-field\">\r\n              <label>进入</label>\r\n              <div className=\"input--wrap with-dot\">\r\n                <div\r\n                  className={cx(\"input-like\", {\r\n                    \"has-value\": balanceForm.to,\r\n                  })}\r\n                  onClick={(e) => setBalanceOver(\"to\")}\r\n                >\r\n                  {balanceForm.to || \"进入\"}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"form-field with-max\">\r\n            <div className=\"amount-wrap\">\r\n              <div className=\"input--wrap\">\r\n                <span>￥</span>\r\n                <input\r\n                  id=\"amount\"\r\n                  type=\"text\"\r\n                  placeholder=\"金额\"\r\n                  // pattern=\"[0-9]*\"\r\n                  className={cx({ \"has-value\": balanceForm.amount })}\r\n                  value={balanceForm.amount}\r\n                  onChange={(e) => onlyNumbers(e)}\r\n                  // onKeyDown={(e) => onlyNumbers(e)}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"amount-max-wrap\">\r\n              <button\r\n                id=\"maxButton\"\r\n                className={cx({\r\n                  disabled:\r\n                    !balancesMap[balanceForm.from] ||\r\n                    !balancesMap[balanceForm.from].balance,\r\n                })}\r\n                onClick={() => setMax()}\r\n              >\r\n                最大金额\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"form-field-section bottom\">\r\n          <div className=\"form-field amount-variants\">\r\n            {AmountVariants.map((amount, i) => (\r\n              <button\r\n                id=\"amountVariants\"\r\n                key={i}\r\n                className={cx(\"amount-variant\", {\r\n                  disabled: amount > userAuth.data.balance,\r\n                })}\r\n                onClick={() => setAmount(amount)}\r\n              >\r\n                {amount}\r\n              </button>\r\n            ))}\r\n          </div>\r\n          <div className=\"submit\">\r\n            <button onClick={transfer}>立即转账</button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className={`modal-container ${balanceOver ? \"shown\" : null}`}>\r\n          <div className={`game-sa-overlay picker-over`}>\r\n            <div className=\"picker-container\">\r\n              <div className=\"picker-head\">\r\n                <p>{balanceOver === \"from\" ? \"推出\" : \"进入\"}</p>\r\n              </div>\r\n\r\n              {balanceOver && <PickerWrap dist={balanceOver} /> }\r\n\r\n            </div>\r\n            <div className=\"picker-footer\">\r\n              <button onClick={(e) => setBalanceOver(null)}>取消</button>\r\n              <button className=\"active\" onClick={(e) => setBalanceOver(null)}>\r\n                确定\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div\r\n          className={`modal-container ${balanceTransferred ? \"shown\" : null}`}\r\n        >\r\n          <div className={`game-sa-overlay`}>\r\n            <div className=\"overlay-layer\">\r\n              <div className=\"form response\">\r\n                <div className=\"form-head\">\r\n                  <i />\r\n                  <h2>转账成功</h2>\r\n                </div>\r\n                <div className=\"form-body\">\r\n                  <button\r\n                    onClick={() => {\r\n                      setBalanceTransferred(false);\r\n                      setBalanceUpdateI((i) => i + 1);\r\n                    }}\r\n                  >\r\n                    确认\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default withAuth(Transfer, 1);\r\n"]},"metadata":{},"sourceType":"module"}