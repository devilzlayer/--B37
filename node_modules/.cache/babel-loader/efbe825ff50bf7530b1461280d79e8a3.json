{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Documents/New PWA/GIT/src/pwa/view/News.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom'; // import { Link} from 'react-router-dom';\n\nimport { map, size, sortBy, reverse } from 'lodash';\nimport { Promotions } from '../../service';\nimport moment from 'moment';\nimport { Wrap } from '../view/profile/';\nimport { withAuth } from \"../util/\";\nimport '../assets/scss/News.scss';\n\nconst News = () => {\n  const [load, setLoad] = useState(15);\n  const [list, setList] = useState(null);\n  const [key, setKey] = useState(null);\n  const history = useHistory();\n  useEffect(() => {\n    const q = Promotions.getAnnouncements({\n      num: load\n    });\n    q.promise.then(r => {\n      const sortDate = sortBy(r.info, obj => {\n        return obj.edit_time;\n      });\n      setList(reverse(sortDate));\n    }, e => {\n      if (!e.is_aborted) {\n        console.warn(e);\n      }\n    });\n    return () => q.cancel();\n  }, [load]);\n\n  const onOpen = i => {\n    setKey(i);\n\n    if (key === i) {\n      setKey(null);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(Wrap, {\n    className: \"news-wrap\",\n    centerName: \"\\u6700\\u65B0\\u516C\\u544A\",\n    faq: false,\n    sublevel: [true, () => history.goBack()],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"news-wrap-inner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 4\n    }\n  }, list && map(list, (obj, i) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: i,\n      className: \"news-wrap-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: `news-wrap-content ${key === i ? 'drop' : ''}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"news-wrap-time\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 37\n      }\n    }, obj.edit_time), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"news-wrap-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 37\n      }\n    }, obj.content), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"news-wrap-arrow\",\n      onClick: () => onOpen(i),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 37\n      }\n    })));\n  }), size(list) >= load && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"news-load more\",\n    onClick: () => setLoad(load + 15),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 41\n    }\n  }, \"load more\")));\n};\n\nexport default withAuth(News, 1);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/GIT/src/pwa/view/News.js"],"names":["React","useEffect","useState","useHistory","map","size","sortBy","reverse","Promotions","moment","Wrap","withAuth","News","load","setLoad","list","setList","key","setKey","history","q","getAnnouncements","num","promise","then","r","sortDate","info","obj","edit_time","e","is_aborted","console","warn","cancel","onOpen","i","goBack","content"],"mappings":"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","sourcesContent":["import React ,{ useEffect, useState} from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\n// import { Link} from 'react-router-dom';\r\nimport { map ,size , sortBy , reverse } from 'lodash'\r\nimport { Promotions } from '../../service';\r\nimport moment from 'moment'\r\n\r\nimport { Wrap } from '../view/profile/';\r\nimport { withAuth } from \"../util/\";\r\n\r\nimport '../assets/scss/News.scss';\r\n\r\n\r\nconst News = () => {\r\n    const [ load ,setLoad ] = useState(15)\r\n    const [ list ,setList ] = useState(null)\r\n    const [ key ,setKey ] = useState(null)\r\n\tconst history = useHistory();\r\n\r\n    useEffect( () =>{\r\n\t\tconst q = Promotions.getAnnouncements({ num: load  });\r\n\r\n        q.promise.then(r => {\r\n            const sortDate = sortBy(r.info, (obj )=>{\r\n                return obj.edit_time\r\n            })\r\n\r\n            setList(reverse(sortDate))\r\n\r\n\t\t}, e => {\r\n\t\t\tif (!e.is_aborted) {\r\n\t\t\t\tconsole.warn(e);\r\n\t\t\t}\r\n\t\t});\r\n\r\n        return () => q.cancel();\r\n        \r\n    },[load])\r\n\r\n\r\n    const onOpen = (i) =>{\r\n        setKey(i)\r\n        if(key === i){\r\n            setKey(null)\r\n        }\r\n    }\r\n\r\n     \r\n\treturn (\r\n\t\t<Wrap\r\n\t\t\tclassName=\"news-wrap\"\r\n\t\t\tcenterName=\"最新公告\"\r\n\t\t\tfaq={false}\r\n\t\t\tsublevel={[ true, () => history.goBack() ]}>\r\n\t\t\t<div className=\"news-wrap-inner\">\r\n\t\t\t\t{list && map(list , (obj , i) =>{\r\n                    return  <div key={i} className=\"news-wrap-item\">\r\n                                <div className={`news-wrap-content ${key === i ? 'drop' : ''}`}>\r\n                                    <div className=\"news-wrap-time\">{obj.edit_time}</div>\r\n                                    <div className=\"news-wrap-text\">{obj.content}</div>\r\n                                    <div className=\"news-wrap-arrow\" onClick={() => onOpen(i)}/>\r\n                                </div>\r\n                            </div>\r\n                })}\r\n                {size(list) >= load &&  <div className=\"news-load more\" onClick={() => setLoad(load + 15)}>load more</div> }\r\n \r\n\t\t\t</div>\r\n\t\t</Wrap>\r\n\t);\r\n\r\n}\r\n\r\nexport default withAuth(News,1 );\r\n\r\n"]},"metadata":{},"sourceType":"module"}