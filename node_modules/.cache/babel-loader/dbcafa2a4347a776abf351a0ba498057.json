{"ast":null,"code":"var _jsxFileName = \"/Users/cramj/Downloads/usportproject 2/src/pwa/view/profile/withdrawal/newCard.js\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport { map, find, head, size, filter } from \"lodash\";\nimport Swal from \"sweetalert2\";\nimport { FormField, UITabs } from \"../../../../component\";\nimport { User, Card as Service } from \"../../../../service\";\nimport * as Geo from \"../../../../service/Geo\";\nconst banks = [\"中国工商银行\", \"中国建设银行\", \"中国银行\", \"中国农业银行\", \"中国邮政储蓄银行\", \"招商银行\", \"交通银行\"];\n\nconst NewCard = props => {\n  const {\n    show,\n    delCard,\n    onHide,\n    onNewAddCard\n  } = props;\n  const [tempBank, setTempBank] = useState(head(banks));\n  const [tempProv, setTempProv] = useState(null);\n  const [cardList, setCardList] = useState(null);\n  const [provList, setProvList] = useState(null);\n  const [delKey, setDelKey] = useState(null);\n  const [animate, setAnimate] = useState(false);\n  const [makeDefault, setMakeDefault] = useState(true);\n  const [bankPicker, toggleBankPicker] = useState(false);\n  const [cityPicker, toggleCityPicker] = useState(false);\n  const {\n    userAuth\n  } = useContext(User.Context);\n  const [error, setError] = useState({\n    bank_addr: null,\n    bank_no: null\n  });\n  const [form, setForm] = useState({\n    bank_type: \"中国工商银行\",\n    bank_province: \"贵州\",\n    bank_city: \"遵义市\",\n    realname: userAuth.data.realName || \"\",\n    bank_addr: \"\",\n    bank_no: \"\"\n  });\n  const fields = [{\n    id: \"bank_type\",\n    label: \"开户银行\",\n    select: toggleBankPicker,\n    placeholder: \"开户银行\"\n  }, {\n    id: \"bank_province\",\n    label: \"开户地区\",\n    select: toggleCityPicker,\n    value: () => `${form.bank_province} ${form.bank_city}`,\n    placeholder: \"开户地区\",\n    hidden: true\n  }, //COMMENT FOR NOW\n  {\n    id: \"bank_city\",\n    label: \"开户支行\",\n    hidden: true,\n    select: false\n  }, {\n    id: \"bank_addr\",\n    label: \"开户支行\",\n    select: false,\n    placeholder: \"开户支行\"\n  }, {\n    id: \"realname\",\n    label: \"开户人姓名\",\n    select: false,\n    placeholder: \"开户人姓名\",\n    displayOnly: userAuth.data.realName ? true : false\n  }, {\n    id: \"bank_no\",\n    label: \"银行卡号\",\n    select: false\n  }];\n  useEffect(() => {\n    const res = Service.read({ ...User.read()\n    });\n    res.promise.then(r => {\n      // console.log(r)\n      setCardList(r.info);\n    }, e => {\n      console.warn(\"Unable to get cards:\", e);\n    });\n  }, [animate]);\n  useEffect(() => {\n    let newObj = [];\n    map(Geo.provinces, (obj, i) => {\n      // console.log(obj)\n      let newCity = filter(Geo.cities, val => {\n        if (val.province === obj.title) {\n          newObj.push({ ...val,\n            chinese_province: obj.chinese_title\n          });\n        }\n      });\n    });\n    newObj = map(newObj, (obj, id) => {\n      return { ...obj,\n        id: id\n      };\n    }); // console.log(newObj)\n    // let newCities = map(Geo.cities , (obj , i) =>{\n    //     let province = find(Geo.provinces, (val) => obj.province === val.title)\n    //     // console.log(province)\n    //     return {\n    //         ...obj,\n    //         id: i,\n    //         chinese_province : province && province.chinese_title\n    //     }\n    // })\n\n    setProvList(newObj);\n    let cur = find(newObj, obj => obj.chinese_province === form.bank_province && obj.chinese_title === form.bank_city);\n    setTempProv(cur.id); // console.log(cur)\n  }, []);\n\n  const onChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setForm(f => ({ ...f,\n      [name]: value\n    }));\n  };\n\n  const onSelect = e => {\n    const {\n      name,\n      value\n    } = e;\n    setForm(f => ({ ...f,\n      [name]: value\n    }));\n  };\n\n  const submit = () => {\n    // console.log(form)\n    // props.onLoading();\n    // onHide()\n    // setAnimate(false)\n    if (size(cardList) === 5) {\n      Swal.fire({\n        icon: \"error\",\n        title: \"绑定的银行信息不能超过5条\"\n      });\n      return false;\n    }\n\n    if (!form.bank_no && !form.bank_addr) {\n      if (!form.bank_no) {\n        setError(f => ({ ...f,\n          bank_no: \"required\"\n        }));\n      }\n\n      if (!form.bank_addr) {\n        setError(f => ({ ...f,\n          bank_addr: \"required\"\n        }));\n      }\n\n      return false;\n    }\n\n    Service.create({ ...User.read(),\n      ...form\n    }).promise.then(r => {\n      setForm(f => ({ ...f,\n        bank_addr: \"\",\n        bank_no: \"\"\n      }));\n      console.info(\"Successfully bound the card:\", r);\n      onHide();\n      setAnimate(false);\n      onNewAddCard();\n    }, e => {\n      console.info(\"Unable to bind the card:\", e);\n    });\n  };\n\n  const onDel = i => {\n    setDelKey(null);\n    if (delKey != i) setDelKey(i);\n  };\n\n  const onCloseProv = () => {\n    let cur = find(provList, obj => obj.id === tempProv); // console.log(cur)\n\n    setForm(f => ({ ...f,\n      bank_province: cur.chinese_province,\n      bank_city: cur.chinese_title\n    }));\n    toggleCityPicker(false);\n  };\n\n  if (show) {\n    setTimeout(() => {\n      setAnimate(true);\n    }, 100);\n  }\n\n  if (delCard) {\n    setTimeout(() => {\n      setAnimate(true);\n    }, 100);\n  } // console.log(bankPicker , cityPicker)\n  // console.log(tempProv)\n  // console.log( size( Geo.provinces) , size( Geo.cities)  )\n\n\n  let delCount = 0;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: `withdrawal-new-card ${show || delCard ? \"show-new-card\" : \"\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdrawal-new-card-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `withdrawal-new-card-content ${show && animate ? \"animate\" : \"\"} ${bankPicker ? \"hide\" : \"\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 9\n    }\n  }, !cityPicker ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-n-c-fiels-main\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"w-n-c-arrow\",\n    onClick: () => [onHide(), setAnimate(false)],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 15\n    }\n  }, \"\\u65B0\\u589E\\u94F6\\u884C\\u5361\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-n-c-fiels\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 15\n    }\n  }, fields.filter(f => !f.hidden).map((f, i) => /*#__PURE__*/React.createElement(\"div\", {\n    key: i,\n    className: \"w-n-c-fiels-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(FormField, {\n    key: i,\n    field: {\n      label: f.label,\n      placeholder: f.placeholder,\n      select: f.select,\n      displayOnly: f.displayOnly,\n      value: f.value,\n      onClick: () => f.select(true)\n    },\n    input: {\n      id: f.id,\n      label: f.label,\n      placeholder: f.placeholder,\n      name: f.id,\n      value: form[f.id],\n      onChange,\n      className: error[f.id]\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 23\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-n-c-set-defaul-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: `${makeDefault ? \"active\" : \"not\"}` // onClick={()=> setMakeDefault(!makeDefault)}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 17\n    }\n  }, \"\\u9ED8\\u8BA4\\u94F6\\u884C\\u5361\")), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => submit(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 15\n    }\n  }, \"\\u65B0\\u589E\\u94F6\\u884C\\u5361\")) :\n  /*#__PURE__*/\n  // ======================= PROVINCES\n  React.createElement(\"div\", {\n    className: \"w-n-c-fiels-prov\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"w-n-c-arrow\",\n    onClick: () => onCloseProv(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 15\n    }\n  }, \"\\u7701\\u4EFD\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-n-c-p-fields\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-n-c-p-fields-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 17\n    }\n  }, provList && map(provList, (obj, i) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: i,\n      className: `w-n-c-p-fields-item`,\n      onClick: () => setTempProv(obj.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"w-n-c-p-fields-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: `${tempProv === obj.id ? \"active\" : \"not\"}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 29\n      }\n    }, obj.chinese_province, \" \", obj.chinese_title, \" \")));\n  }))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: `withdrawal-new-card-content ${delCard && animate ? \"animate\" : \"\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"w-n-c-arrow\",\n    onClick: () => [onHide(), setAnimate(false), setDelKey(null)],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 11\n    }\n  }, \"\\u5220\\u9664\\u5361\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-n-c-del-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 11\n    }\n  }, cardList && map(cardList, (obj, i) => {\n    // console.log(obj)\n    delCount++;\n    if (delCount === 5) delCount = 1;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: i,\n      className: `del-wrap-content del-bg${delCount}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"de-wrap-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: `del-icon`,\n      onClick: () => onDel(i),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 25\n      }\n    }), delKey === i && /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 42\n      }\n    }, \"\\u8BF7\\u8054\\u7CFB\\u5BA2\\u670D\")), /*#__PURE__*/React.createElement(\"span\", {\n      className: `del-bank-icon ${obj.bank_type}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 23\n      }\n    }, obj.bank_type), /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 23\n      }\n    }, \"\\u94F6\\u884C\\u5361\\u53F7\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"del-bank-number\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"del-sp\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 25\n      }\n    }, \"**** **** ****\"), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"del-st\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 25\n      }\n    }, obj.bank_no.substr(obj.bank_no.length - 4)))));\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: `w-n-c-select-bank ${bankPicker ? \"show\" : \"\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-n-c-s-b-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 13\n    }\n  }, \"\\u9009\\u62E9\\u5F00\\u6237\\u94F6\\u884C\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-n-c-s-b-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-n-c-s-b-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 13\n    }\n  }, banks && map(banks, (obj, i) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: i,\n      className: `w-n-c-s-b-wrap ${tempBank === obj ? \"select\" : \"\"}`,\n      onClick: () => setTempBank(obj),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 21\n      }\n    }, obj);\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-n-c-s-b-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"cancel\",\n    onClick: () => toggleBankPicker(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 13\n    }\n  }, \"\\u53D6\\u6D88\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"determine\",\n    onClick: () => [onSelect({\n      name: \"bank_type\",\n      value: tempBank\n    }), toggleBankPicker(false)],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 13\n    }\n  }, \"\\u786E\\u5B9A\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"withdrawal-new-card-overlay\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default NewCard;","map":{"version":3,"sources":["/Users/cramj/Downloads/usportproject 2/src/pwa/view/profile/withdrawal/newCard.js"],"names":["React","useEffect","useState","useContext","map","find","head","size","filter","Swal","FormField","UITabs","User","Card","Service","Geo","banks","NewCard","props","show","delCard","onHide","onNewAddCard","tempBank","setTempBank","tempProv","setTempProv","cardList","setCardList","provList","setProvList","delKey","setDelKey","animate","setAnimate","makeDefault","setMakeDefault","bankPicker","toggleBankPicker","cityPicker","toggleCityPicker","userAuth","Context","error","setError","bank_addr","bank_no","form","setForm","bank_type","bank_province","bank_city","realname","data","realName","fields","id","label","select","placeholder","value","hidden","displayOnly","res","read","promise","then","r","info","e","console","warn","newObj","provinces","obj","i","newCity","cities","val","province","title","push","chinese_province","chinese_title","cur","onChange","name","target","f","onSelect","submit","fire","icon","create","onDel","onCloseProv","setTimeout","delCount","onClick","className","substr","length"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\r\nimport { map, find, head, size, filter } from \"lodash\";\r\nimport Swal from \"sweetalert2\";\r\n\r\nimport { FormField, UITabs } from \"../../../../component\";\r\nimport { User, Card as Service } from \"../../../../service\";\r\nimport * as Geo from \"../../../../service/Geo\";\r\n\r\nconst banks = [\r\n  \"中国工商银行\",\r\n  \"中国建设银行\",\r\n  \"中国银行\",\r\n  \"中国农业银行\",\r\n  \"中国邮政储蓄银行\",\r\n  \"招商银行\",\r\n  \"交通银行\",\r\n];\r\n\r\nconst NewCard = (props) => {\r\n  const { show, delCard, onHide, onNewAddCard } = props;\r\n\r\n  const [tempBank, setTempBank] = useState(head(banks));\r\n  const [tempProv, setTempProv] = useState(null);\r\n  const [cardList, setCardList] = useState(null);\r\n  const [provList, setProvList] = useState(null);\r\n  const [delKey, setDelKey] = useState(null);\r\n\r\n  const [animate, setAnimate] = useState(false);\r\n  const [makeDefault, setMakeDefault] = useState(true);\r\n  const [bankPicker, toggleBankPicker] = useState(false);\r\n  const [cityPicker, toggleCityPicker] = useState(false);\r\n\r\n  const { userAuth } = useContext(User.Context);\r\n\r\n  const [error, setError] = useState({\r\n    bank_addr: null,\r\n    bank_no: null,\r\n  });\r\n  const [form, setForm] = useState({\r\n    bank_type: \"中国工商银行\",\r\n    bank_province: \"贵州\",\r\n    bank_city: \"遵义市\",\r\n    realname: userAuth.data.realName || \"\",\r\n    bank_addr: \"\",\r\n    bank_no: \"\",\r\n  });\r\n\r\n  const fields = [\r\n    {\r\n      id: \"bank_type\",\r\n      label: \"开户银行\",\r\n      select: toggleBankPicker,\r\n      placeholder: \"开户银行\",\r\n    },\r\n    {\r\n      id: \"bank_province\",\r\n      label: \"开户地区\",\r\n      select: toggleCityPicker,\r\n      value: () => `${form.bank_province} ${form.bank_city}`,\r\n      placeholder: \"开户地区\",\r\n      hidden: true,\r\n    }, //COMMENT FOR NOW\r\n    { id: \"bank_city\", label: \"开户支行\", hidden: true, select: false },\r\n    {\r\n      id: \"bank_addr\",\r\n      label: \"开户支行\",\r\n      select: false,\r\n      placeholder: \"开户支行\",\r\n    },\r\n    {\r\n      id: \"realname\",\r\n      label: \"开户人姓名\",\r\n      select: false,\r\n      placeholder: \"开户人姓名\",\r\n      displayOnly: userAuth.data.realName ? true : false,\r\n    },\r\n    { id: \"bank_no\", label: \"银行卡号\", select: false },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    const res = Service.read({\r\n      ...User.read(),\r\n    });\r\n\r\n    res.promise.then(\r\n      (r) => {\r\n        // console.log(r)\r\n        setCardList(r.info);\r\n      },\r\n      (e) => {\r\n        console.warn(\"Unable to get cards:\", e);\r\n      }\r\n    );\r\n  }, [animate]);\r\n\r\n  useEffect(() => {\r\n    let newObj = [];\r\n    map(Geo.provinces, (obj, i) => {\r\n      // console.log(obj)\r\n      let newCity = filter(Geo.cities, (val) => {\r\n        if (val.province === obj.title) {\r\n          newObj.push({\r\n            ...val,\r\n            chinese_province: obj.chinese_title,\r\n          });\r\n        }\r\n      });\r\n    });\r\n    newObj = map(newObj, (obj, id) => {\r\n      return { ...obj, id: id };\r\n    });\r\n    // console.log(newObj)\r\n    // let newCities = map(Geo.cities , (obj , i) =>{\r\n    //     let province = find(Geo.provinces, (val) => obj.province === val.title)\r\n    //     // console.log(province)\r\n    //     return {\r\n    //         ...obj,\r\n    //         id: i,\r\n    //         chinese_province : province && province.chinese_title\r\n    //     }\r\n    // })\r\n\r\n    setProvList(newObj);\r\n\r\n    let cur = find(\r\n      newObj,\r\n      (obj) =>\r\n        obj.chinese_province === form.bank_province &&\r\n        obj.chinese_title === form.bank_city\r\n    );\r\n\r\n    setTempProv(cur.id);\r\n    // console.log(cur)\r\n  }, []);\r\n\r\n  const onChange = (e) => {\r\n    const { name, value } = e.target;\r\n\r\n    setForm((f) => ({\r\n      ...f,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const onSelect = (e) => {\r\n    const { name, value } = e;\r\n\r\n    setForm((f) => ({\r\n      ...f,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const submit = () => {\r\n    // console.log(form)\r\n    // props.onLoading();\r\n    // onHide()\r\n    // setAnimate(false)\r\n    if (size(cardList) === 5) {\r\n      Swal.fire({\r\n        icon: \"error\",\r\n        title: \"绑定的银行信息不能超过5条\",\r\n      });\r\n      return false;\r\n    }\r\n\r\n    if (!form.bank_no && !form.bank_addr) {\r\n      if (!form.bank_no) {\r\n        setError((f) => ({\r\n          ...f,\r\n          bank_no: \"required\",\r\n        }));\r\n      }\r\n      if (!form.bank_addr) {\r\n        setError((f) => ({\r\n          ...f,\r\n          bank_addr: \"required\",\r\n        }));\r\n      }\r\n      return false;\r\n    }\r\n\r\n    Service.create({\r\n      ...User.read(),\r\n      ...form,\r\n    }).promise.then(\r\n      (r) => {\r\n        setForm((f) => ({\r\n          ...f,\r\n          bank_addr: \"\",\r\n          bank_no: \"\",\r\n        }));\r\n\r\n        console.info(\"Successfully bound the card:\", r);\r\n        onHide();\r\n        setAnimate(false);\r\n        onNewAddCard();\r\n      },\r\n      (e) => {\r\n        console.info(\"Unable to bind the card:\", e);\r\n      }\r\n    );\r\n  };\r\n\r\n  const onDel = (i) => {\r\n    setDelKey(null);\r\n    if (delKey != i) setDelKey(i);\r\n  };\r\n\r\n  const onCloseProv = () => {\r\n    let cur = find(provList, (obj) => obj.id === tempProv);\r\n    // console.log(cur)\r\n    setForm((f) => ({\r\n      ...f,\r\n      bank_province: cur.chinese_province,\r\n      bank_city: cur.chinese_title,\r\n    }));\r\n    toggleCityPicker(false);\r\n  };\r\n\r\n  if (show) {\r\n    setTimeout(() => {\r\n      setAnimate(true);\r\n    }, 100);\r\n  }\r\n\r\n  if (delCard) {\r\n    setTimeout(() => {\r\n      setAnimate(true);\r\n    }, 100);\r\n  }\r\n  // console.log(bankPicker , cityPicker)\r\n  // console.log(tempProv)\r\n  // console.log( size( Geo.provinces) , size( Geo.cities)  )\r\n  let delCount = 0;\r\n\r\n  return (\r\n    <div\r\n      className={`withdrawal-new-card ${\r\n        show || delCard ? \"show-new-card\" : \"\"\r\n      }`}\r\n    >\r\n      <div className=\"withdrawal-new-card-wrap\">\r\n        <div\r\n          className={`withdrawal-new-card-content ${\r\n            show && animate ? \"animate\" : \"\"\r\n          } ${bankPicker ? \"hide\" : \"\"}`}\r\n        >\r\n          {!cityPicker ? (\r\n            <div className=\"w-n-c-fiels-main\">\r\n              <span\r\n                className=\"w-n-c-arrow\"\r\n                onClick={() => [onHide(), setAnimate(false)]}\r\n              />\r\n              <h3>新增银行卡</h3>\r\n              <div className=\"w-n-c-fiels\">\r\n                {fields\r\n                  .filter((f) => !f.hidden)\r\n                  .map((f, i) => (\r\n                    <div key={i} className=\"w-n-c-fiels-wrap\">\r\n                      <FormField\r\n                        key={i}\r\n                        field={{\r\n                          label: f.label,\r\n                          placeholder: f.placeholder,\r\n                          select: f.select,\r\n                          displayOnly: f.displayOnly,\r\n                          value: f.value,\r\n                          onClick: () => f.select(true),\r\n                        }}\r\n                        input={{\r\n                          id: f.id,\r\n                          label: f.label,\r\n                          placeholder: f.placeholder,\r\n                          name: f.id,\r\n                          value: form[f.id],\r\n                          onChange,\r\n                          className: error[f.id],\r\n                        }}\r\n                      />\r\n                    </div>\r\n                  ))}\r\n              </div>\r\n\r\n              <div className=\"w-n-c-set-defaul-wrap\">\r\n                <span\r\n                  className={`${makeDefault ? \"active\" : \"not\"}`}\r\n                  // onClick={()=> setMakeDefault(!makeDefault)}\r\n                >\r\n                  默认银行卡\r\n                </span>\r\n              </div>\r\n\r\n              <button onClick={() => submit()}>新增银行卡</button>\r\n            </div>\r\n          ) : (\r\n            // ======================= PROVINCES\r\n            <div className=\"w-n-c-fiels-prov\">\r\n              <span className=\"w-n-c-arrow\" onClick={() => onCloseProv()} />\r\n              <h3>省份</h3>\r\n\r\n              <div className=\"w-n-c-p-fields\">\r\n                <div className=\"w-n-c-p-fields-content\">\r\n                  {provList &&\r\n                    map(provList, (obj, i) => {\r\n                      return (\r\n                        <div\r\n                          key={i}\r\n                          className={`w-n-c-p-fields-item`}\r\n                          onClick={() => setTempProv(obj.id)}\r\n                        >\r\n                          <div className=\"w-n-c-p-fields-body\">\r\n                            <span\r\n                              className={`${\r\n                                tempProv === obj.id ? \"active\" : \"not\"\r\n                              }`}\r\n                            >\r\n                              {obj.chinese_province} {obj.chinese_title}{\" \"}\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* =============== DELETE BANK */}\r\n        <div\r\n          className={`withdrawal-new-card-content ${\r\n            delCard && animate ? \"animate\" : \"\"\r\n          }`}\r\n        >\r\n          <span\r\n            className=\"w-n-c-arrow\"\r\n            onClick={() => [onHide(), setAnimate(false), setDelKey(null)]}\r\n          />\r\n          <h3>删除卡</h3>\r\n\r\n          <div className=\"w-n-c-del-wrap\">\r\n            {cardList &&\r\n              map(cardList, (obj, i) => {\r\n                // console.log(obj)\r\n                delCount++;\r\n                if (delCount === 5) delCount = 1;\r\n\r\n                return (\r\n                  <div key={i} className={`del-wrap-content del-bg${delCount}`}>\r\n                    <div className=\"de-wrap-body\">\r\n                      <span className={`del-icon`} onClick={() => onDel(i)}>\r\n                        <i />\r\n                        {delKey === i && <span>请联系客服</span>}\r\n                      </span>\r\n                      <span className={`del-bank-icon ${obj.bank_type}`} />\r\n                      <h3>{obj.bank_type}</h3>\r\n                      <h4>银行卡号</h4>\r\n                      <div className=\"del-bank-number\">\r\n                        <span className=\"del-sp\">**** **** ****</span>\r\n                        <span className=\"del-st\">\r\n                          {obj.bank_no.substr(obj.bank_no.length - 4)}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n          </div>\r\n        </div>\r\n        {/* =============== SELECT BANK */}\r\n        <div className={`w-n-c-select-bank ${bankPicker ? \"show\" : \"\"}`}>\r\n          <div className=\"w-n-c-s-b-title\">\r\n            <h3>选择开户银行</h3>\r\n          </div>\r\n          <div className=\"w-n-c-s-b-content\">\r\n            <div className=\"w-n-c-s-b-body\">\r\n              {banks &&\r\n                map(banks, (obj, i) => {\r\n                  return (\r\n                    <div\r\n                      key={i}\r\n                      className={`w-n-c-s-b-wrap ${\r\n                        tempBank === obj ? \"select\" : \"\"\r\n                      }`}\r\n                      onClick={() => setTempBank(obj)}\r\n                    >\r\n                      {obj}\r\n                    </div>\r\n                  );\r\n                })}\r\n            </div>\r\n          </div>\r\n          <div className=\"w-n-c-s-b-footer\">\r\n            <button className=\"cancel\" onClick={() => toggleBankPicker(false)}>\r\n              取消\r\n            </button>\r\n            <button\r\n              className=\"determine\"\r\n              onClick={() => [\r\n                onSelect({ name: \"bank_type\", value: tempBank }),\r\n                toggleBankPicker(false),\r\n              ]}\r\n            >\r\n              确定\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"withdrawal-new-card-overlay\" />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NewCard;\r\n"]},"metadata":{},"sourceType":"module"}