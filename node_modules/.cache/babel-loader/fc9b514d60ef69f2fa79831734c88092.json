{"ast":null,"code":"import _defineProperty from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cramj/Documents/New PWA/ubet-project (1)/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from\"react\";import Picker from\"react-mobile-picker\";import cx from\"classnames\";import BigNumber from\"bignumber.js\";import{map,toInteger,isNumber}from'lodash';// import { UIAlert } from \"../../component\";\nimport{User,Game}from\"../../service\";import{withAuth}from\"../../util\";import Wrap from\"./Wrap\";import\"../../assets/scss/profile/Transfer.scss\";var Transfer=function Transfer(){var _useContext=useContext(User.Context),userAuth=_useContext.userAuth,setUserAuthFN=_useContext.setUserAuthFN;var _useState=useState({from:[],to:[]}),_useState2=_slicedToArray(_useState,2),balances=_useState2[0],setBalances=_useState2[1];var _useState3=useState({wallet:[],games:[]}),_useState4=_slicedToArray(_useState3,2),balancesFill=_useState4[0],setBalancesFill=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),balancesRaw=_useState6[0],setBalancesRaw=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),balanceTransferred=_useState8[0],setBalanceTransferred=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),balanceLoad=_useState10[0],setBalanceLoad=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),balanceUpdateI=_useState12[0],setBalanceUpdateI=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),balancesMap=_useState14[0],setBalancesMap=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),balanceOver=_useState16[0],setBalanceOver=_useState16[1];var _useState17=useState({from:null,to:null,amount:\"\"}),_useState18=_slicedToArray(_useState17,2),balanceForm=_useState18[0],setBalanceForm=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),balanceTime=_useState20[0],setBalanceTime=_useState20[1];useEffect(function(){setBalances({from:[],to:[]});setBalancesMap({});setBalancesFill({wallet:[],games:[]});Game.balances(_objectSpread({},User.read())).then(function(_balances){setBalancesRaw(_balances.filter(function(b){return!b.error;}));// const __balances = _balances.map(b => `${b.game.name}: ${b.balance} ¥`);\n// \t\t\t__balances.unshift(`中央钱包: ${userAuth.data.balance} ¥`);\nvar __balances=_balances.filter(function(b){return!b.error;}).map(function(b){return\"\".concat(b.game.name);});__balances.unshift(\"\\u4E2D\\u5FC3\\u94B1\\u5305\");var _bFillWallet=[\"\\u4E2D\\u5FC3\\u94B1\\u5305\"];var _bFillGames=_balances.filter(function(b){return!b.error;}).map(function(b){return b.game.name;});setBalancesFill({wallet:_bFillWallet,games:_bFillGames});setBalanceForm(function(balanceForm){return _objectSpread(_objectSpread({},balanceForm),{},{from:__balances[0],to:__balances[1]});});setBalances({from:__balances,// to: __balances,\nto:_bFillGames});var __balancesMap={};_balances.filter(function(b){return!b.error;}).forEach(function(b){__balancesMap[b.game.name]=b;});__balancesMap[\"中心钱包\"]={game:{id:0,name:\"wallet\"},wallet:true,balance:+userAuth.data.balance};setBalancesMap(__balancesMap);});},[balanceUpdateI,userAuth.data.balance]);useEffect(function(){User.session(_objectSpread({},User.read())).promise.then(function(r){return setUserAuthFN(1,r.info);});setBalanceForm(function(bf){return _objectSpread(_objectSpread({},bf),{},{amount:\"\"});});// eslint-disable-next-line\n},[balanceUpdateI]);var AmountVariants=[100,500,1000,2000,5000];var PickerWrap=function PickerWrap(_ref){var dist=_ref.dist;// console.log( dist )\n// console.log( balances[dist] )\nreturn/*#__PURE__*/React.createElement(\"div\",{className:\"picker-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"bank-picker-body-wrap\"},balances[dist].length&&map(balances[dist],function(obj,i){return/*#__PURE__*/React.createElement(\"div\",{key:i,className:\"bank-picker-item \".concat(balanceForm[dist]===obj?'active':''),onClick:function onClick(){if(dist===\"from\"){var _d=balancesMap[obj].wallet?\"games\":\"wallet\";setBalances(function(b){return _objectSpread(_objectSpread({},b),{},{to:balancesFill[_d]});});setBalanceForm(function(bf){return _objectSpread(_objectSpread({},bf),{},{to:balancesFill[_d][0]});});}setBalanceForm(function(bf){return _objectSpread(_objectSpread({},bf),{},_defineProperty({},dist,obj));});}},obj);})// <Picker\n//   height={180}\n//   valueGroups={{ [dist]: balanceForm[dist] }}\n//   optionGroups={{ [dist]: balances[dist] }}\n//   onChange={(key, value) => {\n//     console.log(value)\n//     if (dist === \"from\") {\n//       console.log(key,value)\n//       const _d = balancesMap[value].wallet ? \"games\" : \"wallet\";\n//       setBalances((b) => ({\n//         ...b,\n//         to: balancesFill[_d],\n//       }));\n//       setBalanceForm((bf) => ({\n//         ...bf,\n//         to: balancesFill[_d][0],\n//       }));\n//     }\n//     setBalanceForm((bf) => ({\n//       ...bf,\n//       [key]: value,\n//     }));\n//   }}\n// />\n));};var swap=function swap(){var _ref2=[balanceForm.from,balanceForm.to],to=_ref2[0],from=_ref2[1];var _d1=balancesMap[from].wallet?\"games\":\"wallet\";var _d2=balancesMap[to].wallet?\"games\":\"wallet\";setBalances(function(b){return _objectSpread(_objectSpread({},b),{},{to:balancesFill[_d1],from:balancesFill[_d2]});});setBalanceForm(function(bf){return _objectSpread(_objectSpread({},bf),{},{to:to,from:from});});};var setAmount=function setAmount(e){var amount=e.target?e.target.value:e;setBalanceForm(function(form){return _objectSpread(_objectSpread({},form),{},{amount:amount});});};var setMax=function setMax(){var _game=balancesMap[balanceForm.from];var _max=_game.balance;if(_game.wallet){_max=userAuth.data.balance;}setAmount(Math.floor(_max));};var onlyNumbers=function onlyNumbers(e){var value=e.currentTarget.value;var regexp=/^[0-9\\b]+$/;if(!value||regexp.test(value)){setAmount(value);}};var transfer=function transfer(e){if(!balanceForm.amount||isNaN(+balanceForm.amount)){setUserAuthFN(userAuth.status,userAuth.data,{text:\"系统提示\",message:\"没有金额\"});return void console.warn(\"[transfer] No amount\");}var _getMap=function _getMap(n){return balancesMap[n.split(\": \")[0]]||null;};var _from=_getMap(balanceForm.from);var _to=_getMap(balanceForm.to);if(_from.game.id===_to.game.id){setUserAuthFN(userAuth.status,userAuth.data,{text:\"系统提示\",message:\"同一个游戏\"});return void console.warn(\"[transfer] Same game\");}if(_from.balance===0){setUserAuthFN(userAuth.status,userAuth.data,{text:\"系统提示\",message:\"零余额\"});return void console.warn(\"[transfer] Zero balance\");}if(_from.balance<+balanceForm.amount){setUserAuthFN(userAuth.status,userAuth.data,{text:\"系统提示\",message:\"余额不足\"});return void console.warn(\"[transfer] Not enough game balance\");}console.info(\"You're transfering \".concat(balanceForm.amount,\" \\xA5 from \").concat(_from.game.name,\" to \").concat(_to.game.name));setBalanceLoad(true);Game.transfer(_objectSpread(_objectSpread({},User.read()),{},{amount:+balanceForm.amount,from:_from.game.id,to:_to.game.id})).then(function(r){console.info(\"You have successfully transferred \".concat(balanceForm.amount,\" \\xA5 from \").concat(_from.game.name,\" to \").concat(_to.game.name,\": \").concat(r.info));setBalanceLoad(false);setBalanceTransferred(true);},function(e){console.error(e);setUserAuthFN(userAuth.status,userAuth.data,{text:\"系统提示\",message:e});setBalanceLoad(false);});};var wallet=function wallet(_e){setBalanceTime(true);setBalanceLoad(true);Game.transferToWallet().promise.then(function(r){setBalanceLoad(false);setBalanceTransferred(true);},function(e){console.warn(e);setUserAuthFN(userAuth.status,userAuth.data,{text:\"系统提示\",message:e});setBalanceLoad(false);});setTimeout(function(){setBalanceTime(false);},10000);};var onTransferPerGame=function onTransferPerGame(obj){var _from={id:0,name:'wallet'};var _to=obj;// console.log(userAuth.data.balance,Math.floor(userAuth.data.balance) , _from , _to) \n// return false\nconsole.info(\"You are transferring \".concat(Math.floor(userAuth.data.balance),\" \\xA5 from \").concat(_from.name,\" to \").concat(_to.game.name));Game.transfer(_objectSpread(_objectSpread({},User.read()),{},{amount:Math.floor(userAuth.data.balance),from:_from.id,to:_to.game.id})).then(function(r){console.info(\"You have successfully transferred \".concat(Math.floor(userAuth.data.balance),\" \\xA5 from \").concat(_from.name,\" to \").concat(_to.game.name,\": \").concat(r.info));setBalanceLoad(false);setBalanceTransferred(true);},function(e){console.error(e);setUserAuthFN(userAuth.status,userAuth.data,{text:\"系统提示\",message:e});setBalanceLoad(false);});};return/*#__PURE__*/React.createElement(Wrap,{className:\"transfer-desktop\",title:\"转账\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile-section section-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-balance\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-balance-wrap wallet\"},\"\\u4E2D\\u5FC3\\u94B1\\u5305 :\",/*#__PURE__*/React.createElement(\"span\",{className:\"user-balance-amount\"},\"\\xA5\",BigNumber(userAuth.data.balance).toFormat(2))),/*#__PURE__*/React.createElement(\"div\",{className:\"user-balance-wrap refresh\",onClick:!balanceLoad&&!balanceTime?wallet:null},/*#__PURE__*/React.createElement(\"i\",null),/*#__PURE__*/React.createElement(\"span\",{className:\"user-balance-label\"},\"\\u4E00\\u952E\\u56DE\\u6536\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"transfer-hr\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"balances-list\"},balancesRaw.map(function(balance,i){return/*#__PURE__*/React.createElement(\"div\",{key:i,className:\"balances-list--item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"game-name\"},balance.game.name),/*#__PURE__*/React.createElement(\"div\",{className:\"game-balance\"},BigNumber(balance.balance).toFormat(2)),/*#__PURE__*/React.createElement(\"div\",{className:\"game-button\",onClick:!balanceLoad&&!balanceTime?function(){return onTransferPerGame(balance);}:null},\"\\u4E00\\u952E\\u8F6C\\u5165\"));}))),/*#__PURE__*/React.createElement(\"div\",{className:\"profile-section section-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-field-section\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-field--doubler\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-field\"},/*#__PURE__*/React.createElement(\"label\",null,\"\\u63A8\\u51FA\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input--wrap with-dot\"},/*#__PURE__*/React.createElement(\"div\",{className:cx(\"input-like\",{\"has-value\":balanceForm.from}),onClick:function onClick(e){return setBalanceOver(\"from\");}},balanceForm.from||\"推出\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-field-swap\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return swap();},id:\"swapButton\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-field\"},/*#__PURE__*/React.createElement(\"label\",null,\"\\u8FDB\\u5165\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input--wrap with-dot\"},/*#__PURE__*/React.createElement(\"div\",{className:cx(\"input-like\",{\"has-value\":balanceForm.to}),onClick:function onClick(e){return setBalanceOver(\"to\");}},balanceForm.to||\"进入\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-field with-max\"},/*#__PURE__*/React.createElement(\"div\",{className:\"amount-wrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input--wrap\"},/*#__PURE__*/React.createElement(\"span\",null,\"\\uFFE5\"),/*#__PURE__*/React.createElement(\"input\",{id:\"amount\",type:\"text\",placeholder:\"\\u91D1\\u989D\"// pattern=\"[0-9]*\"\n,className:cx({\"has-value\":balanceForm.amount}),value:balanceForm.amount,onChange:function onChange(e){return onlyNumbers(e);}// onKeyDown={(e) => onlyNumbers(e)}\n}))),/*#__PURE__*/React.createElement(\"div\",{className:\"amount-max-wrap\"},/*#__PURE__*/React.createElement(\"button\",{id:\"maxButton\",className:cx({disabled:!balancesMap[balanceForm.from]||!balancesMap[balanceForm.from].balance}),onClick:function onClick(){return setMax();}},\"\\u6700\\u5927\\u91D1\\u989D\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-field-section bottom\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-field amount-variants\"},AmountVariants.map(function(amount,i){return/*#__PURE__*/React.createElement(\"button\",{id:\"amountVariants\",key:i,className:cx(\"amount-variant\",{disabled:amount>userAuth.data.balance}),onClick:function onClick(){return setAmount(amount);}},amount);})),/*#__PURE__*/React.createElement(\"div\",{className:\"submit\"},/*#__PURE__*/React.createElement(\"button\",{onClick:transfer},\"\\u7ACB\\u5373\\u8F6C\\u8D26\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-container \".concat(balanceOver?\"shown\":null)},/*#__PURE__*/React.createElement(\"div\",{className:\"game-sa-overlay picker-over\"},/*#__PURE__*/React.createElement(\"div\",{className:\"picker-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"picker-head\"},/*#__PURE__*/React.createElement(\"p\",null,balanceOver===\"from\"?\"推出\":\"进入\")),balanceOver&&/*#__PURE__*/React.createElement(PickerWrap,{dist:balanceOver})),/*#__PURE__*/React.createElement(\"div\",{className:\"picker-footer\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(e){return setBalanceOver(null);}},\"\\u53D6\\u6D88\"),/*#__PURE__*/React.createElement(\"button\",{className:\"active\",onClick:function onClick(e){return setBalanceOver(null);}},\"\\u786E\\u5B9A\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-container \".concat(balanceTransferred?\"shown\":null)},/*#__PURE__*/React.createElement(\"div\",{className:\"game-sa-overlay\"},/*#__PURE__*/React.createElement(\"div\",{className:\"overlay-layer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form response\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-head\"},/*#__PURE__*/React.createElement(\"i\",null),/*#__PURE__*/React.createElement(\"h2\",null,\"\\u8F6C\\u8D26\\u6210\\u529F\")),/*#__PURE__*/React.createElement(\"div\",{className:\"form-body\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){setBalanceTransferred(false);setBalanceUpdateI(function(i){return i+1;});}},\"\\u786E\\u8BA4\"))))))));};export default withAuth(Transfer,1);","map":{"version":3,"sources":["/Users/cramj/Documents/New PWA/ubet-project (1)/src/view/profile/Transfer.js"],"names":["React","useEffect","useState","useContext","Picker","cx","BigNumber","map","toInteger","isNumber","User","Game","withAuth","Wrap","Transfer","Context","userAuth","setUserAuthFN","from","to","balances","setBalances","wallet","games","balancesFill","setBalancesFill","balancesRaw","setBalancesRaw","balanceTransferred","setBalanceTransferred","balanceLoad","setBalanceLoad","balanceUpdateI","setBalanceUpdateI","balancesMap","setBalancesMap","balanceOver","setBalanceOver","amount","balanceForm","setBalanceForm","balanceTime","setBalanceTime","read","then","_balances","filter","b","error","__balances","game","name","unshift","_bFillWallet","_bFillGames","__balancesMap","forEach","id","balance","data","session","promise","r","info","bf","AmountVariants","PickerWrap","dist","length","obj","i","_d","swap","_d1","_d2","setAmount","e","target","value","form","setMax","_game","_max","Math","floor","onlyNumbers","currentTarget","regexp","test","transfer","isNaN","status","text","message","console","warn","_getMap","n","split","_from","_to","_e","transferToWallet","setTimeout","onTransferPerGame","toFormat","disabled"],"mappings":"wdAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,CAAqCC,UAArC,KAAuD,OAAvD,CACA,MAAOC,CAAAA,MAAP,KAAmB,qBAAnB,CACA,MAAOC,CAAAA,EAAP,KAAe,YAAf,CACA,MAAOC,CAAAA,SAAP,KAAsB,cAAtB,CACA,OAASC,GAAT,CAAeC,SAAf,CAA2BC,QAA3B,KAA0C,QAA1C,CACA;AACA,OAASC,IAAT,CAAeC,IAAf,KAA2B,eAA3B,CACA,OAASC,QAAT,KAAyB,YAAzB,CACA,MAAOC,CAAAA,IAAP,KAAiB,QAAjB,CAEA,MAAO,yCAAP,CAEA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,iBACeX,UAAU,CAACO,IAAI,CAACK,OAAN,CADzB,CACbC,QADa,aACbA,QADa,CACHC,aADG,aACHA,aADG,eAGWf,QAAQ,CAAC,CACvCgB,IAAI,CAAE,EADiC,CAEvCC,EAAE,CAAE,EAFmC,CAAD,CAHnB,wCAGdC,QAHc,eAGJC,WAHI,8BAQmBnB,QAAQ,CAAC,CAC/CoB,MAAM,CAAE,EADuC,CAE/CC,KAAK,CAAE,EAFwC,CAAD,CAR3B,yCAQdC,YARc,eAQAC,eARA,8BAaiBvB,QAAQ,CAAC,EAAD,CAbzB,yCAadwB,WAbc,eAaDC,cAbC,8BAe+BzB,QAAQ,CAAC,KAAD,CAfvC,yCAed0B,kBAfc,eAeMC,qBAfN,8BAgBiB3B,QAAQ,CAAC,KAAD,CAhBzB,0CAgBd4B,WAhBc,gBAgBDC,cAhBC,gCAiBuB7B,QAAQ,CAAC,CAAD,CAjB/B,2CAiBd8B,cAjBc,gBAiBEC,iBAjBF,gCAkBiB/B,QAAQ,CAAC,EAAD,CAlBzB,2CAkBdgC,WAlBc,gBAkBDC,cAlBC,gCAmBiBjC,QAAQ,CAAC,IAAD,CAnBzB,2CAmBdkC,WAnBc,gBAmBDC,cAnBC,gCAoBiBnC,QAAQ,CAAC,CAC7CgB,IAAI,CAAE,IADuC,CAE7CC,EAAE,CAAE,IAFyC,CAG7CmB,MAAM,CAAE,EAHqC,CAAD,CApBzB,2CAoBdC,WApBc,gBAoBDC,cApBC,gCAyBiBtC,QAAQ,CAAC,KAAD,CAzBzB,2CAyBduC,WAzBc,gBAyBDC,cAzBC,gBA2BrBzC,SAAS,CAAC,UAAM,CACdoB,WAAW,CAAC,CACVH,IAAI,CAAE,EADI,CAEVC,EAAE,CAAE,EAFM,CAAD,CAAX,CAKAgB,cAAc,CAAC,EAAD,CAAd,CAEAV,eAAe,CAAC,CACdH,MAAM,CAAE,EADM,CAEdC,KAAK,CAAE,EAFO,CAAD,CAAf,CAKAZ,IAAI,CAACS,QAAL,kBACKV,IAAI,CAACiC,IAAL,EADL,GAEGC,IAFH,CAEQ,SAACC,SAAD,CAAe,CACrBlB,cAAc,CAACkB,SAAS,CAACC,MAAV,CAAiB,SAACC,CAAD,QAAO,CAACA,CAAC,CAACC,KAAV,EAAjB,CAAD,CAAd,CAEA;AACA;AACA,GAAMC,CAAAA,UAAU,CAAGJ,SAAS,CACzBC,MADgB,CACT,SAACC,CAAD,QAAO,CAACA,CAAC,CAACC,KAAV,EADS,EAEhBzC,GAFgB,CAEZ,SAACwC,CAAD,kBAAUA,CAAC,CAACG,IAAF,CAAOC,IAAjB,GAFY,CAAnB,CAGAF,UAAU,CAACG,OAAX,6BAEA,GAAMC,CAAAA,YAAY,CAAG,4BAArB,CACA,GAAMC,CAAAA,WAAW,CAAGT,SAAS,CAC1BC,MADiB,CACV,SAACC,CAAD,QAAO,CAACA,CAAC,CAACC,KAAV,EADU,EAEjBzC,GAFiB,CAEb,SAACwC,CAAD,QAAOA,CAAAA,CAAC,CAACG,IAAF,CAAOC,IAAd,EAFa,CAApB,CAIA1B,eAAe,CAAC,CACdH,MAAM,CAAE+B,YADM,CAEd9B,KAAK,CAAE+B,WAFO,CAAD,CAAf,CAKAd,cAAc,CAAC,SAACD,WAAD,wCACVA,WADU,MAEbrB,IAAI,CAAE+B,UAAU,CAAC,CAAD,CAFH,CAGb9B,EAAE,CAAE8B,UAAU,CAAC,CAAD,CAHD,IAAD,CAAd,CAMA5B,WAAW,CAAC,CACVH,IAAI,CAAE+B,UADI,CAEV;AACA9B,EAAE,CAAEmC,WAHM,CAAD,CAAX,CAMA,GAAMC,CAAAA,aAAa,CAAG,EAAtB,CAEAV,SAAS,CACNC,MADH,CACU,SAACC,CAAD,QAAO,CAACA,CAAC,CAACC,KAAV,EADV,EAEGQ,OAFH,CAEW,SAACT,CAAD,CAAO,CACdQ,aAAa,CAACR,CAAC,CAACG,IAAF,CAAOC,IAAR,CAAb,CAA6BJ,CAA7B,CACD,CAJH,EAMAQ,aAAa,CAAC,MAAD,CAAb,CAAwB,CACtBL,IAAI,CAAE,CACJO,EAAE,CAAE,CADA,CAEJN,IAAI,CAAE,QAFF,CADgB,CAKtB7B,MAAM,CAAE,IALc,CAMtBoC,OAAO,CAAE,CAAC1C,QAAQ,CAAC2C,IAAT,CAAcD,OANF,CAAxB,CASAvB,cAAc,CAACoB,aAAD,CAAd,CACD,CApDD,EAqDD,CAlEQ,CAkEN,CAACvB,cAAD,CAAiBhB,QAAQ,CAAC2C,IAAT,CAAcD,OAA/B,CAlEM,CAAT,CAoEAzD,SAAS,CAAC,UAAM,CACdS,IAAI,CAACkD,OAAL,kBACKlD,IAAI,CAACiC,IAAL,EADL,GAEGkB,OAFH,CAEWjB,IAFX,CAEgB,SAACkB,CAAD,QAAO7C,CAAAA,aAAa,CAAC,CAAD,CAAI6C,CAAC,CAACC,IAAN,CAApB,EAFhB,EAIAvB,cAAc,CAAC,SAACwB,EAAD,wCACVA,EADU,MAEb1B,MAAM,CAAE,EAFK,IAAD,CAAd,CAKA;AACD,CAXQ,CAWN,CAACN,cAAD,CAXM,CAAT,CAaA,GAAMiC,CAAAA,cAAc,CAAG,CAAC,GAAD,CAAM,GAAN,CAAW,IAAX,CAAiB,IAAjB,CAAuB,IAAvB,CAAvB,CAEA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,MAAc,IAAXC,CAAAA,IAAW,MAAXA,IAAW,CAC/B;AACA;AACA,mBAAQ,2BAAK,SAAS,CAAC,aAAf,eACE,2BAAK,SAAS,CAAC,uBAAf,EACC/C,QAAQ,CAAC+C,IAAD,CAAR,CAAeC,MAAf,EACC7D,GAAG,CAAEa,QAAQ,CAAC+C,IAAD,CAAV,CAAmB,SAACE,GAAD,CAAOC,CAAP,CAAY,CAChC,mBAAQ,2BAAK,GAAG,CAAEA,CAAV,CAAa,SAAS,4BAAsB/B,WAAW,CAAC4B,IAAD,CAAX,GAAsBE,GAAtB,CAA4B,QAA5B,CAAuC,EAA7D,CAAtB,CACE,OAAO,CAAE,kBAAI,CACX,GAAIF,IAAI,GAAK,MAAb,CAAqB,CACnB,GAAMI,CAAAA,EAAE,CAAGrC,WAAW,CAACmC,GAAD,CAAX,CAAiB/C,MAAjB,CAA0B,OAA1B,CAAoC,QAA/C,CAEAD,WAAW,CAAC,SAAC0B,CAAD,wCACPA,CADO,MAEV5B,EAAE,CAAEK,YAAY,CAAC+C,EAAD,CAFN,IAAD,CAAX,CAKA/B,cAAc,CAAC,SAACwB,EAAD,wCACVA,EADU,MAEb7C,EAAE,CAAEK,YAAY,CAAC+C,EAAD,CAAZ,CAAiB,CAAjB,CAFS,IAAD,CAAd,CAID,CACD/B,cAAc,CAAC,SAACwB,EAAD,wCACVA,EADU,wBAEZG,IAFY,CAEJE,GAFI,IAAD,CAAd,CAKD,CApBH,EAsBGA,GAtBH,CAAR,CAwBD,CAzBE,CA0BH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAtDF,CADF,CAAR,CA6DD,CAhED,CAoEA,GAAMG,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,EAAM,WACE,CAACjC,WAAW,CAACrB,IAAb,CAAmBqB,WAAW,CAACpB,EAA/B,CADF,CACVA,EADU,UACND,IADM,UAGjB,GAAMuD,CAAAA,GAAG,CAAGvC,WAAW,CAAChB,IAAD,CAAX,CAAkBI,MAAlB,CAA2B,OAA3B,CAAqC,QAAjD,CACA,GAAMoD,CAAAA,GAAG,CAAGxC,WAAW,CAACf,EAAD,CAAX,CAAgBG,MAAhB,CAAyB,OAAzB,CAAmC,QAA/C,CAEAD,WAAW,CAAC,SAAC0B,CAAD,wCACPA,CADO,MAEV5B,EAAE,CAAEK,YAAY,CAACiD,GAAD,CAFN,CAGVvD,IAAI,CAAEM,YAAY,CAACkD,GAAD,CAHR,IAAD,CAAX,CAMAlC,cAAc,CAAC,SAACwB,EAAD,wCACVA,EADU,MAEb7C,EAAE,CAAFA,EAFa,CAGbD,IAAI,CAAJA,IAHa,IAAD,CAAd,CAKD,CAjBD,CAmBA,GAAMyD,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,CAAD,CAAO,CACvB,GAAMtC,CAAAA,MAAM,CAAGsC,CAAC,CAACC,MAAF,CAAWD,CAAC,CAACC,MAAF,CAASC,KAApB,CAA4BF,CAA3C,CAEApC,cAAc,CAAC,SAACuC,IAAD,wCAAgBA,IAAhB,MAAsBzC,MAAM,CAANA,MAAtB,IAAD,CAAd,CACD,CAJD,CAMA,GAAM0C,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACnB,GAAMC,CAAAA,KAAK,CAAG/C,WAAW,CAACK,WAAW,CAACrB,IAAb,CAAzB,CAEA,GAAIgE,CAAAA,IAAI,CAAGD,KAAK,CAACvB,OAAjB,CAEA,GAAIuB,KAAK,CAAC3D,MAAV,CAAkB,CAChB4D,IAAI,CAAGlE,QAAQ,CAAC2C,IAAT,CAAcD,OAArB,CACD,CAEDiB,SAAS,CAAEQ,IAAI,CAACC,KAAL,CAAWF,IAAX,CAAF,CAAT,CACD,CAVD,CAYA,GAAMG,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACT,CAAD,CAAO,IACjBE,CAAAA,KADiB,CACPF,CAAC,CAACU,aADK,CACjBR,KADiB,CAEzB,GAAIS,CAAAA,MAAM,CAAI,YAAd,CACA,GAAI,CAACT,KAAD,EAAUS,MAAM,CAACC,IAAP,CAAYV,KAAZ,CAAd,CAAkC,CAChCH,SAAS,CAACG,KAAD,CAAT,CACD,CAEF,CAPD,CASA,GAAMW,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACb,CAAD,CAAO,CACtB,GAAI,CAACrC,WAAW,CAACD,MAAb,EAAuBoD,KAAK,CAAC,CAACnD,WAAW,CAACD,MAAd,CAAhC,CAAuD,CACrDrB,aAAa,CAACD,QAAQ,CAAC2E,MAAV,CAAkB3E,QAAQ,CAAC2C,IAA3B,CAAiC,CAC5CiC,IAAI,CAAE,MADsC,CAE5CC,OAAO,CAAE,MAFmC,CAAjC,CAAb,CAIA,MAAO,KAAKC,CAAAA,OAAO,CAACC,IAAR,CAAa,sBAAb,CAAZ,CACD,CAED,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAACC,CAAD,QAAO/D,CAAAA,WAAW,CAAC+D,CAAC,CAACC,KAAF,CAAQ,IAAR,EAAc,CAAd,CAAD,CAAX,EAAiC,IAAxC,EAAhB,CAEA,GAAMC,CAAAA,KAAK,CAAGH,OAAO,CAACzD,WAAW,CAACrB,IAAb,CAArB,CACA,GAAMkF,CAAAA,GAAG,CAAGJ,OAAO,CAACzD,WAAW,CAACpB,EAAb,CAAnB,CAIA,GAAIgF,KAAK,CAACjD,IAAN,CAAWO,EAAX,GAAkB2C,GAAG,CAAClD,IAAJ,CAASO,EAA/B,CAAmC,CACjCxC,aAAa,CAACD,QAAQ,CAAC2E,MAAV,CAAkB3E,QAAQ,CAAC2C,IAA3B,CAAiC,CAC5CiC,IAAI,CAAE,MADsC,CAE5CC,OAAO,CAAE,OAFmC,CAAjC,CAAb,CAIA,MAAO,KAAKC,CAAAA,OAAO,CAACC,IAAR,CAAa,sBAAb,CAAZ,CACD,CAED,GAAII,KAAK,CAACzC,OAAN,GAAkB,CAAtB,CAAyB,CACvBzC,aAAa,CAACD,QAAQ,CAAC2E,MAAV,CAAkB3E,QAAQ,CAAC2C,IAA3B,CAAiC,CAC5CiC,IAAI,CAAE,MADsC,CAE5CC,OAAO,CAAE,KAFmC,CAAjC,CAAb,CAIA,MAAO,KAAKC,CAAAA,OAAO,CAACC,IAAR,CAAa,yBAAb,CAAZ,CACD,CAED,GAAII,KAAK,CAACzC,OAAN,CAAgB,CAACnB,WAAW,CAACD,MAAjC,CAAyC,CACvCrB,aAAa,CAACD,QAAQ,CAAC2E,MAAV,CAAkB3E,QAAQ,CAAC2C,IAA3B,CAAiC,CAC5CiC,IAAI,CAAE,MADsC,CAE5CC,OAAO,CAAE,MAFmC,CAAjC,CAAb,CAIA,MAAO,KAAKC,CAAAA,OAAO,CAACC,IAAR,CAAa,oCAAb,CAAZ,CACD,CAEDD,OAAO,CAAC/B,IAAR,8BACwBxB,WAAW,CAACD,MADpC,uBACqD6D,KAAK,CAACjD,IAAN,CAAWC,IADhE,gBAC2EiD,GAAG,CAAClD,IAAJ,CAASC,IADpF,GAIApB,cAAc,CAAC,IAAD,CAAd,CAEApB,IAAI,CAAC8E,QAAL,gCACK/E,IAAI,CAACiC,IAAL,EADL,MAEEL,MAAM,CAAE,CAACC,WAAW,CAACD,MAFvB,CAGEpB,IAAI,CAAEiF,KAAK,CAACjD,IAAN,CAAWO,EAHnB,CAIEtC,EAAE,CAAEiF,GAAG,CAAClD,IAAJ,CAASO,EAJf,IAKGb,IALH,CAME,SAACkB,CAAD,CAAO,CACLgC,OAAO,CAAC/B,IAAR,6CACuCxB,WAAW,CAACD,MADnD,uBACoE6D,KAAK,CAACjD,IAAN,CAAWC,IAD/E,gBAC0FiD,GAAG,CAAClD,IAAJ,CAASC,IADnG,cAC4GW,CAAC,CAACC,IAD9G,GAIAhC,cAAc,CAAC,KAAD,CAAd,CAEAF,qBAAqB,CAAC,IAAD,CAArB,CACD,CAdH,CAeE,SAAC+C,CAAD,CAAO,CACLkB,OAAO,CAAC9C,KAAR,CAAc4B,CAAd,EACA3D,aAAa,CAACD,QAAQ,CAAC2E,MAAV,CAAkB3E,QAAQ,CAAC2C,IAA3B,CAAiC,CAC5CiC,IAAI,CAAE,MADsC,CAE5CC,OAAO,CAAEjB,CAFmC,CAAjC,CAAb,CAIA7C,cAAc,CAAC,KAAD,CAAd,CACD,CAtBH,EAwBD,CAtED,CAwEA,GAAMT,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAAC+E,EAAD,CAAQ,CACrB3D,cAAc,CAAC,IAAD,CAAd,CACAX,cAAc,CAAC,IAAD,CAAd,CAEApB,IAAI,CAAC2F,gBAAL,GAAwBzC,OAAxB,CAAgCjB,IAAhC,CACE,SAACkB,CAAD,CAAO,CACL/B,cAAc,CAAC,KAAD,CAAd,CAEAF,qBAAqB,CAAC,IAAD,CAArB,CACD,CALH,CAME,SAAC+C,CAAD,CAAO,CACLkB,OAAO,CAACC,IAAR,CAAanB,CAAb,EACA3D,aAAa,CAACD,QAAQ,CAAC2E,MAAV,CAAkB3E,QAAQ,CAAC2C,IAA3B,CAAiC,CAC5CiC,IAAI,CAAE,MADsC,CAE5CC,OAAO,CAAEjB,CAFmC,CAAjC,CAAb,CAIA7C,cAAc,CAAC,KAAD,CAAd,CACD,CAbH,EAeAwE,UAAU,CAAC,UAAM,CACf7D,cAAc,CAAC,KAAD,CAAd,CACD,CAFS,CAEP,KAFO,CAAV,CAGD,CAtBD,CAwBA,GAAM8D,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACnC,GAAD,CAAQ,CAGhC,GAAM8B,CAAAA,KAAK,CAAG,CACZ1C,EAAE,CAAE,CADQ,CAEZN,IAAI,CAAE,QAFM,CAAd,CAIA,GAAMiD,CAAAA,GAAG,CAAG/B,GAAZ,CACA;AACA;AACAyB,OAAO,CAAC/B,IAAR,gCAC0BoB,IAAI,CAACC,KAAL,CAAWpE,QAAQ,CAAC2C,IAAT,CAAcD,OAAzB,CAD1B,uBACsEyC,KAAK,CAAChD,IAD5E,gBACuFiD,GAAG,CAAClD,IAAJ,CAASC,IADhG,GAIAxC,IAAI,CAAC8E,QAAL,gCACK/E,IAAI,CAACiC,IAAL,EADL,MAEEL,MAAM,CAAE6C,IAAI,CAACC,KAAL,CAAWpE,QAAQ,CAAC2C,IAAT,CAAcD,OAAzB,CAFV,CAGExC,IAAI,CAAEiF,KAAK,CAAC1C,EAHd,CAIEtC,EAAE,CAAEiF,GAAG,CAAClD,IAAJ,CAASO,EAJf,IAKGb,IALH,CAME,SAACkB,CAAD,CAAO,CACLgC,OAAO,CAAC/B,IAAR,6CACuCoB,IAAI,CAACC,KAAL,CAAWpE,QAAQ,CAAC2C,IAAT,CAAcD,OAAzB,CADvC,uBACmFyC,KAAK,CAAChD,IADzF,gBACoGiD,GAAG,CAAClD,IAAJ,CAASC,IAD7G,cACsHW,CAAC,CAACC,IADxH,GAIAhC,cAAc,CAAC,KAAD,CAAd,CAEAF,qBAAqB,CAAC,IAAD,CAArB,CACD,CAdH,CAeE,SAAC+C,CAAD,CAAO,CACLkB,OAAO,CAAC9C,KAAR,CAAc4B,CAAd,EACA3D,aAAa,CAACD,QAAQ,CAAC2E,MAAV,CAAkB3E,QAAQ,CAAC2C,IAA3B,CAAiC,CAC5CiC,IAAI,CAAE,MADsC,CAE5CC,OAAO,CAAEjB,CAFmC,CAAjC,CAAb,CAIA7C,cAAc,CAAC,KAAD,CAAd,CACD,CAtBH,EA0BD,CAxCD,CA0CA,mBACE,oBAAC,IAAD,EAAM,SAAS,CAAC,kBAAhB,CAAmC,KAAK,CAAE,IAA1C,eACE,2BAAK,SAAS,CAAC,6BAAf,eACE,2BAAK,SAAS,CAAC,cAAf,eACE,2BAAK,SAAS,CAAC,0BAAf,4CAEE,4BAAM,SAAS,CAAC,qBAAhB,SACIzB,SAAS,CAACU,QAAQ,CAAC2C,IAAT,CAAcD,OAAf,CAAT,CAAiC+C,QAAjC,CAA0C,CAA1C,CADJ,CAFF,CADF,cAOE,2BACE,SAAS,CAAC,2BADZ,CAEE,OAAO,CAAE,CAAC3E,WAAD,EAAgB,CAACW,WAAjB,CAA+BnB,MAA/B,CAAwC,IAFnD,eAIE,6BAJF,cAKE,4BAAM,SAAS,CAAC,oBAAhB,6BALF,CAPF,CADF,cAgBE,2BAAK,SAAS,CAAC,aAAf,EAhBF,cAiBE,2BAAK,SAAS,CAAC,eAAf,EACGI,WAAW,CAACnB,GAAZ,CAAgB,SAACmD,OAAD,CAAUY,CAAV,qBACf,2BAAK,GAAG,CAAEA,CAAV,CAAa,SAAS,CAAC,qBAAvB,eACE,2BAAK,SAAS,CAAC,WAAf,EAA4BZ,OAAO,CAACR,IAAR,CAAaC,IAAzC,CADF,cAEE,2BAAK,SAAS,CAAC,cAAf,EACG7C,SAAS,CAACoD,OAAO,CAACA,OAAT,CAAT,CAA2B+C,QAA3B,CAAoC,CAApC,CADH,CAFF,cAKE,2BAAK,SAAS,CAAC,aAAf,CACC,OAAO,CAAE,CAAC3E,WAAD,EAAgB,CAACW,WAAjB,CAA+B,iBAAM+D,CAAAA,iBAAiB,CAAC9C,OAAD,CAAvB,EAA/B,CAAkE,IAD5E,6BALF,CADe,EAAhB,CADH,CAjBF,CADF,cAiCE,2BAAK,SAAS,CAAC,6BAAf,eACE,2BAAK,SAAS,CAAC,oBAAf,eACE,2BAAK,SAAS,CAAC,qBAAf,eACE,2BAAK,SAAS,CAAC,YAAf,eACE,gDADF,cAEE,2BAAK,SAAS,CAAC,sBAAf,eACE,2BACE,SAAS,CAAErD,EAAE,CAAC,YAAD,CAAe,CAC1B,YAAakC,WAAW,CAACrB,IADC,CAAf,CADf,CAIE,OAAO,CAAE,iBAAC0D,CAAD,QAAOvC,CAAAA,cAAc,CAAC,MAAD,CAArB,EAJX,EAMGE,WAAW,CAACrB,IAAZ,EAAoB,IANvB,CADF,CAFF,CADF,cAcE,2BAAK,SAAS,CAAC,iBAAf,eACE,8BAAQ,OAAO,CAAE,yBAAMsD,CAAAA,IAAI,EAAV,EAAjB,CAA+B,EAAE,CAAC,YAAlC,EADF,CAdF,cAmBE,2BAAK,SAAS,CAAC,YAAf,eACE,gDADF,cAEE,2BAAK,SAAS,CAAC,sBAAf,eACE,2BACE,SAAS,CAAEnE,EAAE,CAAC,YAAD,CAAe,CAC1B,YAAakC,WAAW,CAACpB,EADC,CAAf,CADf,CAIE,OAAO,CAAE,iBAACyD,CAAD,QAAOvC,CAAAA,cAAc,CAAC,IAAD,CAArB,EAJX,EAMGE,WAAW,CAACpB,EAAZ,EAAkB,IANrB,CADF,CAFF,CAnBF,CADF,cAmCE,2BAAK,SAAS,CAAC,qBAAf,eACE,2BAAK,SAAS,CAAC,aAAf,eACE,2BAAK,SAAS,CAAC,aAAf,eACE,yCADF,cAEE,6BACE,EAAE,CAAC,QADL,CAEE,IAAI,CAAC,MAFP,CAGE,WAAW,CAAC,cACZ;AAJF,CAKE,SAAS,CAAEd,EAAE,CAAC,CAAE,YAAakC,WAAW,CAACD,MAA3B,CAAD,CALf,CAME,KAAK,CAAEC,WAAW,CAACD,MANrB,CAOE,QAAQ,CAAE,kBAACsC,CAAD,QAAOS,CAAAA,WAAW,CAACT,CAAD,CAAlB,EACV;AARF,EAFF,CADF,CADF,cAgBE,2BAAK,SAAS,CAAC,iBAAf,eACE,8BACE,EAAE,CAAC,WADL,CAEE,SAAS,CAAEvE,EAAE,CAAC,CACZqG,QAAQ,CACN,CAACxE,WAAW,CAACK,WAAW,CAACrB,IAAb,CAAZ,EACA,CAACgB,WAAW,CAACK,WAAW,CAACrB,IAAb,CAAX,CAA8BwC,OAHrB,CAAD,CAFf,CAOE,OAAO,CAAE,yBAAMsB,CAAAA,MAAM,EAAZ,EAPX,6BADF,CAhBF,CAnCF,CADF,cAoEE,2BAAK,SAAS,CAAC,2BAAf,eACE,2BAAK,SAAS,CAAC,4BAAf,EACGf,cAAc,CAAC1D,GAAf,CAAmB,SAAC+B,MAAD,CAASgC,CAAT,qBAClB,8BACE,EAAE,CAAC,gBADL,CAEE,GAAG,CAAEA,CAFP,CAGE,SAAS,CAAEjE,EAAE,CAAC,gBAAD,CAAmB,CAC9BqG,QAAQ,CAAEpE,MAAM,CAAGtB,QAAQ,CAAC2C,IAAT,CAAcD,OADH,CAAnB,CAHf,CAME,OAAO,CAAE,yBAAMiB,CAAAA,SAAS,CAACrC,MAAD,CAAf,EANX,EAQGA,MARH,CADkB,EAAnB,CADH,CADF,cAeE,2BAAK,SAAS,CAAC,QAAf,eACE,8BAAQ,OAAO,CAAEmD,QAAjB,6BADF,CAfF,CApEF,cAwFE,2BAAK,SAAS,2BAAqBrD,WAAW,CAAG,OAAH,CAAa,IAA7C,CAAd,eACE,2BAAK,SAAS,8BAAd,eACE,2BAAK,SAAS,CAAC,kBAAf,eACE,2BAAK,SAAS,CAAC,aAAf,eACE,6BAAIA,WAAW,GAAK,MAAhB,CAAyB,IAAzB,CAAgC,IAApC,CADF,CADF,CAKGA,WAAW,eAAI,oBAAC,UAAD,EAAY,IAAI,CAAEA,WAAlB,EALlB,CADF,cASE,2BAAK,SAAS,CAAC,eAAf,eACE,8BAAQ,OAAO,CAAE,iBAACwC,CAAD,QAAOvC,CAAAA,cAAc,CAAC,IAAD,CAArB,EAAjB,iBADF,cAEE,8BAAQ,SAAS,CAAC,QAAlB,CAA2B,OAAO,CAAE,iBAACuC,CAAD,QAAOvC,CAAAA,cAAc,CAAC,IAAD,CAArB,EAApC,iBAFF,CATF,CADF,CAxFF,cA2GE,2BACE,SAAS,2BAAqBT,kBAAkB,CAAG,OAAH,CAAa,IAApD,CADX,eAGE,2BAAK,SAAS,kBAAd,eACE,2BAAK,SAAS,CAAC,eAAf,eACE,2BAAK,SAAS,CAAC,eAAf,eACE,2BAAK,SAAS,CAAC,WAAf,eACE,6BADF,cAEE,yDAFF,CADF,cAKE,2BAAK,SAAS,CAAC,WAAf,eACE,8BACE,OAAO,CAAE,kBAAM,CACbC,qBAAqB,CAAC,KAAD,CAArB,CACAI,iBAAiB,CAAC,SAACqC,CAAD,QAAOA,CAAAA,CAAC,CAAG,CAAX,EAAD,CAAjB,CACD,CAJH,iBADF,CALF,CADF,CADF,CAHF,CA3GF,CAjCF,CADF,CAwKD,CAlhBD,CAohBA,cAAe1D,CAAAA,QAAQ,CAACE,QAAD,CAAW,CAAX,CAAvB","sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\r\nimport Picker from \"react-mobile-picker\";\r\nimport cx from \"classnames\";\r\nimport BigNumber from \"bignumber.js\";\r\nimport { map  ,toInteger , isNumber} from 'lodash'\r\n// import { UIAlert } from \"../../component\";\r\nimport { User, Game } from \"../../service\";\r\nimport { withAuth } from \"../../util\";\r\nimport Wrap from \"./Wrap\";\r\n\r\nimport \"../../assets/scss/profile/Transfer.scss\";\r\n\r\nconst Transfer = () => {\r\n  const { userAuth, setUserAuthFN } = useContext(User.Context);\r\n\r\n  const [balances, setBalances] = useState({\r\n    from: [],\r\n    to: [],\r\n  });\r\n\r\n  const [balancesFill, setBalancesFill] = useState({\r\n    wallet: [],\r\n    games: [],\r\n  });\r\n\r\n  const [balancesRaw, setBalancesRaw] = useState([]);\r\n\r\n  const [balanceTransferred, setBalanceTransferred] = useState(false);\r\n  const [balanceLoad, setBalanceLoad] = useState(false);\r\n  const [balanceUpdateI, setBalanceUpdateI] = useState(0);\r\n  const [balancesMap, setBalancesMap] = useState({});\r\n  const [balanceOver, setBalanceOver] = useState(null);\r\n  const [balanceForm, setBalanceForm] = useState({\r\n    from: null,\r\n    to: null,\r\n    amount: \"\",\r\n  });\r\n  const [balanceTime, setBalanceTime] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setBalances({\r\n      from: [],\r\n      to: [],\r\n    });\r\n\r\n    setBalancesMap({});\r\n\r\n    setBalancesFill({\r\n      wallet: [],\r\n      games: [],\r\n    });\r\n\r\n    Game.balances({\r\n      ...User.read(),\r\n    }).then((_balances) => {\r\n      setBalancesRaw(_balances.filter((b) => !b.error));\r\n\r\n      // const __balances = _balances.map(b => `${b.game.name}: ${b.balance} ¥`);\r\n      // \t\t\t__balances.unshift(`中央钱包: ${userAuth.data.balance} ¥`);\r\n      const __balances = _balances\r\n        .filter((b) => !b.error)\r\n        .map((b) => `${b.game.name}`);\r\n      __balances.unshift(`中心钱包`);\r\n\r\n      const _bFillWallet = [`中心钱包`];\r\n      const _bFillGames = _balances\r\n        .filter((b) => !b.error)\r\n        .map((b) => b.game.name);\r\n\r\n      setBalancesFill({\r\n        wallet: _bFillWallet,\r\n        games: _bFillGames,\r\n      });\r\n\r\n      setBalanceForm((balanceForm) => ({\r\n        ...balanceForm,\r\n        from: __balances[0],\r\n        to: __balances[1],\r\n      }));\r\n\r\n      setBalances({\r\n        from: __balances,\r\n        // to: __balances,\r\n        to: _bFillGames,\r\n      });\r\n\r\n      const __balancesMap = {};\r\n\r\n      _balances\r\n        .filter((b) => !b.error)\r\n        .forEach((b) => {\r\n          __balancesMap[b.game.name] = b;\r\n        });\r\n\r\n      __balancesMap[\"中心钱包\"] = {\r\n        game: {\r\n          id: 0,\r\n          name: \"wallet\",\r\n        },\r\n        wallet: true,\r\n        balance: +userAuth.data.balance,\r\n      };\r\n\r\n      setBalancesMap(__balancesMap);\r\n    });\r\n  }, [balanceUpdateI, userAuth.data.balance]);\r\n\r\n  useEffect(() => {\r\n    User.session({\r\n      ...User.read(),\r\n    }).promise.then((r) => setUserAuthFN(1, r.info));\r\n\r\n    setBalanceForm((bf) => ({\r\n      ...bf,\r\n      amount: \"\",\r\n    }));\r\n\r\n    // eslint-disable-next-line\r\n  }, [balanceUpdateI]);\r\n\r\n  const AmountVariants = [100, 500, 1000, 2000, 5000];\r\n\r\n  const PickerWrap = ({ dist }) => {\r\n    // console.log( dist )\r\n    // console.log( balances[dist] )\r\n    return  <div className=\"picker-wrap\">\r\n              <div className=\"bank-picker-body-wrap\">\r\n              {balances[dist].length &&\r\n                map( balances[dist] , (obj , i) =>{\r\n                  return  <div key={i} className={`bank-picker-item ${balanceForm[dist] === obj ? 'active' : ''}`}\r\n                            onClick={()=>{\r\n                              if (dist === \"from\") {\r\n                                const _d = balancesMap[obj].wallet ? \"games\" : \"wallet\";\r\n          \r\n                                setBalances((b) => ({\r\n                                  ...b,\r\n                                  to: balancesFill[_d],\r\n                                }));\r\n          \r\n                                setBalanceForm((bf) => ({\r\n                                  ...bf,\r\n                                  to: balancesFill[_d][0],\r\n                                }));\r\n                              }\r\n                              setBalanceForm((bf) => ({\r\n                                ...bf,\r\n                                [dist] : obj,\r\n                              }));\r\n                              \r\n                            }}\r\n                          >\r\n                            {obj}\r\n                          </div>\r\n                })\r\n                // <Picker\r\n                //   height={180}\r\n                //   valueGroups={{ [dist]: balanceForm[dist] }}\r\n                //   optionGroups={{ [dist]: balances[dist] }}\r\n                //   onChange={(key, value) => {\r\n                //     console.log(value)\r\n                //     if (dist === \"from\") {\r\n                //       console.log(key,value)\r\n                //       const _d = balancesMap[value].wallet ? \"games\" : \"wallet\";\r\n\r\n                //       setBalances((b) => ({\r\n                //         ...b,\r\n                //         to: balancesFill[_d],\r\n                //       }));\r\n\r\n                //       setBalanceForm((bf) => ({\r\n                //         ...bf,\r\n                //         to: balancesFill[_d][0],\r\n                //       }));\r\n                //     }\r\n\r\n                //     setBalanceForm((bf) => ({\r\n                //       ...bf,\r\n                //       [key]: value,\r\n                //     }));\r\n                //   }}\r\n                // />\r\n\r\n              }\r\n              </div>\r\n              \r\n            </div>\r\n  }\r\n    \r\n  \r\n\r\n  const swap = () => {\r\n    const [to, from] = [balanceForm.from, balanceForm.to];\r\n\r\n    const _d1 = balancesMap[from].wallet ? \"games\" : \"wallet\";\r\n    const _d2 = balancesMap[to].wallet ? \"games\" : \"wallet\";\r\n\r\n    setBalances((b) => ({\r\n      ...b,\r\n      to: balancesFill[_d1],\r\n      from: balancesFill[_d2],\r\n    }));\r\n\r\n    setBalanceForm((bf) => ({\r\n      ...bf,\r\n      to,\r\n      from,\r\n    }));\r\n  };\r\n\r\n  const setAmount = (e) => {\r\n    const amount = e.target ? e.target.value : e;\r\n\r\n    setBalanceForm((form) => ({ ...form, amount }));\r\n  };\r\n\r\n  const setMax = () => {\r\n    const _game = balancesMap[balanceForm.from];\r\n\r\n    let _max = _game.balance;\r\n\r\n    if (_game.wallet) {\r\n      _max = userAuth.data.balance;\r\n    }\r\n\r\n    setAmount( Math.floor(_max) );\r\n  };\r\n\r\n  const onlyNumbers = (e) => {\r\n    const { value } = e.currentTarget\r\n    let regexp  = /^[0-9\\b]+$/\r\n    if (!value || regexp.test(value)) {\r\n      setAmount(value);\r\n    }\r\n\r\n  };\r\n\r\n  const transfer = (e) => {\r\n    if (!balanceForm.amount || isNaN(+balanceForm.amount)) {\r\n      setUserAuthFN(userAuth.status, userAuth.data, {\r\n        text: \"系统提示\",\r\n        message: \"没有金额\",\r\n      });\r\n      return void console.warn(\"[transfer] No amount\");\r\n    }\r\n\r\n    const _getMap = (n) => balancesMap[n.split(\": \")[0]] || null;\r\n\r\n    const _from = _getMap(balanceForm.from);\r\n    const _to = _getMap(balanceForm.to);\r\n\r\n\r\n  \r\n    if (_from.game.id === _to.game.id) {\r\n      setUserAuthFN(userAuth.status, userAuth.data, {\r\n        text: \"系统提示\",\r\n        message: \"同一个游戏\",\r\n      });\r\n      return void console.warn(\"[transfer] Same game\");\r\n    }\r\n\r\n    if (_from.balance === 0) {\r\n      setUserAuthFN(userAuth.status, userAuth.data, {\r\n        text: \"系统提示\",\r\n        message: \"零余额\",\r\n      });\r\n      return void console.warn(\"[transfer] Zero balance\");\r\n    }\r\n\r\n    if (_from.balance < +balanceForm.amount) {\r\n      setUserAuthFN(userAuth.status, userAuth.data, {\r\n        text: \"系统提示\",\r\n        message: \"余额不足\",\r\n      });\r\n      return void console.warn(\"[transfer] Not enough game balance\");\r\n    }\r\n\r\n    console.info(\r\n      `You're transfering ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}`\r\n    );\r\n\r\n    setBalanceLoad(true);\r\n\r\n    Game.transfer({\r\n      ...User.read(),\r\n      amount: +balanceForm.amount,\r\n      from: _from.game.id,\r\n      to: _to.game.id,\r\n    }).then(\r\n      (r) => {\r\n        console.info(\r\n          `You have successfully transferred ${balanceForm.amount} ¥ from ${_from.game.name} to ${_to.game.name}: ${r.info}`\r\n        );\r\n\r\n        setBalanceLoad(false);\r\n\r\n        setBalanceTransferred(true);\r\n      },\r\n      (e) => {\r\n        console.error(e);\r\n        setUserAuthFN(userAuth.status, userAuth.data, {\r\n          text: \"系统提示\",\r\n          message: e,\r\n        });\r\n        setBalanceLoad(false);\r\n      }\r\n    );\r\n  };\r\n\r\n  const wallet = (_e) => {\r\n    setBalanceTime(true);\r\n    setBalanceLoad(true);\r\n\r\n    Game.transferToWallet().promise.then(\r\n      (r) => {\r\n        setBalanceLoad(false);\r\n\r\n        setBalanceTransferred(true);\r\n      },\r\n      (e) => {\r\n        console.warn(e);\r\n        setUserAuthFN(userAuth.status, userAuth.data, {\r\n          text: \"系统提示\",\r\n          message: e,\r\n        });\r\n        setBalanceLoad(false);\r\n      }\r\n    );\r\n    setTimeout(() => {\r\n      setBalanceTime(false);\r\n    }, 10000);\r\n  };\r\n\r\n  const onTransferPerGame = (obj) =>{\r\n    \r\n\r\n    const _from = {\r\n      id: 0,\r\n      name: 'wallet'\r\n    }\r\n    const _to = obj\r\n    // console.log(userAuth.data.balance,Math.floor(userAuth.data.balance) , _from , _to) \r\n    // return false\r\n    console.info(\r\n      `You are transferring ${Math.floor(userAuth.data.balance)} ¥ from ${_from.name} to ${_to.game.name}`\r\n    );\r\n\r\n    Game.transfer({\r\n      ...User.read(),\r\n      amount: Math.floor(userAuth.data.balance),\r\n      from: _from.id,\r\n      to: _to.game.id,\r\n    }).then(\r\n      (r) => {\r\n        console.info(\r\n          `You have successfully transferred ${Math.floor(userAuth.data.balance)} ¥ from ${_from.name} to ${_to.game.name}: ${r.info}`\r\n        );\r\n\r\n        setBalanceLoad(false);\r\n\r\n        setBalanceTransferred(true);\r\n      },\r\n      (e) => {\r\n        console.error(e);\r\n        setUserAuthFN(userAuth.status, userAuth.data, {\r\n          text: \"系统提示\",\r\n          message: e,\r\n        });\r\n        setBalanceLoad(false);\r\n      }\r\n    );\r\n\r\n\r\n  }\r\n\r\n  return (\r\n    <Wrap className=\"transfer-desktop\" title={\"转账\"}>\r\n      <div className=\"profile-section section-box\">\r\n        <div className=\"user-balance\">\r\n          <div className=\"user-balance-wrap wallet\">\r\n            中心钱包 :\r\n            <span className=\"user-balance-amount\">\r\n              ¥{BigNumber(userAuth.data.balance).toFormat(2)}\r\n            </span>\r\n          </div>\r\n          <div\r\n            className=\"user-balance-wrap refresh\"\r\n            onClick={!balanceLoad && !balanceTime ? wallet : null}\r\n          >\r\n            <i />\r\n            <span className=\"user-balance-label\">一键回收</span>\r\n          </div>\r\n        </div>\r\n        <div className=\"transfer-hr\" />\r\n        <div className=\"balances-list\">\r\n          {balancesRaw.map((balance, i) => (\r\n            <div key={i} className=\"balances-list--item\">\r\n              <div className=\"game-name\">{balance.game.name}</div>\r\n              <div className=\"game-balance\">\r\n                {BigNumber(balance.balance).toFormat(2)}\r\n              </div>\r\n              <div className=\"game-button\"\r\n               onClick={!balanceLoad && !balanceTime ? () => onTransferPerGame(balance) : null}\r\n              >一键转入</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"profile-section section-box\">\r\n        <div className=\"form-field-section\">\r\n          <div className=\"form-field--doubler\">\r\n            <div className=\"form-field\">\r\n              <label>推出</label>\r\n              <div className=\"input--wrap with-dot\">\r\n                <div\r\n                  className={cx(\"input-like\", {\r\n                    \"has-value\": balanceForm.from,\r\n                  })}\r\n                  onClick={(e) => setBalanceOver(\"from\")}\r\n                >\r\n                  {balanceForm.from || \"推出\"}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"form-field-swap\">\r\n              <button onClick={() => swap()} id=\"swapButton\">\r\n                {/* <Icon name=\"switch\" /> */}\r\n              </button>\r\n            </div>\r\n            <div className=\"form-field\">\r\n              <label>进入</label>\r\n              <div className=\"input--wrap with-dot\">\r\n                <div\r\n                  className={cx(\"input-like\", {\r\n                    \"has-value\": balanceForm.to,\r\n                  })}\r\n                  onClick={(e) => setBalanceOver(\"to\")}\r\n                >\r\n                  {balanceForm.to || \"进入\"}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"form-field with-max\">\r\n            <div className=\"amount-wrap\">\r\n              <div className=\"input--wrap\">\r\n                <span>￥</span>\r\n                <input\r\n                  id=\"amount\"\r\n                  type=\"text\"\r\n                  placeholder=\"金额\"\r\n                  // pattern=\"[0-9]*\"\r\n                  className={cx({ \"has-value\": balanceForm.amount })}\r\n                  value={balanceForm.amount}\r\n                  onChange={(e) => onlyNumbers(e)}\r\n                  // onKeyDown={(e) => onlyNumbers(e)}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"amount-max-wrap\">\r\n              <button\r\n                id=\"maxButton\"\r\n                className={cx({\r\n                  disabled:\r\n                    !balancesMap[balanceForm.from] ||\r\n                    !balancesMap[balanceForm.from].balance,\r\n                })}\r\n                onClick={() => setMax()}\r\n              >\r\n                最大金额\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"form-field-section bottom\">\r\n          <div className=\"form-field amount-variants\">\r\n            {AmountVariants.map((amount, i) => (\r\n              <button\r\n                id=\"amountVariants\"\r\n                key={i}\r\n                className={cx(\"amount-variant\", {\r\n                  disabled: amount > userAuth.data.balance,\r\n                })}\r\n                onClick={() => setAmount(amount)}\r\n              >\r\n                {amount}\r\n              </button>\r\n            ))}\r\n          </div>\r\n          <div className=\"submit\">\r\n            <button onClick={transfer}>立即转账</button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className={`modal-container ${balanceOver ? \"shown\" : null}`}>\r\n          <div className={`game-sa-overlay picker-over`}>\r\n            <div className=\"picker-container\">\r\n              <div className=\"picker-head\">\r\n                <p>{balanceOver === \"from\" ? \"推出\" : \"进入\"}</p>\r\n              </div>\r\n\r\n              {balanceOver && <PickerWrap dist={balanceOver} /> }\r\n\r\n            </div>\r\n            <div className=\"picker-footer\">\r\n              <button onClick={(e) => setBalanceOver(null)}>取消</button>\r\n              <button className=\"active\" onClick={(e) => setBalanceOver(null)}>\r\n                确定\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div\r\n          className={`modal-container ${balanceTransferred ? \"shown\" : null}`}\r\n        >\r\n          <div className={`game-sa-overlay`}>\r\n            <div className=\"overlay-layer\">\r\n              <div className=\"form response\">\r\n                <div className=\"form-head\">\r\n                  <i />\r\n                  <h2>转账成功</h2>\r\n                </div>\r\n                <div className=\"form-body\">\r\n                  <button\r\n                    onClick={() => {\r\n                      setBalanceTransferred(false);\r\n                      setBalanceUpdateI((i) => i + 1);\r\n                    }}\r\n                  >\r\n                    确认\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Wrap>\r\n  );\r\n};\r\n\r\nexport default withAuth(Transfer, 1);\r\n"]},"metadata":{},"sourceType":"module"}